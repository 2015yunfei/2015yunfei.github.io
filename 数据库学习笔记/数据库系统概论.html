<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left: 0.25em solid rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    pre {
        page-break-inside: avoid;
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.mac-os #write{
    caret-color: AccentColor;
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG2"] path[data-c], mjx-container[jax="SVG2"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title>数据库系统概论</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><p><span>教材：</span></p><p><span>《数据库系统概论》第5版 王珊 萨师煊编著</span></p><p>&nbsp;</p><blockquote><p><a href='https://blog.csdn.net/weixin_43914604/article/details/106527797' target='_blank' class='url'>https://blog.csdn.net/weixin_43914604/article/details/106527797</a></p></blockquote><p>&nbsp;</p><h1 id='重点复习范围'><span>重点复习范围</span></h1><p><span>第1章 绪论</span></p><ul><li><p><span>数据库概念：主码，属性，约束</span></p></li><li><p><span>数据库vs文件系统</span></p></li><li><p><span>数据模型：层次模型，网状模型</span></p></li><li><p><span>三级模式，两级映射</span></p></li></ul><p><span>第2章 关系数据库</span></p><ul><li><p><span>关系模型概述</span></p></li><li><p><span>关系完整性：实体，参照，用户定义</span></p></li><li><p><span>关系代数：并，交，差，笛卡尔积；选择，投影，链接，除</span></p></li></ul><p><span>第3章 关系数据库标准语言SQL</span></p><ul><li><p><span>数据定义，数据查询，数据更新，视图</span></p></li></ul><p><span>第4章 数据库安全性</span></p><ul><li><p><span>安全控制</span></p></li><li><p><span>视图机制</span></p></li><li><p><span>审计</span></p></li><li><p><span>数据加密</span></p></li></ul><p><span>第5章 数据库完整性</span></p><ul><li><p><span>实体完整性</span></p></li><li><p><span>参照完整性</span></p></li><li><p><span>用户定义完整性</span></p></li><li><p><span>完整性约束命名子句（CONSTRAINT）</span></p></li><li><p><span>断言</span></p></li><li><p><span>触发器</span></p></li></ul><p><span>第6章关系数据理论</span></p><ul><li><p><span>函数依赖</span></p></li><li><p><span>范式，1NF，部分依赖，2NF，传递依赖，3NF，BCNF，多值依赖，4NF</span></p></li></ul><p><span>第7章数据库设计</span></p><ul><li><p><span>E-R模型：1:1，1:n，m:n</span></p></li><li><p><span>E-R图</span></p></li><li><p><span>数据模型优化</span></p></li></ul><p><span>第8章数据库编程</span></p><ul><li><p><span>嵌入式SQL</span></p></li><li><p><span>过程化SQL，存储过程和函数</span></p></li><li><p><span>跨数据库平台编程，ODBC</span></p></li></ul><p><span>第9章 关系查询处理和查询优化</span></p><ul><li><p><span>代数优化</span></p></li><li><p><span>物理优化</span></p></li></ul><p><span>第10章 数据库恢复技术</span></p><ul><li><p><span>事务Transaction，rollback/commit</span></p></li><li><p><span>事务ACID特性：原子性，一致性，隔离性，持续性</span></p></li><li><p><span>恢复技术：数据转储，日志文件，数据库镜像</span></p></li></ul><p><span>第11章 并发控制</span></p><ul><li><p><span>封锁：活锁和死锁</span></p></li><li><p><span>并发调度</span></p></li><li><p><span>两段锁</span></p></li></ul><p>&nbsp;</p><h1 id='数据库系统概述'><span>数据库系统概述</span></h1><p>&nbsp;</p><p><img src="数据库系统概论/shujukugiashu.png" referrerpolicy="no-referrer" alt="shujukugiashu"></p><p>&nbsp;</p><h2 id='四个基本概念'><span>四个基本概念</span></h2><h3 id='数据'><span>数据</span></h3><p><span>数据是数据库中存储的基本对象。</span></p><p>&nbsp;</p><h4 id='定义'><span>定义</span></h4><p><span>描述事物的符号记录</span></p><p>&nbsp;</p><h4 id='种类'><span>种类</span></h4><p><span>文本、图形、图像、音频、视频、学生的档案记录、货物的运输情况等</span></p><p>&nbsp;</p><h4 id='特点'><span>特点</span></h4><p><span>数据与其语义是不可分的</span></p><p>&nbsp;</p><h4 id='数据举例'><span>数据举例</span></h4><p><span>例如 93是一个数据</span></p><p><span>语义1：学生某门课的成绩</span></p><p><span>语义2：某人的体重</span></p><p><span>语义3：计算机系2003级学生人数</span></p><p>&nbsp;</p><p><span>学生档案中的学生记录</span></p><p><span>（李明，男，197205，江苏南京市，计算机系，1990）</span></p><p><span>语义：学生姓名、性别、出生年月、籍贯、所在院系、入学时间</span></p><p><span>解释：李明是个大学生，1972年5月出生，江苏南京市人，1990年考入计算机系</span></p><p>&nbsp;</p><h3 id='数据库'><span>数据库</span></h3><h4 id='数据库的定义'><span>数据库的定义</span></h4><p><span>数据库(Database，简称DB)是</span><strong><span>长期储存</span></strong><span>在计算机内、</span><strong><span>有组织</span></strong><span>、</span><strong><span>可共享</span></strong><span>的</span><strong><span>大量</span></strong><span>数据的集合。</span></p><p>&nbsp;</p><h4 id='数据库的基本特征'><span>数据库的基本特征</span></h4><ul><li><p><span>数据按一定的数据模型组织、描述和储存</span></p></li><li><p><span>可为各种用户共享</span></p></li><li><p><span>冗余度较小</span></p></li><li><p><span>数据独立性较高</span></p></li><li><p><span>易扩展</span></p></li></ul><p>&nbsp;</p><blockquote><p><span>数据库中的数据被设计为尽可能减少重复和多余的信息。换句话说，数据库中的数据被组织和存储以确保每个数据项都被最有效地利用，而不是重复存储相同的信息。减少冗余度有助于提高数据库的性能、节省存储空间，并且可以减少数据更新时可能导致的不一致性。</span></p></blockquote><p>&nbsp;</p><p><span>表 table</span></p><p><span>表 / 关系</span></p><ul><li><p><span>关系模式</span></p><ul><li><p><span>表名</span></p></li><li><p><span>表格式</span></p></li></ul></li><li><p><span>表内容</span></p><ul><li><p><span>Row行 / tuple元组 / record记录</span></p></li><li><p><span>column列 / field / attribute属性</span></p><ul><li><p><span>列名</span></p></li><li><p><span>值</span></p></li></ul></li></ul></li></ul><p>&nbsp;</p><h3 id='数据库管理系统'><span>数据库管理系统</span></h3><p><span>数据库管理系统——DataBase Management System</span></p><p>&nbsp;</p><h4 id='定义-2'><span>定义</span></h4><p><span>DBMS是位于用户与操作系统之间的一层数据管理软件。</span></p><p><span>是基础软件，是一个大型复杂的软件系统。</span></p><p>&nbsp;</p><p><span>数据库在计算机系统中的位置</span></p><p><img src="数据库系统概论/image-20240503141947233.png" alt="image-20240503141947233" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='用途'><span>用途</span></h4><p><span>科学地组织和存储数据、高效地获取和维护数据。</span></p><p>&nbsp;</p><h4 id='主要功能'><span>主要功能</span></h4><h5 id='数据定义'><span>数据定义</span></h5><p><span>提供数据定义语言（DDL）(创建，连接 DB)</span></p><p><span>定义数据库中的数据对象（Table,View..）</span></p><p>&nbsp;</p><h5 id='数据组织存储和管理'><span>数据组织、存储和管理</span></h5><p><span>分类组织、存储和管理各种数据</span></p><p><span>确定组织数据的文件结构和存取方式</span></p><p><span>实现数据之间的联系</span></p><p><span>提供多种存取方法提高存取效率(索引..)</span></p><p>&nbsp;</p><h5 id='数据操纵'><span>数据操纵</span></h5><p><span>提供数据操纵语言(DML)</span></p><p><span>实现对数据库的基本操作 (查询、插入、删除和修改)</span></p><p>&nbsp;</p><h5 id='事务管理和运行管理'><span>事务管理和运行管理</span></h5><p><span>数据库在建立、运行和维护时由数据库管理系统DBMS统一管理和控制</span></p><p><span>保证数据的安全性、完整性、多用户对数据的并发使用</span></p><p><span>发生故障后的系统恢复</span></p><p>&nbsp;</p><h5 id='建立和维护功能'><span>建立和维护功能</span></h5><p><span>数据库初始数据装载转换</span></p><p><span>数据库转储、介质故障恢复</span></p><p><span>数据库的重组织</span></p><p><span>性能监视、分析等</span></p><p>&nbsp;</p><h5 id='其它功能'><span>其它功能</span></h5><p><span>数据库管理系统DBMS与网络中其它软件系统的通信</span></p><p><span>两个数据库管理系统DBMS系统的数据转换</span></p><p><span>异构数据库之间的互访和互操作</span></p><p>&nbsp;</p><p><span>从系统来看：</span></p><ul><li><p><span>编译器</span></p></li><li><p><span>执行引擎（优化查询算法）</span></p></li><li><p><span>数据访问和索引</span></p></li><li><p><span>通信控制</span></p></li><li><p><span>事务管理</span></p></li><li><p><span>恢复（备份日志）</span></p></li><li><p><span>安全控制</span></p></li><li><p><span>完整性控制以及数据字典等组成部分</span></p></li></ul><p><span>这些组件相互协作，共同实现对数据的存储、管理和操作。</span></p><p>&nbsp;</p><h3 id='数据库系统'><span>数据库系统</span></h3><p><span>数据库系统（Database System，简称DBS）</span></p><p>&nbsp;</p><h4 id='定义-3'><span>定义</span></h4><p><span>在计算机系统中引入数据库后的系统构成</span></p><p>&nbsp;</p><h4 id='构成'><span>构成</span></h4><ul><li><p><span>数据库 Database</span></p></li><li><p><span>数据库管理系统（及其开发工具）Database Management System</span></p></li><li><p><span>应用系统</span></p></li><li><p><span>数据库管理员 Database Administrator</span></p></li></ul><p>&nbsp;</p><p><img src="数据库系统概论/image-20240503142339134.png" alt="image-20240503142339134" style="zoom:50%;" /></p><p>&nbsp;</p><h2 id='数据管理技术的产生和发展'><span>数据管理技术的产生和发展</span></h2><h3 id='什么是数据管理'><span>什么是数据管理</span></h3><p><span>对数据进行分类、组织、编码、存储、检索和维护</span></p><p><span>数据处理的中心问题</span></p><p>&nbsp;</p><h3 id='数据管理技术的发展过程'><span>数据管理技术的发展过程</span></h3><p><span>人工管理阶段(20世纪40年代中–50年代中)</span></p><p><span>文件系统阶段(20世纪50年代末–60年代中)</span></p><p><span>数据库系统阶段(20世纪60年代末–现在)</span></p><p>&nbsp;</p><p><span>20世纪50年代中之前：人工管理阶段</span></p><p><span>应用背景 科学计算</span></p><p><span>硬件背景 无直接存取存储设备</span></p><p><span>软件背景 没有操作系统</span></p><p><span>处理方式 批处理</span></p><p>&nbsp;</p><p><span>人工管理阶段特点：</span></p><ul><li><p><span>数据的管理者: 用户(程序员)，数据不保存</span></p></li><li><p><span>数据面向的对象: 某一应用程序</span></p></li><li><p><span>数据的共享程度: 无共享、冗余度极大</span></p></li><li><p><span>数据的独立性: 不独立，完全依赖于程序</span></p></li><li><p><span>数据的结构化: 无结构</span></p></li><li><p><span>数据控制能力: 应用程序自己控制</span></p></li></ul><p>&nbsp;</p><p><span>20世纪50年代末--60年代中：文件系统阶段</span></p><p><span>应用背景 科学计算、数据管理</span></p><p><span>硬件背景 磁盘、磁鼓</span></p><p><span>软件背景 有文件系统</span></p><p><span>处理方式 联机实时处理、批处理</span></p><p>&nbsp;</p><p><span>文件系统阶段特点：</span></p><ul><li><p><span>程序通过</span><strong><span>数据文件</span></strong><span>访问数据。文件系统阶段</span><strong><span>由操作系统的文件系统对数据进行管理</span></strong><span>，</span><strong><span>用户无需直接涉及物理设备及数据的物理组织细节</span></strong><span>。</span></p></li><li><p><span>文件系统提供一定的数据管理功能：</span></p><ul><li><p><span>存取方法(索引、链接、直接存取、倒排文件等)</span></p></li><li><p><span>支持对文件的基本操作(增、删、改、查等)，用户程序不必考虑物理细节</span></p></li><li><p><span>数据的存取基本上以记录为单位</span></p></li></ul></li><li><p><span>数据仍是面向应用的，</span><strong><span>一个数据文件对应一个用户程序</span></strong></p></li><li><p><span>数据与程序有一定的独立性：实现了用户程序与数据的物理存储结构的分离</span></p></li><li><p><span>数据可在文件级为多用户共享</span></p></li></ul><p><span>文件系统阶段的局限性：</span></p><ul><li><p><span>数据的管理者：文件系统，数据可长期保存</span></p></li><li><p><span>数据面向的对象：应用程序，应用程序自己控制数据</span></p></li><li><p><span>数据的共享程度：共享性差、冗余度大。基本上一个程序对应一个文件；部分数据相同时，仍需建立各自文件；相同的数在多个文件中重复存储（word）</span></p></li><li><p><span>数据的结构化：记录内有结构，整体无结构</span></p></li><li><p><span>数据的独立性：独立性差，数据的逻辑结构改变必须修改应用程序；文件间的联系必须通过程序来构造。</span></p></li><li><p><span>数据的一致性：所有文件副本必须同时更新</span></p></li></ul><p><span>当数据的规模极为庞大、数据间关系极为复杂时，文件系统阶段的上述问题就变得尖锐起来了</span></p><p>&nbsp;</p><p><span>20世纪60年代末以来：数据库系统阶段</span></p><p><span>应用背景：大规模管理</span></p><p><span>硬件背景：大容量磁盘、磁盘阵列</span></p><p><span>软件背景：有数据库管理系统</span></p><p><span>处理方式：联机实时处理，分布处理，批处理</span></p><p><span>文件系统到数据库系统，标志着数据管理技术的飞跃</span></p><p>&nbsp;</p><h2 id='数据库系统的特点'><span>数据库系统的特点</span></h2><ul><li><p><span>数据结构化</span></p><ul><li><p><code>整体数据的结构化</code><span>是数据库的主要特征之一</span></p></li><li><p><code>整体结构化</code><span>：不再仅仅针对某一个应用，而是面向全组织</span>
<span>不仅数据内部结构化，整体是结构化的，数据之间具有联系</span></p></li><li><p><code>数据库中实现的是数据的真正结构化</code></p><ul><li><p><span>数据的结构用</span><code>数据模型</code><span>描述，无需程序定义和解释</span></p></li><li><p><span>数据可以</span><code>变长</code></p></li><li><p><span>数据的最小存取单位是</span><code>数据项</code></p></li></ul></li></ul></li><li><p><span>数据的共享性高，冗余度低，易扩充</span></p><ul><li><p><span>数据库系统从整体角度看待和描述数据，数据面向整个系统，可以被多个用户、多个应用共享使用。</span></p></li><li><p><code>数据共享的好处</code></p><ul><li><p><span>减少数据冗余，节约存储空间（注意：数据库中并非完全消除冗余！有时为了提高数据的存取效率，同一数据可保留多个副本，但是这种冗余是在数据库系统的控制之下的。）</span></p></li><li><p><span>避免数据之间的不相容性与不一致性</span></p></li><li><p><span>使系统易于扩充</span></p></li></ul></li></ul></li><li><p><span>数据独立性高</span></p><ul><li><p><code>物理独立性</code>
<span>指用户的应用程序与存储在磁盘上的数据库中数据是相互独立的。当数据的物理存储改变了，应用程序不用改变。</span></p></li><li><p><code>逻辑独立性</code>
<span>指用户的应用程序与数据库的逻辑结构是相互独立的。数据的逻辑结构改变了，用户程序也可以不变。</span></p></li><li><p><strong><span>数据独立性是由数据库管理系统DBMS的二级映像功能来保证的</span></strong></p></li></ul></li><li><p><span>数据由DBMS统一管理和控制，DBMS提供的数据控制功能：</span></p><ul><li><p><span>数据的安全性（Security）保护</span>
<span>保护数据，以防止不合法的使用造成的数据的泄密和破坏。</span></p></li><li><p><span>数据的完整性（Integrity）检查</span>
<span>将数据控制在有效的范围内，或保证数据之间满足一定的关系。</span></p></li><li><p><span>并发（Concurrency）控制</span>
<span>对多用户的并发操作加以控制和协调，防止相互干扰而得到错误的结果。</span></p></li><li><p><span>数据库恢复（Recovery）</span>
<span>将数据库从错误状态恢复到某一已知的正确状态。</span></p></li></ul></li><li><p><span>应用程序与数据的对应关系（数据库系统）</span>
<img src="数据库系统概论/image-20240312165647876.png" alt="image-20240312165647876" style="zoom:50%;" /></p></li></ul><p>&nbsp;</p><h2 id='数据库概念小结'><span>数据库概念小结</span></h2><p><span>数据库是长期存储在计算机内有组织的大量的共享的数据集合。</span></p><p><span>可以供各种用户共享，具有最小冗余度和较高的数据独立性。</span></p><p><span>数据库管理系统在数据库建立、运用和维护时对数据库进行统一控制，以保证数据的完整性、安全性，并在多用户同时使用数据库时进行并发控制，在发生故障后对数据库进行恢复。</span></p><p>&nbsp;</p><h1 id='数据模型'><span>数据模型</span></h1><p><span>数据模型是对现实世界数据特征的抽象。</span></p><p><span>通俗地讲数据模型就是现实世界的模拟。</span></p><p>&nbsp;</p><p><span>数据模型应满足三方面要求：</span></p><ol start='' ><li><p><span>能比较真实地模拟现实世界</span></p></li><li><p><span>容易为人所理解</span></p></li><li><p><span>便于在计算机上实现</span></p></li></ol><p>&nbsp;</p><p><strong><span>数据模型是数据库系统的核心和基础</span></strong></p><p>&nbsp;</p><h2 id='两类数据模型'><span>两类数据模型</span></h2><p><span>数据模型分为两类（分属两个不同的层次）：</span></p><ol start='' ><li><p><span>概念模型也称信息模型，它是按用户的观点来对数据和信息建模，用于数据库设计。</span></p></li><li><p><span>逻辑模型和物理模型</span></p><ul><li><p><span>逻辑模型主要包括网状模型、层次模型、关系模型、面向对象模型等，按计算机系统的观点对数据建模，用于DBMS实现。</span></p></li><li><p><span>物理模型是对数据最底层的抽象，描述数据在系统内部的表示方式和存取方法，在磁盘或磁带上的存储方式和存取方法。</span></p></li></ul></li></ol><p>&nbsp;</p><p><span>客观对象的抽象过程---两步抽象</span></p><ol start='' ><li><p><span>现实世界中的客观对象抽象为概念模型。（</span><strong><span>将现实世界抽象为信息世界</span></strong><span>）</span></p></li><li><p><span>把概念模型转换为某一DBMS支持的数据模型。（</span><strong><span>将信息世界转换为机器世界</span></strong><span>）</span></p></li></ol><p>&nbsp;</p><p><img src="数据库系统概论/image-20240312225638028.png" referrerpolicy="no-referrer" alt="image-20240312225638028"></p><p>&nbsp;</p><h2 id='概念模型'><span>概念模型</span></h2><h3 id='用途与基本要求'><span>用途与基本要求</span></h3><p><span>概念模型的用途：</span></p><ul><li><p><span>概念模型用于信息世界的建模</span></p></li><li><p><span>是现实世界到机器世界的一个中间层次</span></p></li><li><p><span>是数据库设计的有力工具</span></p></li><li><p><span>数据库设计人员和用户之间进行交流的语言</span></p></li></ul><p>&nbsp;</p><p><span>对概念模型的基本要求：</span></p><ul><li><p><span>较强的语义表达能力</span></p></li><li><p><span>能够方便、直接地表达应用中的各种语义知识</span></p></li><li><p><span>简单、清晰、易于用户理解</span></p></li></ul><p>&nbsp;</p><ol start='' ><li><p><span>信息世界中的基本概念</span></p></li><li><p><span>概念模型的一种表示方法：实体-联系方法</span></p></li></ol><p>&nbsp;</p><h3 id='信息世界中的基本概念'><span>信息世界中的基本概念</span></h3><p><span>实体（Entity）：客观存在并可相互区别的事物称为实体。可以是具体的人、事、物或抽象的概念。</span></p><p><span>属性（Attribute）：实体所具有的某一特性称为属性。一个实体可以由若干个属性来刻画。</span></p><p><span>码（Key）：唯一标识实体的属性集称为码。</span></p><p><span>域（Domain）：属性的取值范围称为该属性的域。</span></p><p><span>实体型（Entity Type）：用实体名及其属性名集合来抽象和刻画同类实体称为实体型</span></p><p><span>实体集（Entity Set）：同一类型实体的集合称为实体集</span></p><p><span>联系（Relationship）：</span></p><ul><li><p><span>现实世界中事物内部以及事物之间的联系在信息世界中反映为实体内部的联系和实体之间的联系。</span></p></li><li><p><span>实体内部的联系通常是指组成实体的各属性之间的联系</span></p></li><li><p><span>实体之间的联系通常是指不同实体集之间的联系</span></p></li><li><p><span>实体之间的联系有一对一、一对多和多对多等多种类型</span></p></li></ul><p>&nbsp;</p><p><span>实体-联系方法（Entity-Relationship Approach）</span></p><ul><li><p><span>用E-R图来描述现实世界的概念模型</span></p></li><li><p><span>E-R方法也称为E-R模型</span></p></li></ul><p>&nbsp;</p><h2 id='数据模型的组成要素'><span>数据模型的组成要素</span></h2><h3 id='数据结构-静态'><span>数据结构-静态</span></h3><p><span>数据模型的数据结构：描述数据库的组成对象，以及对象之间的联系</span></p><p><span>描述的内容：</span></p><ol start='' ><li><p><span>与对象的类型、内容、性质有关</span></p></li><li><p><span>与数据之间联系有关</span></p></li></ol><p>&nbsp;</p><p><strong><span>数据结构是对系统静态特性的描述</span></strong></p><p>&nbsp;</p><h3 id='数据操作-动态'><span>数据操作-动态</span></h3><p><span>数据操作：对数据库中各种对象（型）的实例（值）允许执行的操作，及有关的操作规则。</span></p><p>&nbsp;</p><p><span>数据操作的类型：</span></p><ul><li><p><span>查询</span></p></li><li><p><span>更新（包括插入、删除、修改）</span></p></li></ul><p>&nbsp;</p><p><span>数据模型对操作的定义：</span></p><ul><li><p><span>操作的确切含义</span></p></li><li><p><span>操作符号</span></p></li><li><p><span>操作规则（比如优先级）</span></p></li><li><p><span>实现操作的语言</span></p></li></ul><p>&nbsp;</p><p><strong><span>数据操作是对系统动态特性的描述</span></strong></p><p>&nbsp;</p><h3 id='数据的完整性约束条件'><span>数据的完整性约束条件</span></h3><p><span>数据的完整性约束条件：</span></p><ul><li><p><span>一组完整性规则的集合</span></p></li><li><p><span>完整性规则：给定的数据模型中数据及其联系所具有的制约和依存规则</span></p></li><li><p><span>用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容</span></p></li></ul><p>&nbsp;</p><p><span>数据模型对完整性约束条件的定义：</span></p><ul><li><p><span>反映和规定必须遵守的基本的通用的完整性约束条件</span></p></li><li><p><span>提供定义完整性约束条件的机制，以反映具体应用所涉及的数据必须遵守的特定的语义约束条件</span></p></li></ul><p>&nbsp;</p><h2 id='常用的数据模型'><span>常用的数据模型</span></h2><p><span>层次模型（Hierarchical Model）</span></p><p><span>网状模型（Network Model）</span></p><p><span>关系模型（Relational Model)</span></p><p><span>面向对象数据模型（Object Oriented Data Model）</span></p><p><span>对象关系数据模型（Object Relational Data Model）</span></p><p><span>半结构化数据模型（Semistruture Data Model）</span></p><p>&nbsp;</p><p><strong><span>数据模型主要用于DBMS的实现。</span></strong></p><p>&nbsp;</p><p><span>一种DBMS通常只支持一种数据模型。数据模型不同，对应的DBMS差别很大，因此，DBMS的类型也通常依据数据模型的不同来划分。</span></p><p>&nbsp;</p><h2 id='层次模型'><span>层次模型</span></h2><p><span>层次模型是数据库系统中最早出现的数据模型</span></p><p><span>层次数据库系统的典型代表是IBM公司的IMS（Information Management System）数据库管理系统</span></p><p><span>层次模型用树形结构来表示各类实体以及实体间的联系</span></p><p>&nbsp;</p><h3 id='数据结构'><span>数据结构</span></h3><p><span>满足下面两个条件的基本层次联系的集合为层次模型：</span></p><ul><li><p><span>有且只有一个结点没有双亲结点，这个结点称为根结点</span></p></li><li><p><span>根以外的其它结点有且只有一个双亲结点</span></p></li></ul><p>&nbsp;</p><p><span>层次模型中的几个术语：根结点，双亲结点，兄弟结点，叶结点</span></p><p>&nbsp;</p><p><span>一个层次模型的示例如下所示：</span></p><p><img src="数据库系统概论/image-20240503150025432.png" alt="image-20240503150025432" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>层次模型的特点：</span></p><ul><li><p><span>结点的双亲是唯一的</span></p></li><li><p><span>只能直接处理一对多的实体联系</span></p></li><li><p><span>每个记录类型可以定义一个排序字段，也称为码字段</span></p></li><li><p><span>任何记录值只有按其路径查看时，才能显出它的全部意义</span></p></li><li><p><span>没有一个子女记录值能够脱离双亲记录值而独立存在</span></p></li></ul><p>&nbsp;</p><p><span>一个简单的教员学生层次数据库模型如下所示：</span></p><p><img src="数据库系统概论/image-20240503150202253.png" alt="image-20240503150202253" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>教员学生层次数据库的一个值如下所示：</span></p><p><img src="数据库系统概论/image-20240503150230095.png" alt="image-20240503150230095" style="zoom:50%;" /></p><p>&nbsp;</p><h3 id='操纵与完整性约束'><span>操纵与完整性约束</span></h3><p><span>层次模型的数据操纵：</span></p><ul><li><p><span>查询</span></p></li><li><p><span>插入</span></p></li><li><p><span>删除</span></p></li><li><p><span>更新</span></p></li></ul><p>&nbsp;</p><p><span>层次模型的完整性约束条件：</span></p><ul><li><p><span>无相应的双亲结点值就不能插入子女结点值</span></p></li><li><p><span>如果删除双亲结点值，则相应的子女结点值也被同时删除</span></p></li><li><p><span>更新操作时，应更新所有相应记录，以保证数据的一致性</span></p></li></ul><p>&nbsp;</p><p><span>优点</span></p><ol start='' ><li><p><span>层次模型的数据结构比较简单清晰</span></p></li><li><p><span>查询效率高，性能优于关系模型，不低于网状模型</span></p></li><li><p><span>层次数据模型提供了良好的完整性支持</span></p></li></ol><p><span>缺点</span></p><ol start='' ><li><p><span>结点之间的多对多联系表示不自然</span></p></li><li><p><span>对插入和删除操作的限制多，应用程序的编写比较复杂</span></p></li><li><p><span>查询子女结点必须通过双亲结点</span></p></li><li><p><span>层次命令趋于程序化</span></p></li></ol><p>&nbsp;</p><h2 id='网状模型'><span>网状模型</span></h2><p><span>网状数据库系统采用网状模型作为数据的组织方式</span></p><p>&nbsp;</p><p><span>典型代表是DBTG系统，亦称CODASYL系统，是20世纪70年代由DBTG提出的一个系统方案。</span></p><p>&nbsp;</p><p><span>实际系统：</span></p><ul><li><p><span>Cullinet Software公司的 IDMS</span></p></li><li><p><span>Univac公司的 DMS1100</span></p></li><li><p><span>Honeywell公司的IDS/2</span></p></li><li><p><span>HP公司的IMAGE</span></p></li></ul><p>&nbsp;</p><h3 id='数据结构-2'><span>数据结构</span></h3><p><span>满足下面两个条件的基本层次联系的集合：</span></p><ul><li><p><span>允许一个以上的结点无双亲</span></p></li><li><p><span>一个结点可以有多于一个的双亲</span></p></li></ul><p>&nbsp;</p><p><span>网状模型的表示方法（与层次数据模型相同）</span></p><ul><li><p><span>实体型：用记录类型描述，每个结点表示一个记录类型（实体）</span></p></li><li><p><span>属性：用字段描述，每个记录类型可包含若干个字段</span></p></li><li><p><span>联系：用结点之间的连线表示记录类型（实体）之间的</span><strong><span>一对多的父子联系</span></strong></p></li></ul><p>&nbsp;</p><p><span>网状模型与层次模型的区别：</span></p><ol start='' ><li><p><span>网状模型允许多个结点没有双亲结点</span></p></li><li><p><span>网状模型允许结点有多个双亲结点</span></p></li><li><p><span>网状模型允许两个结点之间有多种联系（复合联系）</span></p></li><li><p><span>网状模型可以直接地描述现实世界</span></p></li><li><p><span>层次模型实际上是网状模型的一个特例</span></p></li></ol><p>&nbsp;</p><p><span>网状模型中子女结点与双亲结点的联系可以不唯一</span></p><p><span>要为每个联系命名，并指出与该联系有关的双亲记录和子女记录</span></p><p><span>网状模型的例子如下所示：</span></p><p><img src="数据库系统概论/image-20240503150651933.png" alt="image-20240503150651933" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>多对多联系在网状模型中的表示：</span></p><ul><li><p><span>用网状模型</span><strong><span>间接</span></strong><span>表示多对多联系</span></p></li><li><p><span>方法：</span><strong><span>将多对多联系直接分解成一对多联系</span></strong></p></li></ul><p>&nbsp;</p><p><span>例如：一个学生可以选修若干门课程，某一课程可以被多个学生选修，学生与课程之间是多对多联系</span></p><p>&nbsp;</p><p><span>引进一个学生选课的联结记录，由3个数据项组成：</span></p><ul><li><p><span>学号</span></p></li><li><p><span>课程号</span></p></li><li><p><span>成绩</span></p></li><li><p><span>表示某个学生选修某一门课程及其成绩</span></p></li></ul><p><span>学生/选课/课程的网状数据模型如下所示：</span></p><p><img src="数据库系统概论/image-20240503150808942.png" alt="image-20240503150808942" style="zoom:50%;" /></p><p>&nbsp;</p><h3 id='操纵与完整性约束-2'><span>操纵与完整性约束</span></h3><p><span>网状数据库系统（如DBTG）对数据操纵加了一些限制，提供了一定的完整性约束</span></p><p><span>码：唯一标识记录的数据项的集合</span></p><p><span>一个联系中双亲记录与子女记录之间是一对多联系</span></p><p><span>支持双亲记录和子女记录之间某些约束条件</span></p><p>&nbsp;</p><p><span>优点：</span></p><ul><li><p><span>能够更为直接地描述现实世界，如一个结点可以有多个双亲</span></p></li><li><p><span>具有良好的性能，存取效率较高</span></p></li></ul><p><span>缺点：</span></p><ul><li><p><span>结构比较复杂，而且随着应用环境的扩大，数据库的结构就变得越来越复杂，不利于最终用户掌握</span></p></li><li><p><span>DDL、DML语言复杂，用户不容易使用</span></p></li><li><p><span>记录之间联系是通过存取路径实现的，用户必须了解系统结构的细节</span></p></li></ul><p>&nbsp;</p><h2 id='关系模型'><span>关系模型</span></h2><p><span>关系数据库系统采用关系模型作为数据的组织方式</span></p><p><span>1970年美国IBM公司San Jose研究室的研究员E.F.Codd首次提出了数据库系统的关系模型</span></p><p><span>计算机厂商新推出的数据库管理系统几乎都支持关系模型</span></p><p>&nbsp;</p><h3 id='数据结构-3'><span>数据结构</span></h3><p><span>在用户观点下，关系模型中数据的逻辑结构是一张二维表，它由行和列组成。</span></p><p>&nbsp;</p><p><span>关系（Relation）：一个关系对应通常说的一张表</span></p><p><span>元组（Tuple）：表中的一行即为一个元组</span></p><p><span>属性（Attribute）：表中的一列即为一个属性，给每一个属性起一个名称即属性名</span></p><p><span>主码（Key）：表中的某个属性组，它可以唯一确定一个元组。</span></p><p><span>域（Domain）：属性的取值范围。</span></p><p><span>分量：元组中的一个属性值。</span></p><p><span>关系模式：对关系的描述：</span></p><ul><li><p><span>关系名（属性1，属性2，…，属性n）</span></p></li><li><p><span>学生（学号，姓名，年龄，性别，系，年级）</span></p></li></ul><p>&nbsp;</p><p><span>关系必须是规范化的，满足一定的规范条件：</span></p><p><span>最基本的规范条件：关系的每一个分量必须是一个不可分的数据项, 不允许表中还有表</span></p><p><span>下图中工资和扣除是可分的数据项，不符合关系模型要求</span></p><p><img src="数据库系统概论/image-20240503151306850.png" alt="image-20240503151306850" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>术语对比：</span></p><figure class='table-figure'><table><thead><tr><th style='text-align:center;' ><span>关系术语</span></th><th style='text-align:center;' ><span>一般表格的术语</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>关系名</span></td><td style='text-align:center;' ><span>表名</span></td></tr><tr><td style='text-align:center;' ><span>关系模式</span></td><td style='text-align:center;' ><span>表头（表格的描述）</span></td></tr><tr><td style='text-align:center;' ><span>关系</span></td><td style='text-align:center;' ><span>（一张）二维表</span></td></tr><tr><td style='text-align:center;' ><span>元组</span></td><td style='text-align:center;' ><span>记录或行</span></td></tr><tr><td style='text-align:center;' ><span>属性</span></td><td style='text-align:center;' ><span>列</span></td></tr><tr><td style='text-align:center;' ><span>属性名</span></td><td style='text-align:center;' ><span>列名</span></td></tr><tr><td style='text-align:center;' ><span>属性值</span></td><td style='text-align:center;' ><span>列值</span></td></tr><tr><td style='text-align:center;' ><span>分量</span></td><td style='text-align:center;' ><span>一条记录中的一个列值</span></td></tr><tr><td style='text-align:center;' ><span>非规范关系</span></td><td style='text-align:center;' ><span>表中有表（大表中嵌有小表）</span></td></tr></tbody></table></figure><p>&nbsp;</p><h3 id='操纵与完整性约束-3'><span>操纵与完整性约束</span></h3><p><span>数据操作是集合操作，操作对象和操作结果都是关系</span></p><ul><li><p><span>查询</span></p></li><li><p><span>插入</span></p></li><li><p><span>删除</span></p></li><li><p><span>更新</span></p></li></ul><p>&nbsp;</p><p><span>存取路径对用户隐蔽，用户只要指出“干什么”，不必详细说明“怎么干”</span></p><p>&nbsp;</p><p><span>关系的完整性约束条件：</span></p><ul><li><p><span>实体完整性</span></p></li><li><p><span>参照完整性</span></p></li><li><p><span>用户定义的完整性</span></p></li></ul><p>&nbsp;</p><p><span>优点</span></p><ul><li><p><span>建立在严格的数学概念的基础上</span></p></li><li><p><span>概念单一</span></p><ul><li><p><span>实体和各类联系都用关系来表示</span></p></li><li><p><span>对数据的检索结果也是关系</span></p></li></ul></li><li><p><span>关系模型的存取路径对用户透明</span></p><ul><li><p><span>具有更高的数据独立性，更好的安全保密性</span></p></li><li><p><span>简化了程序员的工作和数据库开发建立的工作</span></p></li></ul></li></ul><p><span>缺点</span></p><ul><li><p><span>存取路径对用户透明，查询效率往往不如格式化数据模型</span></p></li><li><p><span>为提高性能，必须对用户的查询请求进行优化，增加了开发数据库管理系统的难度</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='数据库系统结构和组成'><span>数据库系统结构和组成</span></h1><h2 id='数据库系统结构'><span>数据库系统结构</span></h2><h3 id='两种角度'><span>两种角度</span></h3><p><span>从数据库管理系统角度看，数据库系统通常采用三级模式结构，是数据库系统内部的系统结构。</span></p><p><span>从数据库最终用户角度看（数据库系统外部的体系结构） ，数据库系统的结构分为：</span></p><ul><li><p><span>单用户结构</span></p></li><li><p><span>主从式结构</span></p></li><li><p><span>分布式结构</span></p></li><li><p><span>客户／服务器</span></p></li><li><p><span>浏览器／应用服务器／数据库服务器多层结构等</span></p></li></ul><p>&nbsp;</p><h3 id='数据库系统模式的概念'><span>数据库系统模式的概念</span></h3><blockquote><p><span>来自张教授的解疑：模式是数据库结构的描述、关系模式是表的结构的描述。</span></p></blockquote><p>&nbsp;</p><p><span>“型” 和“值” 的概念：</span></p><ul><li><p><span>型(Type)：对某一类数据的结构和属性的说明</span></p></li><li><p><span>值(Value)：是型的一个具体赋值</span></p></li></ul><p>&nbsp;</p><p><span>例如：</span></p><p><span>学生记录型：</span></p><p><span>（学号，姓名，性别，系别，年龄，籍贯）</span></p><p><span>一个记录值：</span></p><p><span>（900201，李明，男，计算机，22，江苏）</span></p><p>&nbsp;</p><p><strong><span>模式（Schema）</span></strong></p><ul><li><p><span>数据库逻辑结构和特征的描述</span></p></li><li><p><span>是型的描述</span></p></li><li><p><span>反映的是数据的结构及其联系</span></p></li><li><p><span>模式是相对稳定的</span></p></li></ul><p>&nbsp;</p><p><strong><span>实例（Instance）</span></strong></p><ul><li><p><span>模式的一个具体值</span></p></li><li><p><span>反映数据库某一时刻的状态</span></p></li><li><p><span>同一个模式可以有很多实例</span></p></li><li><p><span>实例随数据库中的数据的更新而变动</span></p></li></ul><p>&nbsp;</p><p><span>例如：在学生选课数据库模式中，包含学生记录、课程记录和学生选课记录</span></p><p><span>2003年的一个学生数据库实例，包含：</span></p><ul><li><p><span>2003年学校中所有学生的记录</span></p></li><li><p><span>学校开设的所有课程的记录</span></p></li><li><p><span>所有学生选课的记录</span></p></li></ul><p><span>2002年度学生数据库模式对应的实例与2003年度学生数据库模式对应的实例是不同的。</span></p><p>&nbsp;</p><h3 id='数据库系统的三级模式结构'><span>数据库系统的三级模式结构</span></h3><p><img src="数据库系统概论/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkxNDYwNA==,size_16,color_FFFFFF,t_70-1710296408866-3.png" referrerpolicy="no-referrer" alt="img"></p><p>&nbsp;</p><h4 id='模式schema）'><span>模式（Schema）</span></h4><p><span>模式（也称逻辑模式）</span></p><ul><li><p><span>数据库中全体数据的逻辑结构和特征的描述</span></p></li><li><p><span>所有用户的公共数据视图，综合了所有用户的需求</span></p></li></ul><p>&nbsp;</p><blockquote><p><strong><span>一个数据库只有一个模式</span></strong><span>，可以把模式看成唯一的数据库，实例就是数据库里面的多个表。</span></p></blockquote><p>&nbsp;</p><p><span>模式的地位：是数据库系统模式结构的中间层</span></p><ul><li><p><span>与数据的物理存储细节和硬件环境无关</span></p></li><li><p><span>与具体的应用程序、开发工具及高级程序设计语言无关</span></p></li></ul><p>&nbsp;</p><p><span>模式的定义：</span></p><ul><li><p><span>数据的逻辑结构（数据项的名字、类型、取值范围等）</span></p></li><li><p><span>数据之间的联系</span></p></li><li><p><span>数据有关的安全性、完整性要求</span></p></li></ul><p>&nbsp;</p><h4 id='外模式external-schema）'><span>外模式（External Schema）</span></h4><p><span>外模式（也称子模式或用户模式）</span></p><ul><li><p><span>数据库用户（包括应用程序员和最终用户）使用的</span><strong><span>局部</span></strong><span>数据的逻辑结构和特征的描述</span></p></li><li><p><span>数据库用户的数据视图，是与某一应用有关的数据的逻辑表示，可以看成把数据库的部分数据，运用在不同的应用程序上，在UI界面上显示</span></p></li></ul><p>&nbsp;</p><blockquote><p><span>一个数据库只有一个模式，可以把模式看成唯一的数据库，实例就是数据库里面的多个表。</span></p></blockquote><p>&nbsp;</p><p><span>外模式的地位：介于模式与应用之间</span></p><p>&nbsp;</p><p><span>模式与外模式的关系：一对多</span></p><ul><li><p><span>外模式通常是模式的子集</span></p></li><li><p><span>一个数据库可以有多个外模式，不同的外模式反映了不同的用户的应用需求、看待数据的方式、对数据保密的要求。</span></p></li><li><p><span>模式中同一数据在外模式中的结构、类型、长度、保密级别等都可以不同</span></p></li></ul><p>&nbsp;</p><p><span>外模式与应用的关系：一对多</span></p><ul><li><p><span>同一外模式也可以为某一用户的多个应用系统所使用</span></p></li><li><p><span>但一个应用程序只能使用一个外模式，可以看成把数据库的部分数据，运用在不同的应用程序上，在UI界面上显示</span></p></li></ul><p>&nbsp;</p><p><span>外模式的用途：</span></p><ul><li><p><span>保证数据库安全性的一个有力措施</span></p></li><li><p><span>每个用户只能看见和访问所对应的外模式中的数据</span></p></li></ul><p>&nbsp;</p><h4 id='内模式internal-schema）'><span>内模式（Internal Schema）</span></h4><p><span>内模式（也称存储模式）</span></p><ul><li><p><span>是数据物理结构和存储方式的描述</span></p></li><li><p><span>一个数据库只有一个内模式</span></p></li><li><p><span>是数据在数据库内部的表示方式</span></p><ul><li><p><span>记录的存储方式（顺序存储，按照B树结构存储，按hash方法存储）</span></p></li><li><p><span>索引的组织方式</span></p></li><li><p><span>数据是否压缩存储</span></p></li><li><p><span>数据是否加密</span></p></li><li><p><span>数据存储记录结构的规定</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>例如学生记录，如果按堆存储，则插入一条新记录总是放在学生记录存储的最后</span></p><p><img src="数据库系统概论/image-20240313102804988.png" alt="image-20240313102804988" style="zoom:33%;" /></p><p>&nbsp;</p><p><span>如果按学号升序存储，则插入一条记录就要找到它应在的位置插入，如图1.29（b）所示</span></p><p><span>如果按照学生年龄聚簇存放，假如新插入的S3是16岁，则应插入的位置如图1.29（c）所示</span></p><p><img src="数据库系统概论/image-20240313102844156.png" alt="image-20240313102844156" style="zoom: 33%;" /></p><p>&nbsp;</p><p>&nbsp;</p><h4 id='数据库模式外模式内模式总结'><span>数据库模式、外模式、内模式总结</span></h4><p><img src="数据库系统概论/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkxNDYwNA==,size_16,color_FFFFFF,t_70-1710296948793-6.png" referrerpolicy="no-referrer" alt="img"></p><p>&nbsp;</p><p><span>数据库模式：</span></p><ul><li><p><span>即全局逻辑结构是数据库的中心与关键</span></p></li><li><p><span>独立于数据库的其他层次</span></p></li><li><p><span>设计数据库模式结构时应首先确定数据库的逻辑模式</span></p></li></ul><p><span>数据库的外模式：</span></p><ul><li><p><span>面向具体的应用程序</span></p></li><li><p><span>定义在逻辑模式之上</span></p></li><li><p><span>独立于存储模式和存储设备</span></p></li><li><p><span>当应用需求发生较大变化，相应外模式不能满足其视图要求时，该外模式就得做相应改动</span></p></li><li><p><span>设计外模式时应充分考虑到应用的扩充性</span></p></li></ul><p><span>数据库的内模式：</span></p><ul><li><p><span>依赖于它的全局逻辑结构</span></p></li><li><p><span>独立于具体的存储设备</span></p></li><li><p><span>将全局逻辑结构中所定义的数据结构及其联系按照一定的物理存储策略进行组织，以达到较好的时间与空间效率</span></p></li></ul><p>&nbsp;</p><h3 id='数据库的二级映像功能与数据独立性'><span>数据库的二级映像功能与数据独立性</span></h3><p><span>三级模式是对数据的三个抽象级别</span></p><p><span>二级映象在DBMS内部实现这三个抽象层次的联系和转换</span></p><p>&nbsp;</p><p><span>三级模式是对数据的三个抽象级别：</span></p><p><span>在数据库系统中，三级模式是对数据的三个抽象级别，分别是：</span></p><ol start='' ><li><p><strong><span>外模式（External Schema）</span></strong><span>：</span></p><ul><li><p><span>也称为用户模式或子模式。</span></p></li><li><p><span>它是数据库用户（包括应用程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图。</span></p></li><li><p><span>外模式是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。</span></p></li><li><p><span>它是数据库系统三级模式结构中的最外层，是用户与数据辜系统交互的接口。</span></p></li><li><p><span>对于一个外模式，数据库用户只能定义在其外模式描述范围内的数据，不能定义在此范围外的数据。</span></p></li></ul></li><li><p><strong><span>概念模式（Conceptual Schema）</span></strong><span>：</span></p><ul><li><p><span>也称为模式或逻辑模式。</span></p></li><li><p><span>它是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。</span></p></li><li><p><span>概念模式是数据库系统三级模式结构中的中间层，是所有用户的数据视图的集合，是数据库系统全局数据逻辑结构的描述，不受任何数据库管理系统支持的数据模型的影响。</span></p></li><li><p><span>概念模式是数据库设计人员进行数据库设计的有力工具，也是数据库管理系统运行的基本依据。</span></p></li></ul></li><li><p><strong><span>内模式（Internal Schema）</span></strong><span>：</span></p><ul><li><p><span>也称为存储模式或物理模式。</span></p></li><li><p><span>它是数据物理结构和存储方式的描述，是数据在数据库内部的表示方式。</span></p></li><li><p><span>内模式是数据库系统三级模式结构中的最内层，是数据库的存储观。</span></p></li><li><p><span>一个数据库只有一个内模式，它是数据库在数据库内部的表示，不受任何数据库管理系统支持的数据模型的影响。</span>
<span>这三个抽象级别可以帮助实现数据独立性，即应用程序和数据的物理存储相互独立，应用程序只需要和外模式交互，不必关心数据在数据库内部的存储方式，这样就可以在不改变应用程序的情况下，改变数据的存储方式，提高数据库系统的灵活性和可扩展性。</span></p></li></ul></li></ol><p>&nbsp;</p><p><span>二级映象在DBMS内部实现这三个抽象层次的联系和转换：</span></p><ul><li><p><span>外模式／模式映像</span></p></li><li><p><span>模式／内模式映像</span></p></li></ul><p><img src="数据库系统概论/image-20240313103352999.png" referrerpolicy="no-referrer" alt="image-20240313103352999"></p><p>&nbsp;</p><h4 id='外模式模式映象'><span>外模式／模式映象</span></h4><ul><li><p><span>模式：描述的是数据的全局逻辑结构</span></p></li><li><p><span>外模式：描述的是数据的局部逻辑结构</span></p></li><li><p><span>同一个模式可以有任意多个外模式</span></p></li><li><p><span>每一个外模式，数据库系统都有一个外模式／模式映象，定义外模式与模式之间的对应关系，看成数据库的数据与API调用的部分数据之间的关系(I think)</span></p></li><li><p><span>映象定义通常包含在各自外模式的描述中</span></p></li></ul><p>&nbsp;</p><p><span>保证数据的逻辑独立：</span></p><ul><li><p><span>当模式改变时，数据库管理员修改有关的外模式／模式映象，使外模式保持不变</span></p></li><li><p><span>应用程序是依据数据的外模式编写的，从而应用程序不必修改，保证了数据与程序的逻辑独立性，简称数据的逻辑独立性。</span></p></li></ul><p>&nbsp;</p><h4 id='模式内模式映象'><span>模式／内模式映象</span></h4><p><span>模式／内模式映象定义了数据全局逻辑结构与存储结构之间的对应关系。例如，说明逻辑记录和字段在内部是如何表示的</span></p><p>&nbsp;</p><ul><li><p><span>数据库中模式／内模式映象是唯一的</span></p></li><li><p><span>该映象定义通常包含在模式描述中</span></p></li></ul><p>&nbsp;</p><p><span>保证数据的物理独立性：</span></p><ul><li><p><span>当数据库的存储结构改变了（例如选用了另一种存储结构），数据库管理员修改模式／内模式映象，使模式保持不变</span></p></li><li><p><span>应用程序不受影响。保证了数据与程序的物理独立性，简称数据的物理独立性。</span></p></li></ul><p>&nbsp;</p><p><span>特定的应用程序：</span></p><ul><li><p><span>在外模式描述的数据结构上编制的</span></p></li><li><p><span>依赖于特定的外模式</span></p></li><li><p><span>与数据库的模式和存储结构独立</span></p></li><li><p><span>不同的应用程序有时可以共用同一个外模式</span></p></li></ul><p><span>数据库的二级映像：</span></p><ul><li><p><span>保证了数据库外模式的稳定性</span></p></li><li><p><span>从底层保证了应用程序的稳定性，除非应用需求本身发生变化，否则应用程序一般不需要修改</span></p></li></ul><p><span>数据与程序之间的独立性，使得数据的定义和描述可以从应用程序中分离出去</span></p><p><span>数据的存取由DBMS管理</span></p><ul><li><p><span>用户不必考虑存取路径等细节</span></p></li><li><p><span>简化了应用程序的编制</span></p></li><li><p><span>大大减少了应用程序的维护和修改</span></p></li></ul><p>&nbsp;</p><h2 id='数据库的组成'><span>数据库的组成</span></h2><ul><li><p><span>数据库</span></p></li><li><p><span>数据库管理系统（及其开发工具）</span></p></li><li><p><span>应用系统</span></p></li><li><p><span>数据库管理员</span></p></li><li><p><span>硬件平台及数据库</span></p></li><li><p><span>软件</span></p></li><li><p><span>人员</span></p></li></ul><p>&nbsp;</p><h3 id='硬件平台及数据库'><span>硬件平台及数据库</span></h3><p><span>数据库系统对硬件资源的要求：</span></p><ul><li><p><span>足够大的内存</span></p><ul><li><p><span>操作系统</span></p></li><li><p><span>DBMS的核心模块</span></p></li><li><p><span>数据缓冲区</span></p></li><li><p><span>应用程序</span></p></li></ul></li><li><p><span>足够大的外存</span></p><ul><li><p><span>磁盘或磁盘阵列</span></p></li><li><p><span>数据库</span></p></li><li><p><span>光盘、磁带</span></p></li><li><p><span>数据备份</span></p></li></ul></li><li><p><span>较高的通道能力，提高数据传送率</span></p></li></ul><p>&nbsp;</p><h3 id='软件'><span>软件</span></h3><ul><li><p><span>DBMS</span></p></li><li><p><span>支持DBMS运行的操作系统</span></p></li><li><p><span>与数据库接口的高级语言及其编译系统</span></p></li><li><p><span>以DBMS为核心的应用开发工具</span></p></li><li><p><span>为特定应用环境开发的数据库应用系统</span></p></li></ul><p>&nbsp;</p><h3 id='人员'><span>人员</span></h3><ul><li><p><span>数据库管理员</span></p></li><li><p><span>系统分析员</span></p></li><li><p><span>数据库设计人员</span></p></li><li><p><span>应用程序员</span></p></li><li><p><span>用户</span></p></li></ul><p>&nbsp;</p><p><span>不同的人员涉及不同的数据抽象级别，具有不同的数据视图，如下图所示：</span></p><p><img src="数据库系统概论/image-20240313104520346.png" alt="image-20240313104520346" style="zoom:33%;" /></p><p>&nbsp;</p><h4 id='数据库管理员dba'><span>数据库管理员(DBA)</span></h4><p><span>具体职责：</span></p><ol start='' ><li><p><span>决定数据库中的信息内容和结构</span></p></li><li><p><span>决定数据库的存储结构和存取策略</span></p></li><li><p><span>定义数据的安全性要求和完整性约束条件</span></p></li><li><p><span>监控数据库的使用和运行</span></p><ul><li><p><span>周期性转储数据库</span></p></li><li><p><span>数据文件</span></p></li><li><p><span>日志文件</span></p></li><li><p><span>系统故障恢复</span></p></li><li><p><span>介质故障恢复</span></p></li><li><p><span>监视审计文件</span></p></li></ul></li><li><p><span>数据库的改进和重组</span></p><ul><li><p><span>性能监控和调优</span></p></li><li><p><span>定期对数据库进行重组织，以提高系统的性能</span></p></li><li><p><span>需求增加和改变时，数据库须需要重构造</span></p></li></ul></li></ol><p>&nbsp;</p><h4 id='系统分析员'><span>系统分析员</span></h4><p><span>具体职责：</span></p><ul><li><p><span>负责应用系统的需求分析和规范说明</span></p></li><li><p><span>与用户及DBA协商，确定系统的硬软件配置</span></p></li><li><p><span>参与数据库系统的概要设计</span></p></li></ul><p>&nbsp;</p><h4 id='数据库设计人员'><span>数据库设计人员</span></h4><p><span>具体职责：</span></p><ul><li><p><span>参加用户需求调查和系统分析</span></p></li><li><p><span>确定数据库中的数据</span></p></li><li><p><span>设计数据库各级模式</span></p></li></ul><p>&nbsp;</p><h4 id='应用程序员'><span>应用程序员</span></h4><p><span>具体职责：</span></p><ul><li><p><span>设计和编写应用系统的程序模块</span></p></li><li><p><span>进行调试和安装</span></p></li></ul><p>&nbsp;</p><h4 id='用户'><span>用户</span></h4><p><span>用户是指最终用户（End User）。</span></p><p><span>最终用户通过应用系统的用户接口使用数据库。</span></p><ol start='' ><li><p><span>偶然用户</span></p><ul><li><p><span>不经常访问数据库，但每次访问数据库时往往需要不同的数据库信息</span></p></li><li><p><span>企业或组织机构的高中级管理人员</span></p></li></ul></li><li><p><span>简单用户</span></p><ul><li><p><span>主要工作是查询和更新数据库</span></p></li><li><p><span>银行的职员、机票预定人员、旅馆总台服务员</span></p></li></ul></li><li><p><span>复杂用户</span></p><ul><li><p><span>工程师、科学家、经济学家、科技工作者等</span></p></li><li><p><span>直接使用数据库语言访问数据库，甚至能够基于数据库管理系统的API编制自己的应用程序</span></p></li></ul></li></ol><p>&nbsp;</p><h1 id='关系数据结构及形式化定义'><span>关系数据结构及形式化定义</span></h1><p>&nbsp;</p><p><img src="数据库系统概论/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzkxNDYwNA==,size_16,color_FFFFFF,t_70-1710298364902-9.png" referrerpolicy="no-referrer" alt="在这里插入图片描述"></p><p>&nbsp;</p><h2 id='关系'><span>关系</span></h2><p><span>什么是关系？</span></p><ul><li><p><span>单一的数据结构——关系</span></p><ul><li><p><span>现实世界的实体以及实体间的各种联系均用关系来表示</span></p></li></ul></li><li><p><span>逻辑结构——二维表</span></p><ul><li><p><span>从用户角度，关系模型中数据的逻辑结构是一张二维表</span></p></li></ul></li><li><p><span>建立在集合代数的基础上</span></p></li></ul><p>&nbsp;</p><h3 id='域domain）'><span>域（Domain）</span></h3><p><span>域是一组具有相同数据类型的值的集合。</span></p><p><span>例：</span></p><ul><li><p><span>整数</span></p></li><li><p><span>实数</span></p></li><li><p><span>介于某个取值范围的整数</span></p></li><li><p><span>长度指定长度的字符串集合</span></p></li><li><p><span>{‘男’，‘女’}</span></p></li></ul><p>&nbsp;</p><h3 id='笛卡尔积cartesian-product）'><span>笛卡尔积（Cartesian Product）</span></h3><h4 id='笛卡尔积cartesian-product）-2'><span>笛卡尔积（Cartesian Product）</span></h4><p><span>给定一组域D1，D2，…，Dn，这些域中可以有相同的。</span></p><p><span>D1，D2，…，Dn的笛卡尔积为：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1334" cid="n1334" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-rawblock-container md-math-container" tabindex="-1"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="48.874ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 21602.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-1-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-1-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-1-TEX-N-2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-1-TEX-N-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJX-1-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-1-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-N-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJX-1-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-1-TEX-N-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path id="MJX-1-TEX-N-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(861,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(1486.8,0)"><use data-c="D7" xlink:href="#MJX-1-TEX-N-D7"></use></g><g data-mml-node="msub" transform="translate(2487,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(861,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(3973.8,0)"><use data-c="D7" xlink:href="#MJX-1-TEX-N-D7"></use></g><g data-mml-node="mo" transform="translate(4974,0)"><use data-c="2026" xlink:href="#MJX-1-TEX-N-2026"></use></g><g data-mml-node="mo" transform="translate(6368.2,0)"><use data-c="D7" xlink:href="#MJX-1-TEX-N-D7"></use></g><g data-mml-node="msub" transform="translate(7368.4,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(861,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"></use></g></g><g data-mml-node="mo" transform="translate(8981.5,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="mrow" transform="translate(10037.3,0)"><g data-mml-node="mo"><use data-c="7B" xlink:href="#MJX-1-TEX-N-7B"></use></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-1-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(1624.7,0)"><use data-c="2208" xlink:href="#MJX-1-TEX-N-2208"></use></g><g data-mml-node="msub" transform="translate(2569.5,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(861,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"></use></g></g><g data-mml-node="mo" transform="translate(3724.5,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(4169.1,0)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(4791.9,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(5847.7,0)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(6347.7,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(6792.3,0)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g><g data-mml-node="mo" transform="translate(7292.3,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mn" transform="translate(7737,0)"><use data-c="33" xlink:href="#MJX-1-TEX-N-33"></use></g><g data-mml-node="mo" transform="translate(8237,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mo" transform="translate(8681.7,0)"><use data-c="2026" xlink:href="#MJX-1-TEX-N-2026"></use></g><g data-mml-node="mo" transform="translate(10020.3,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(10465,0)"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(11065,0)"><use data-c="7D" xlink:href="#MJX-1-TEX-N-7D"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mn>1</mn></msub><mo>×</mo><msub><mi>D</mi><mn>2</mn></msub><mo>×</mo><mo>…</mo><mo>×</mo><msub><mi>D</mi><mi>n</mi></msub><mo>=</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">{</mo><msub><mi>d</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>D</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo data-mjx-texclass="CLOSE">}</mo></mrow></math></mjx-assistive-mml></mjx-container></div></div><p><span>所有域的所有取值的一个组合，且不能重复。</span></p><p><span>笛卡儿积不一定有意义。</span></p><p>&nbsp;</p><h4 id='元组tuple）'><span>元组（Tuple）</span></h4><p><span>笛卡尔积中每一个元素（d1，d2，…，dn）叫作一个n元组（n-tuple）或简称元组(Tuple)</span></p><p><span>(张清玫，计算机专业，李勇)、(张清玫，计算机专业，刘晨)等都是元组</span></p><p>&nbsp;</p><h4 id='分量component）'><span>分量（Component）</span></h4><p><span>笛卡尔积元素（d1，d2，…，dn）中的每一个值 di 叫作一个分量</span></p><p><span>张清玫、计算机专业、李勇、刘晨等都是分量</span></p><p>&nbsp;</p><h4 id='基数cardinal-number）'><span>基数（Cardinal number）</span></h4><p><span>可以把基数看做笛卡尔积元素的个数，及元组的个数</span></p><p><span>若Di（i＝1，2，…，n）为有限集，其基数为mi（i＝1，2，…，n），则D1×D2×…×Dn的基数M为：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1349" cid="n1349" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-rawblock-container md-math-container" tabindex="-1"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="11.39ex" height="6.354ex" role="img" focusable="false" viewBox="0 -1562.5 5034.2 2808.5" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -2.819ex;"><defs><path id="MJX-2-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-2-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-2-TEX-LO-220F" d="M220 812Q220 813 218 819T214 829T208 840T199 853T185 866T166 878T140 887T107 893T66 896H56V950H1221V896H1211Q1080 896 1058 812V-311Q1076 -396 1211 -396H1221V-450H725V-396H735Q864 -396 888 -314Q889 -312 889 -311V896H388V292L389 -311Q405 -396 542 -396H552V-450H56V-396H66Q195 -396 219 -314Q220 -312 220 -311V812Z"></path><path id="MJX-2-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-2-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-2-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(1328.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="munderover" transform="translate(2384.6,0)"><g data-mml-node="mo"><use data-c="220F" xlink:href="#MJX-2-TEX-LO-220F"></use></g><g data-mml-node="TeXAtom" transform="translate(65.2,-1087.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-2-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="TeXAtom" transform="translate(426.9,1150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-2-TEX-I-1D45B"></use></g></g></g><g data-mml-node="msub" transform="translate(3829.2,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(911,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-2-TEX-I-1D456"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mo>=</mo><munderover><mo data-mjx-texclass="OP">∏</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>n</mi></mrow></munderover><msub><mi>m</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container></div></div><h4 id='笛卡尔积的表示方式'><span>笛卡尔积的表示方式</span></h4><p><span>笛卡尔积可表示为一个二维表</span></p><p><span>表中的每行对应一个元组，表中的每列对应一个域</span></p><p><img src="数据库系统概论/image-20240313110559849.png" alt="image-20240313110559849" style="zoom:33%;" /></p><p>&nbsp;</p><h3 id='关系relation）'><span>关系（Relation）</span></h3><h4 id='关系-2'><span>关系</span></h4><p><strong><span>笛卡尔积D1×D2×…×Dn的子集</span></strong><span>叫作在域D1，D2，…，Dn上的关系，表示为：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="18.267ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8074 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-3-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJX-3-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-3-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-3-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-3-TEX-N-2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path><path id="MJX-3-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-3-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D445" xlink:href="#MJX-3-TEX-I-1D445"></use></g><g data-mml-node="mo" transform="translate(759,0)"><use data-c="28" xlink:href="#MJX-3-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1148,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-3-TEX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(861,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(2412.6,0)"><use data-c="2C" xlink:href="#MJX-3-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(2857.2,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-3-TEX-I-1D437"></use></g><g data-mml-node="mn" transform="translate(861,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(4121.8,0)"><use data-c="2C" xlink:href="#MJX-3-TEX-N-2C"></use></g><g data-mml-node="mo" transform="translate(4566.4,0)"><use data-c="2026" xlink:href="#MJX-3-TEX-N-2026"></use></g><g data-mml-node="mo" transform="translate(5905.1,0)"><use data-c="2C" xlink:href="#MJX-3-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(6349.8,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-3-TEX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(861,-150) scale(0.707)"><use data-c="1D45B" xlink:href="#MJX-3-TEX-I-1D45B"></use></g></g><g data-mml-node="mo" transform="translate(7685,0)"><use data-c="29" xlink:href="#MJX-3-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><msub><mi>D</mi><mn>1</mn></msub><mo>,</mo><msub><mi>D</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>D</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">R(D_1,D_2,\ldots,D_n)</script></p><p><span>R：关系名</span></p><p><span>n：关系的目或度（Degree）</span></p><p><em><span>一般要取有意义的子集作为关系</span></em></p><p>&nbsp;</p><h4 id='元组'><span>元组</span></h4><p><span>关系中的每个元素是关系中的元组，通常用 t 表示。</span></p><p>&nbsp;</p><h4 id='单元关系与二元关系'><span>单元关系与二元关系</span></h4><p><span>当n=1时，称该关系为单元关系（Unary relation）或一元关系</span></p><p><span>当n=2时，称该关系为二元关系（Binary relation）</span></p><p>&nbsp;</p><h4 id='关系的表示'><span>关系的表示</span></h4><p><span>关系也是一个二维表，表的每行对应一个元组，表的每列对应一个域</span></p><p><img src="数据库系统概论/image-20240313111545606.png" alt="image-20240313111545606" style="zoom:33%;" /></p><p>&nbsp;</p><h4 id='属性'><span>属性</span></h4><p><span>关系中不同列可以对应相同的域</span></p><p><span>为了加以区分，必须对每列起一个名字，称为属性（Attribute）</span></p><p><span>n目关系必有n个属性</span></p><p>&nbsp;</p><h4 id='码'><span>码</span></h4><p><span>候选码（Candidate key）</span></p><ul><li><p><span>若关系中的某一属性组的值能唯一地标识一个元组，则称该属性组为候选码</span></p></li><li><p><span>简单的情况：候选码只包含一个属性</span></p></li></ul><p><span>全码（All-key）</span></p><ul><li><p><span>最极端的情况：关系模式的所有属性组是这个关系模式的候选码，称为全码（All-key）</span></p></li></ul><p><span>主码</span></p><ul><li><p><span>若一个关系有多个候选码，则选定其中一个为主码（Primary key）</span></p></li></ul><p><span>主属性</span></p><ul><li><p><span>候选码的诸属性称为主属性（Prime attribute）</span></p></li><li><p><span>不包含在任何侯选码中的属性称为非主属性（ Non-Prime attribute）或非码属性（Non-key attribute）</span></p></li></ul><p>&nbsp;</p><p><span>D1，D2，…，Dn的笛卡尔积的某个子集才有实际含义</span></p><p><span>例：表2.1 的笛卡尔积没有实际意义</span></p><p><img src="数据库系统概论/image-20240313111754544.png" alt="image-20240313111754544" style="zoom:33%;" /></p><p><span>取出有实际意义的元组来构造关系</span></p><p><span>关系：SAP(SUPERVISOR，SPECIALITY，POSTGRADUATE)</span></p><p><span>假设：导师与专业：1:1， 导师与研究生：1:n</span></p><p><span>主码：POSTGRADUATE（假设研究生不会重名）</span></p><p><span>SAP关系可以包含三个元组：</span></p><p><span>｛ (张清玫，计算机专业，李勇)， (张清玫，计算机专业，刘晨)，(刘逸，信息专业，王敏) }</span></p><p>&nbsp;</p><h3 id='三类关系'><span>三类关系</span></h3><p><span>基本关系（基本表或基表）：实际存在的表，是实际存储数据的逻辑表示</span></p><p><span>查询表：查询结果对应的表</span></p><p><span>视图表：由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据</span></p><p>&nbsp;</p><blockquote><ul><li><p><span>在 SQL 中，视图是基于 SQL 语句的结果集的可视化的表。</span></p></li><li><p><span>视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。</span></p></li><li><p><span>我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。</span></p></li><li><p><span>注释：数据库的设计和结构不会受到视图中的函数、where 或 join 语句的影响。</span></p></li></ul></blockquote><p>&nbsp;</p><p><span>限定和扩充</span></p><ul><li><p><span>无限关系在数据库中没有意义，限定关系为有限集合</span></p></li><li><p><span>由于笛卡儿积数学上不满足交换律 ， 因此(d1,d2,…,dn) != (d2, d1,…,dn)。通过为关系的每个列增加一个属性名的方法来取消关系属性的有序性，即(d1,d2,…,di,dj,…,dn) = (d1, d2 ,…,dj,di,…, dn)</span></p></li></ul><p>&nbsp;</p><p><span>基本关系(二维表)的性质：</span></p><ul><li><p><span>列是同质的（Homogeneous）</span></p></li><li><p><span>不同的列可出自同一个域，其中的每一列称为一个属性，不同的属性要给予不同的属性名</span></p></li><li><p><span>列的顺序无所谓，列的次序可以任意交换</span></p></li><li><p><span>任意两个元组的候选码不能相同</span></p></li><li><p><span>行的顺序无所谓，行的次序可以任意交换</span></p></li><li><p><span>分量必须取原子值，这是规范条件中最基本的一条</span></p></li></ul><p>&nbsp;</p><p><img src="数据库系统概论/image-20240313112545920.png" alt="image-20240313112545920" style="zoom:33%;" /></p><p>&nbsp;</p><h2 id='关系模式'><span>关系模式</span></h2><h3 id='什么是关系模式'><span>什么是关系模式</span></h3><ul><li><p><span>关系模式（Relation Schema）是型</span></p></li><li><p><span>关系是值</span></p></li></ul><p>&nbsp;</p><p><span>关系模式是对关系的描述：</span></p><ul><li><p><span>元组集合的结构</span></p><ul><li><p><span>属性构成</span></p></li><li><p><span>属性来自的域</span></p></li><li><p><span>属性与域之间的映象关系</span></p></li></ul></li><li><p><span>元组语义以及完整性约束条件</span></p></li><li><p><span>属性间的数据依赖关系集合</span></p></li></ul><p>&nbsp;</p><h3 id='定义关系模式'><span>定义关系模式</span></h3><p><span>关系模式可以形式化地表示为：</span></p><ul><li><p><span>R（U，D，DOM，F）</span></p></li><li><p><span>R 关系名</span></p></li><li><p><span>U 组成该关系的属性名集合</span></p></li><li><p><span>D 属性组U中属性所来自的域</span></p></li><li><p><span>DOM 属性向域的映象集合</span></p></li><li><p><span>F 属性间的数据依赖关系集合</span></p></li></ul><p>&nbsp;</p><p><span>举例：</span></p><p><span>导师和研究生出自同一个域——人，取不同的属性名，并在模式中定义属性向域的映象，即说明它们分别出自哪个域</span></p><p><span>DOM（SUPERVISOR-PERSON）= DOM（POSTGRADUATE-PERSON）= PERSON</span></p><p>&nbsp;</p><p><span>关系模式通常可以简记为：</span></p><p><span>R (U) 或 R (A1，A2，…，An)</span></p><p><span>R: 关系名</span></p><p><span>A1，A2，…，An : 属性名</span></p><p><span>注：域名及属性向域的映象常常直接说明为属性的类型、长度</span></p><p>&nbsp;</p><h2 id='关系模式和关系的对比'><span>关系模式和关系的对比</span></h2><p><span>关系模式：</span></p><ul><li><p><span>对关系的描述</span></p></li><li><p><span>静态的、稳定的</span></p></li></ul><p><span>关系：</span></p><ul><li><p><span>关系模式在某一时刻的状态或内容</span></p></li><li><p><span>动态的、随时间不断变化的</span></p></li><li><p><span>关系模式和关系往往统称为关系，需要其他上下文加以区别</span></p></li></ul><p>&nbsp;</p><blockquote><p><span>在数据库学科中可以把关系模式理解为表的结构、属性之间的关系、约束条件，把关系理解为二维表。</span></p></blockquote><p>&nbsp;</p><h2 id='关系数据库'><span>关系数据库</span></h2><p><span>关系数据库：</span></p><ul><li><p><span>在一个给定的应用领域中，所有关系（二维表）的集合构成一个关系数据库</span></p></li></ul><p><span>关系数据库模式包括：</span></p><ul><li><p><span>若干域的定义</span></p></li><li><p><span>在这些域上定义的若干关系模式</span></p></li></ul><p><span>关系数据库的型与值：</span></p><ul><li><p><span>关系数据库的型：关系数据库模式, 对关系数据库的描述。</span></p></li><li><p><span>关系数据库的值：关系模式在某一时刻对应的关系的集合，简称为关系数据库。</span></p></li></ul><p><span>关系模型的存储结构：</span></p><ul><li><p><span>实体及实体的联系用Table来表示，但Table是逻辑模型</span></p></li><li><p><span>有的关系数据库管理系统中一个表对应一个操作系统的文件，将物理数据组织交给操作系统完成 (Foxpro)</span></p></li><li><p><span>有的关系数据库管理系统从操作系统那里申请若干个文件，自己划分文件空间，组织表、索引等存储结构并进行存储管理</span></p></li></ul><p>&nbsp;</p><h2 id='关系操作'><span>关系操作</span></h2><h3 id='基本关系操作'><span>基本关系操作</span></h3><ul><li><p><span>常用的关系操作</span></p><ul><li><p><span>查询：选择、投影、连接、除、并、交、差、笛卡尔积</span></p><ul><li><p><span>选择、投影、并、差、笛卡尔基是5种基本操作</span></p></li></ul></li><li><p><span>数据更新：插入、删除、修改</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>关系操作的特点：集合操作方式，操作的对象和结果都是集合，一次一集合的方式。</span></p><p>&nbsp;</p><h3 id='关系数据库语言的分类'><span>关系数据库语言的分类</span></h3><ol start='' ><li><p><span>关系代数语言：用对关系的运算来表达查询要求，代表：ISBL</span></p></li><li><p><span>关系演算语言：用谓词来表达查询要求</span></p></li><li><p><span>元组关系演算语言：谓词变元的基本对象是元组变量，代表：APLHA, QUEL；</span></p></li><li><p><span>域关系演算语言：谓词变元的基本对象是域变量，代表：QBE；</span></p></li><li><p><span>具有关系代数和关系演算双重特点的语言：代表：SQL（Structured Query Language） </span></p></li></ol><p>&nbsp;</p><p><span>在数据库理论和实践中，</span><strong><span>关系代数语言</span></strong><span>、</span><strong><span>元组关系演算语言</span></strong><span>和</span><strong><span>域关系演算语言</span></strong><span>是三种抽象的查询语言，它们用于定义和操作关系数据库中的数据。这些语言提供了理论基础，用于描述如何从数据库中检索和操作数据。然而，在实际的数据库管理系统中，为了提高实用性和方便用户操作，往往会扩展这些基本语言，增加许多附加功能。</span></p><p><span>以下是一些常见的实用性附加功能：</span></p><ol start='' ><li><p><strong><span>聚集函数</span></strong><span>：</span></p><ul><li><p><span>如 COUNT、SUM、AVG、MAX、MIN 等，用于对查询结果进行统计分析。</span></p></li></ul></li><li><p><strong><span>关系赋值</span></strong><span>：</span></p><ul><li><p><span>允许将查询结果赋给变量，以便在后续查询中使用。</span></p></li></ul></li><li><p><strong><span>算数运算</span></strong><span>：</span></p><ul><li><p><span>支持对数值类型的列进行加、减、乘、除等算数运算。</span></p></li></ul></li><li><p><strong><span>比较运算符</span></strong><span>：</span></p><ul><li><p><span>除了传统的等于、不等于、大于、小于等比较运算符外，还可能包括如 IN、BETWEEN、LIKE 等用于复杂比较的运算符。</span></p></li></ul></li><li><p><strong><span>逻辑运算符</span></strong><span>：</span></p><ul><li><p><span>如 AND、OR、NOT，用于组合多个条件表达式。</span></p></li></ul></li><li><p><strong><span>连接运算符</span></strong><span>：</span></p><ul><li><p><span>支持不同类型的连接操作，如内连接（INNER JOIN）、外连接（LEFT/RIGHT/FULL OUTER JOIN）等。</span></p></li></ul></li><li><p><strong><span>子查询</span></strong><span>：</span></p><ul><li><p><span>允许在查询中嵌套其他查询，以便实现更复杂的检索逻辑。</span></p></li></ul></li><li><p><strong><span>数据定义语言（DDL）</span></strong><span>：</span></p><ul><li><p><span>如 CREATE、DROP、ALTER，用于定义和修改数据库结构。</span></p></li></ul></li><li><p><strong><span>数据控制语言（DCL）</span></strong><span>：</span></p><ul><li><p><span>如 GRANT、REVOKE，用于控制不同用户对数据库的访问权限。</span></p></li></ul></li><li><p><strong><span>事务控制语言</span></strong><span>：</span></p><ul><li><p><span>如 COMMIT、ROLLBACK，用于管理数据库事务。</span></p></li></ul></li><li><p><strong><span>窗口函数</span></strong><span>：</span></p><ul><li><p><span>如 RANK、DENSE_RANK、ROW_NUMBER，用于对查询结果集进行分组和排序。</span></p></li></ul></li></ol><p><span>这些附加功能使得实际的查询语言（如 SQL）功能非常强大，能够满足用户在数据库操作中的各种需求。通过这些功能，用户可以执行复杂的查询、更新和管理操作，从而有效地使用数据库系统。</span></p><p>&nbsp;</p><p><span>SQL 包括以下四种语言：</span></p><ol start='' ><li><p><span>数据查询语言（DQL）：主要用于查询数据库中的数据，例如 SELECT 语句。</span></p></li><li><p><span>数据定义语言（DDL）：用于定义数据库的结构，例如 CREATE、DROP 和 ALTER 语句。</span></p></li><li><p><span>数据操纵语言（DML）：用于操纵数据库中的数据，例如 INSERT、UPDATE 和 DELETE 语句。</span></p></li><li><p><span>数据控制语言（DCL）：用于控制不同数据的访问权限，例如 GRANT 和 REVOKE 语句。</span></p></li></ol><p>&nbsp;</p><p><span>SQL与存储路径无关</span></p><p><span>SQL可进行查询优化</span></p><p>&nbsp;</p><h2 id='关系的完整性'><span>关系的完整性</span></h2><p><span>对关系的约束。</span></p><p><span>关系的值随时间变化应满足的约束条件，通常是现实世界的要求，任何时候都需要满足这些语义约束</span></p><p>&nbsp;</p><p><span>关系的三类完整性约束：</span></p><ul><li><p><strong><span>实体完整性</span></strong><span>和</span><strong><span>参照完整性</span></strong><span>称为关系的两个不变性，应该由关系系统自动支持。</span></p></li><li><p><strong><span>用户定义的完整性</span></strong><span>需要遵循应用领域的约束条件，体现了具体领域中的语义约束。</span></p></li></ul><p>&nbsp;</p><h3 id='实体完整性entity-integrity）'><span>实体完整性（Entity Integrity）</span></h3><p><span>关系数据库中的每个元组应当是可区分的。</span></p><p>&nbsp;</p><p><span>规则2.1 实体完整性规则：</span></p><ul><li><p><span>若属性A是基本关系R的主属性，则属性A不能取空值。</span></p></li><li><p><span>空值就是“不知道”或“不存在”或“无意义”的值</span></p></li></ul><p>&nbsp;</p><p><span>例：</span></p><p><span>SAP(SUPERVISOR，SPECIALITY，POSTGRADUATE)</span></p><p><span>POSTGRADUATE：</span></p><p><span>主码（假设研究生不会重名）</span></p><p><span>不能取空值</span></p><p>&nbsp;</p><p><span>实体完整性规则的说明：</span></p><ul><li><p><span>实体完整性规则是针对基本关系而言的。一个基本表通常对应现实世界的一个实体集。</span></p></li><li><p><span>现实世界中的实体是可区分的，即它们具有某种唯一性标识。</span></p></li><li><p><span>关系模型中以主码作为唯一性标识。</span></p></li><li><p><span>主码中的属性即主属性不能取空值。主属性取空值，就说明存在某个不可标识的实体，即存在不可区分的实体，这与第 2 点相矛盾，因此这个规则称为实体完整性。</span></p></li></ul><p>&nbsp;</p><h3 id='参照完整性referential-integrity）'><span>参照完整性（Referential Integrity）</span></h3><p><span>在关系模型中实体和实体间的联系都是用关系来描述的，因此可能存在着关系和关系间的引用。</span></p><p>&nbsp;</p><h4 id='关系间的引用'><span>关系间的引用</span></h4><p>&nbsp;</p><p><img src="数据库系统概论/image-20240313195734080.png" alt="image-20240313195734080" style="zoom: 67%;" /></p><p><img src="数据库系统概论/image-20240313195905481.png" alt="image-20240313195905481" style="zoom:67%;" /></p><p><img src="数据库系统概论/image-20240313195928446.png" alt="image-20240313195928446" style="zoom:67%;" /></p><p>&nbsp;</p><blockquote><p><span>参照完整性（Referential Integrity）：描述实体之间的联系。在关系模型中，实体以及实体之间的联系都用关系来表示。参照完整性一般指多个实体或关系之间的关联关系。这涉及到外键的定义，规定了外键与被参照的主键之间的引用规则。外键可以为空值，或者等于其所参照的关系中某个元组的主键值。</span></p></blockquote><p>&nbsp;</p><h4 id='外码foreign-key）'><span>外码（Foreign Key）</span></h4><p><span>设F是基本关系R的一个或一组属性，但不是关系R的码。如果F与基本关系S的主码Ks相对应，则称F是基本关系R的外码，即该码是另一个表的主码。</span></p><p><span>基本关系R称为参照关系（Referencing Relation），即本表。</span></p><p><span>基本关系S称为被参照关系（Referenced Relation） 或目标关系（Target Relation），即外码对应的主码所在的表。</span></p><p><img src="数据库系统概论/image-20240313200103844.png" alt="image-20240313200103844" style="zoom:67%;" /></p><p><img src="数据库系统概论/image-20240313200119679.png" alt="image-20240313200119679" style="zoom:67%;" /></p><p><img src="数据库系统概论/image-20240313200134363.png" alt="image-20240313200134363" style="zoom:67%;" /></p><p>&nbsp;</p><ul><li><p><span>关系R和S不一定是不同的关系</span></p></li><li><p><span>目标关系S的主码Ks和参照关系的外码F必须定义在同一个（或一组）域上</span></p></li><li><p><span>外码并不一定要与相应的主码同名，当外码与相应的主码属于不同关系时，往往取相同的名字，以便于识别</span></p></li></ul><p>&nbsp;</p><h4 id='参照完整性规则'><span>参照完整性规则</span></h4><p><span>规则2.2 参照完整性规则：</span></p><p><span>若属性（或属性组）F是基本关系R的外码它与基本关系S的主码Ks相对应（基本关系R和S不一定是不同的关系），则对于R中每个元组在F上的值必须为：</span></p><ul><li><p><span>或者取空值（F的每个属性值均为空值）</span></p></li><li><p><span>或者等于S中某个元组的主码值</span></p></li></ul><p>&nbsp;</p><blockquote><p><span>外码的值要么为空，要么为S中某个元组的主码值。</span></p></blockquote><p>&nbsp;</p><p><img src="数据库系统概论/image-20240313200433580.png" alt="image-20240313200433580" style="zoom: 67%;" /></p><p><img src="数据库系统概论/image-20240313200519198.png" alt="image-20240313200519198" style="zoom:67%;" /></p><p><img src="数据库系统概论/image-20240313200530465.png" alt="image-20240313200530465" style="zoom:67%;" /></p><p>&nbsp;</p><h3 id='用户定义的完整性user-defined-integrity）'><span>用户定义的完整性（User-defined Integrity）</span></h3><ul><li><p><span>针对某一具体关系数据库的约束条件，反映某一具体应用所涉及的数据必须满足的语义要求</span></p></li><li><p><span>关系模型应提供定义和检验这类完整性的机制，以便用统一的系统的方法处理它们，而不要由应用程序承担这一功能</span></p></li></ul><p>&nbsp;</p><p><img src="数据库系统概论/image-20240313200559958.png" alt="image-20240313200559958" style="zoom: 67%;" /></p><p>&nbsp;</p><h2 id='关系代数'><span>关系代数</span></h2><p><span>关系代数是一种抽象的查询语言，它用对关系的运算来表达查询。</span></p><p>&nbsp;</p><p><span>运算三要素：</span></p><ul><li><p><span>运算对象</span></p></li><li><p><span>运算符</span></p></li><li><p><span>运算结果</span></p></li></ul><p>&nbsp;</p><p><span>运算对象是关系，运算结果亦为关系</span></p><p><span>关系代数的运算符有两类：集合运算符和专门的关系运算符</span></p><p><span>传统的集合运算是从关系的“水平”方向即行的角度进行</span></p><p><span>专门的关系运算不仅涉及行而且涉及列</span></p><p>&nbsp;</p><h3 id='关系代数运算符'><span>关系代数运算符</span></h3><p><img src="数据库系统概论/image-20240503163357433.png" alt="image-20240503163357433" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>四个传统集合运算是并（Union）、差（Difference）、交（Intersection）、笛卡尔积（Cartesian Product），它们可以用来操作关系之间的元组。</span></p><p>&nbsp;</p><h3 id='传统的集合运算'><span>传统的集合运算</span></h3><p><span>传统的集合运算是二目运算。并不是任意的两个关系都能进行这种集合运算。除笛卡尔积外，要求参加运算的关系必须具备相容性。</span></p><p>&nbsp;</p><p><span>定义：设给定两个关系R、S，若满足：</span></p><ol start='' ><li><p><span>具有相同的度n</span></p></li><li><p><span>R中第</span><code>i</code><span>个属性和S中第</span><code>i</code><span>个属性来自同一个域</span></p></li></ol><p><span>则说关系R、S是相容的。</span></p><p>&nbsp;</p><ol start='' ><li><p><span>并（Union）：</span></p><ul><li><p><span>并运算符用于将两个关系的元组合并成一个关系。结果包含了两个关系的所有元组，但会自动去除重复项，确保结果中的元组是唯一的。</span></p></li><li><p><span>符号表示为 ∪（并集符号），即 R ∪ S。</span></p></li><li><p><span>示例：如果关系 R 包含元组 {1, 2, 3}，而关系 S 包含元组 {3, 4, 5}，则 R ∪ S 的结果将包含元组 {1, 2, 3, 4, 5}。</span></p></li></ul></li><li><p><span>差（Difference）：</span></p><ul><li><p><span>差运算符用于从一个关系中去除另一个关系中出现的元组。换句话说，它从一个关系中减去与另一个关系相同的元组。</span></p></li><li><p><span>符号表示为 -（减号），即 R - S。</span></p></li><li><p><span>示例：如果关系 R 包含元组 {1, 2, 3, 4}，而关系 S 包含元组 {3, 4, 5}，则 R - S 的结果将包含元组 {1, 2}。</span></p></li></ul></li><li><p><span>交（Intersection）：</span></p><ul><li><p><span>交运算符用于找到两个关系中共同出现的元组，即两个关系的交集。</span></p></li><li><p><span>符号表示为 ∩（交集符号），即 R ∩ S。</span></p></li><li><p><span>示例：如果关系 R 包含元组 {1, 2, 3, 4}，而关系 S 包含元组 {3, 4, 5}，则 R ∩ S 的结果将包含元组 {3, 4}。</span></p></li></ul></li><li><p><span>笛卡尔积（Cartesian Product）：</span></p><ul><li><p><span>笛卡尔积运算符将两个关系的每个元组都配对，生成一个新的关系。结果中的每个元组由两个关系中的一个元组组成，它们的组合方式是从第一个关系中的每个元组和第二个关系中的每个元组中选择一个。</span></p></li><li><p><span>R: n目关系，k1个元组</span>
<span>S: m目关系，k2个元组</span></p></li><li><p><span>列：（n+m）列元组的集合</span></p><ul><li><p><span>元组的前n列是关系R的一个元组</span></p></li><li><p><span>后m列是关系S的一个元组</span></p></li></ul></li><li><p><span>行：k1×k2个元组</span></p></li><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="50.358ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 22258.4 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-4-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path id="MJX-4-TEX-I-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-4-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-4-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-4-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-4-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-4-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-4-TEX-N-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path id="MJX-4-TEX-N-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJX-4-TEX-N-2227" d="M318 591Q325 598 333 598Q344 598 348 591Q349 590 414 445T545 151T611 -4Q609 -22 591 -22Q588 -22 586 -21T581 -20T577 -17T575 -13T572 -9T570 -4L333 528L96 -4Q87 -20 80 -21Q78 -22 75 -22Q57 -22 55 -4Q55 2 120 150T251 444T318 591Z"></path><path id="MJX-4-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-4-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D445" xlink:href="#MJX-4-TEX-I-1D445"></use></g><g data-mml-node="mi" transform="translate(759,0)"><use data-c="D7" xlink:href="#MJX-4-TEX-I-D7"></use></g><g data-mml-node="mi" transform="translate(1537,0)"><use data-c="1D446" xlink:href="#MJX-4-TEX-I-1D446"></use></g><g data-mml-node="mo" transform="translate(2459.8,0)"><use data-c="3D" xlink:href="#MJX-4-TEX-N-3D"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3515.6,0)"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D45F" xlink:href="#MJX-4-TEX-I-1D45F"></use></g></g><g data-mml-node="msub" transform="translate(762.9,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-4-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(1538.5,0) translate(0 -0.5)"><use data-c="7C" xlink:href="#MJX-4-TEX-N-7C"></use></g><g data-mml-node="msub" transform="translate(1816.5,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D45F" xlink:href="#MJX-4-TEX-I-1D45F"></use></g></g><g data-mml-node="mo" transform="translate(2857.2,0)"><use data-c="2208" xlink:href="#MJX-4-TEX-N-2208"></use></g><g data-mml-node="mi" transform="translate(3802,0)"><use data-c="1D445" xlink:href="#MJX-4-TEX-I-1D445"></use></g><g data-mml-node="mo" transform="translate(4783.2,0)"><use data-c="2227" xlink:href="#MJX-4-TEX-N-2227"></use></g><g data-mml-node="msub" transform="translate(5672.4,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-4-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(6725.9,0)"><use data-c="2208" xlink:href="#MJX-4-TEX-N-2208"></use></g><g data-mml-node="mi" transform="translate(7670.6,0)"><use data-c="1D446" xlink:href="#MJX-4-TEX-I-1D446"></use></g></g><g data-mml-node="mo" transform="translate(12109,0)"><use data-c="3D" xlink:href="#MJX-4-TEX-N-3D"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(13164.7,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-4-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D45F" xlink:href="#MJX-4-TEX-I-1D45F"></use></g></g><g data-mml-node="msub" transform="translate(1151.9,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-4-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(1927.5,0)"><use data-c="29" xlink:href="#MJX-4-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(2316.5,0) translate(0 -0.5)"><use data-c="7C" xlink:href="#MJX-4-TEX-N-7C"></use></g><g data-mml-node="msub" transform="translate(2594.5,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D45F" xlink:href="#MJX-4-TEX-I-1D45F"></use></g></g><g data-mml-node="mo" transform="translate(3635.2,0)"><use data-c="2208" xlink:href="#MJX-4-TEX-N-2208"></use></g><g data-mml-node="mi" transform="translate(4580,0)"><use data-c="1D445" xlink:href="#MJX-4-TEX-I-1D445"></use></g><g data-mml-node="mo" transform="translate(5561.2,0)"><use data-c="2227" xlink:href="#MJX-4-TEX-N-2227"></use></g><g data-mml-node="msub" transform="translate(6450.4,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-4-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-4-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(7503.9,0)"><use data-c="2208" xlink:href="#MJX-4-TEX-N-2208"></use></g><g data-mml-node="mi" transform="translate(8448.6,0)"><use data-c="1D446" xlink:href="#MJX-4-TEX-I-1D446"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mi>×</mi><mi>S</mi><mo>=</mo><mrow data-mjx-texclass="ORD"><msub><mi>t</mi><mi>r</mi></msub><msub><mi>t</mi><mi>s</mi></msub><mo stretchy="false">|</mo><msub><mi>t</mi><mi>r</mi></msub><mo>∈</mo><mi>R</mi><mo>∧</mo><msub><mi>t</mi><mi>s</mi></msub><mo>∈</mo><mi>S</mi></mrow><mo>=</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><msub><mi>t</mi><mi>r</mi></msub><msub><mi>t</mi><mi>s</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">|</mo><msub><mi>t</mi><mi>r</mi></msub><mo>∈</mo><mi>R</mi><mo>∧</mo><msub><mi>t</mi><mi>s</mi></msub><mo>∈</mo><mi>S</mi></mrow></math></mjx-assistive-mml></mjx-container><script type="math/tex">R×S={t_r t_s |t_r∈R∧t_s∈S}={(t_r t_s )|t_r∈R∧t_s∈S}</script></p></li><li><p><span>作用：将两个关系无条件的连接成一个新关系，可用于两关系的连接操作。</span></p></li></ul></li></ol><p><span>这四种传统的集合运算是关系代数中的基础操作，可以通过它们的组合来实现更复杂的查询和操作。在关系型数据库中，这些运算符常常被用于编写查询语句以获取所需的数据。</span></p><p>&nbsp;</p><p><span>一个笛卡尔积的例子：</span></p><p><img src="数据库系统概论/image-20240503163945673.png" alt="image-20240503163945673" style="zoom:50%;" /></p><p>&nbsp;</p><h3 id='专门的关系运算'><span>专门的关系运算</span></h3><h4 id='几个记号'><span>几个记号</span></h4><h4 id='选择selection）'><span>选择（Selection）</span></h4><p><span>选择运算是从一个关系中选出满足特定条件的元组（行）。这可以通过使用一个或多个条件表达式来实现，这些表达式涉及到关系中的属性值。</span></p><p>&nbsp;</p><p><span>选择运算的符号表示通常是一个希腊字母“σ”（sigma）。</span></p><p>&nbsp;</p><h4 id='投影projection）'><span>投影（Projection）</span></h4><p><span>投影运算是从一个关系中选出特定的属性（列）集合，并丢弃其他属性。结果是一个新的关系，其中包含原关系中所有满足条件的元组，但只包含选中的属性。</span></p><p>&nbsp;</p><p><span>投影运算的符号表示通常是一个希腊字母“π”（pi）。</span></p><p>&nbsp;</p><h4 id='连接join）'><span>连接（Join）</span></h4><p><span>连接运算是将两个关系在指定的属性上合并，形成一个新的关系。连接运算有多种类型，包括内连接（INNER JOIN）、外连接（LEFT/RIGHT/FULL OUTER JOIN）和自然连接。</span></p><p><span>内连接只选出在两个关系中都有匹配的元组，而外连接则允许在一个关系中没有匹配的元组出现在结果中。</span></p><p>&nbsp;</p><h5 id='左连接'><span>左连接</span></h5><h5 id='右连接'><span>右连接</span></h5><h5 id='外连接'><span>外连接</span></h5><h4 id='除division）'><span>除（Division）</span></h4><h4 id='综合举例'><span>综合举例</span></h4><p>&nbsp;</p><h1 id='简单sql'><span>简单SQL</span></h1><p>&nbsp;</p><p><span>分组查询的SELECT目标列中只允许出现聚集函数和GROUP BY子句中出现过的列。</span></p><p><span>这句话是在描述SQL语言中分组查询（GROUP BY）的使用规则。在SQL中，当你使用GROUP BY子句对数据进行分组时，你只能在SELECT语句中选择那些在GROUP BY子句中出现过的列，或者是使用聚集函数（如COUNT、SUM、AVG、MAX、MIN等）进行计算的列。这是因为在分组查询中，每个分组只能返回一个值，所以非聚集函数的列必须有在GROUP BY中定义的唯一值。</span></p><p><span>让我们通过一个例子来解释这个规则：</span></p><p><span>假设我们有一个销售数据的表格，包含以下列：日期（Date）、商品ID（ProductID）、销售额（SalesAmount）。</span>
<span>如果我们想要查询每个商品ID的总销售额，我们可能会写一个如下的SQL查询：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> ProductID<span class="cm-punctuation">,</span> <span class="cm-keyword">SUM</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> SalesTable</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GROUP</span> <span class="cm-keyword">BY</span> ProductID<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>在这个查询中，我们使用了GROUP BY子句按商品ID对数据进行分组，并且在SELECT语句中选择了ProductID列和SUM(SalesAmount)聚集函数。这个查询是有效的，因为它遵循了上述规则：SELECT中的ProductID是在GROUP BY子句中出现过的列，而SUM(SalesAmount)是一个聚集函数。</span></p><p><span>然而，如果我们尝试在SELECT语句中选择一个不在GROUP BY子句中的列，比如日期（Date），那么就会违反规则：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> ProductID<span class="cm-punctuation">,</span> <span class="cm-type">Date</span><span class="cm-punctuation">,</span> <span class="cm-keyword">SUM</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> SalesTable</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GROUP</span> <span class="cm-keyword">BY</span> ProductID<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>这个查询是错误的，因为对于每个ProductID，可能会有多个不同的日期，所以在分组查询中不能直接选择日期列，除非我们对日期也进行了分组。如果我们想要包含日期信息，我们需要在GROUP BY子句中也包含日期：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> ProductID<span class="cm-punctuation">,</span> <span class="cm-type">Date</span><span class="cm-punctuation">,</span> <span class="cm-keyword">SUM</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> SalesTable</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GROUP</span> <span class="cm-keyword">BY</span> ProductID<span class="cm-punctuation">,</span> <span class="cm-type">Date</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>这样，每个ProductID和Date的组合都会有一个唯一的分组，查询就是有效的。</span></p><p>&nbsp;</p><p><span>聚集函数对于NULL是如何处理的？</span></p><p><span>聚集函数在处理NULL值时通常会忽略这些值。以下是几个常用聚集函数对NULL的处理方式：</span></p><ol start='' ><li><p><code>COUNT(*)</code><span>：计算所有行的数量，包括那些包含NULL值的行。</span></p></li><li><p><code>COUNT(列名)</code><span>：计算指定列的非NULL值的数量。</span></p></li><li><p><code>SUM(列名)</code><span>：只计算指定列的非NULL值的和，NULL值会被忽略。</span></p></li><li><p><code>AVG(列名)</code><span>：计算指定列的非NULL值的平均值，NULL值会被忽略。</span></p></li><li><p><code>MIN(列名)</code><span>：返回指定列的最小非NULL值。</span></p></li><li><p><code>MAX(列名)</code><span>：返回指定列的最大非NULL值。</span></p></li></ol><p><span>例如，假设我们有一个包含销售额的列，其中有些行的销售额是NULL：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">COUNT</span><span class="cm-bracket">(</span><span class="cm-operator">*</span><span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">-- 计算所有行的数量</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">COUNT</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> <span class="cm-comment">-- 计算非NULL销售额的数量</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">SUM</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> &nbsp; <span class="cm-comment">-- 计算非NULL销售额的总和</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">AVG</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> &nbsp; <span class="cm-comment">-- 计算非NULL销售额的平均值</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">MIN</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> &nbsp; <span class="cm-comment">-- 返回最小的非NULL销售额</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">MAX</span><span class="cm-bracket">(</span>SalesAmount<span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> sales<span class="cm-punctuation">;</span> &nbsp; <span class="cm-comment">-- 返回最大的非NULL销售额</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>在这些例子中，只有</span><code>COUNT(*)</code><span>会考虑NULL值，其他聚集函数都会忽略NULL值。这是SQL标准的行为，但是不同的数据库管理系统可能会有额外的选项或函数来处理NULL值，例如SQL Server提供了</span><code>COUNT(NULLIF(列名, NULL))</code><span>来计数特定列中非NULL值的数量。</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span>AVG(列名)：计算指定列的非NULL值的平均值，NULL值会被忽略。</span></p><p><span>那么如果有三个元组，其中有一个为NULL，那么它就会被忽略，但是AVG是求平均值，那么是三个的平均值呢？还是两个的平均值呢？</span></p><p><span>如果有一个包含三个元组的列，其中一个元组的值为NULL，那么在计算平均值时，NULL值会被忽略，只计算非NULL值的平均值。因此，AVG函数会计算剩余两个非NULL值的平均值。</span>
<span>例如，假设我们有以下三个元组：</span></p><ol start='' ><li><p><span>10</span></p></li><li><p><span>20</span></p></li><li><p><span>NULL</span></p></li></ol><p><span>AVG函数会忽略NULL值，只计算10和20的平均值，结果是15。</span></p><p><span>数学上，平均值是通过将所有非NULL值相加，然后除以非NULL值的数量来计算的。在这个例子中，非NULL值的总和是10 + 20 = 30，非NULL值的数量是2，所以平均值是30 / 2 = 15。</span></p><p>&nbsp;</p><p><span>例3.63：查询至少选修了学生201215122选修的全部课程的学生号码。</span></p><p><span>解题思路：</span></p><ul><li><p><span>用逻辑蕴涵表达：查询学号为x的学生，对所有的课程y只要201215122学生选修了课程y，则x也选修了y。</span></p></li><li><p><span>形式化表示：</span></p><ul><li><p><span>用P表示谓词“学生201215122选修了课程y”</span></p></li><li><p><span>用q表示谓词“学生x选修了课程y”</span></p></li><li><p><span>则上述查询为：（∀y）p→q</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>等价变换：</span></p><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="30.587ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 13519.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-5-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-5-TEX-N-2200" d="M0 673Q0 684 7 689T20 694Q32 694 38 680T82 567L126 451H430L473 566Q483 593 494 622T512 668T519 685Q524 694 538 694Q556 692 556 674Q556 670 426 329T293 -15Q288 -22 278 -22T263 -15Q260 -11 131 328T0 673ZM414 410Q414 411 278 411T142 410L278 55L414 410Z"></path><path id="MJX-5-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-5-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-5-TEX-N-A0" d=""></path><path id="MJX-5-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-5-TEX-N-2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path><path id="MJX-5-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-5-TEX-N-2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path><path id="MJX-5-TEX-N-AC" d="M56 323T56 336T70 356H596Q603 353 611 343V102Q598 89 591 89Q587 89 584 90T579 94T575 98T572 102L571 209V316H70Q56 323 56 336Z"></path><path id="MJX-5-TEX-N-2203" d="M56 661T56 674T70 694H487Q497 686 500 679V15Q497 10 487 1L279 0H70Q56 7 56 20T70 40H460V327H84Q70 334 70 347T84 367H460V654H70Q56 661 56 674Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-5-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(389,0)"><use data-c="2200" xlink:href="#MJX-5-TEX-N-2200"></use></g><g data-mml-node="mi" transform="translate(945,0)"><use data-c="1D466" xlink:href="#MJX-5-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(1435,0)"><use data-c="29" xlink:href="#MJX-5-TEX-N-29"></use></g><g data-mml-node="mtext" transform="translate(1824,0)"><use data-c="A0" xlink:href="#MJX-5-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(2074,0)"><use data-c="1D45D" xlink:href="#MJX-5-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(2854.8,0)"><use data-c="2192" xlink:href="#MJX-5-TEX-N-2192"></use></g><g data-mml-node="mi" transform="translate(4132.6,0)"><use data-c="1D45E" xlink:href="#MJX-5-TEX-I-1D45E"></use></g><g data-mml-node="mtext" transform="translate(4592.6,0)"><use data-c="A0" xlink:href="#MJX-5-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(5120.3,0)"><use data-c="2261" xlink:href="#MJX-5-TEX-N-2261"></use></g><g data-mml-node="mtext" transform="translate(6176.1,0)"><use data-c="A0" xlink:href="#MJX-5-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(6426.1,0)"><use data-c="AC" xlink:href="#MJX-5-TEX-N-AC"></use></g><g data-mml-node="mi" transform="translate(7093.1,0)"><use data-c="2203" xlink:href="#MJX-5-TEX-N-2203"></use></g><g data-mml-node="mi" transform="translate(7649.1,0)"><use data-c="1D466" xlink:href="#MJX-5-TEX-I-1D466"></use></g><g data-mml-node="mtext" transform="translate(8139.1,0)"><use data-c="A0" xlink:href="#MJX-5-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(8389.1,0)"><use data-c="28" xlink:href="#MJX-5-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(8778.1,0)"><use data-c="AC" xlink:href="#MJX-5-TEX-N-AC"></use></g><g data-mml-node="mo" transform="translate(9445.1,0)"><use data-c="28" xlink:href="#MJX-5-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(9834.1,0)"><use data-c="1D45D" xlink:href="#MJX-5-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(10614.9,0)"><use data-c="2192" xlink:href="#MJX-5-TEX-N-2192"></use></g><g data-mml-node="mi" transform="translate(11892.7,0)"><use data-c="1D45E" xlink:href="#MJX-5-TEX-I-1D45E"></use></g><g data-mml-node="mo" transform="translate(12352.7,0)"><use data-c="29" xlink:href="#MJX-5-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(12741.7,0)"><use data-c="29" xlink:href="#MJX-5-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(13130.7,0)"><use data-c="29" xlink:href="#MJX-5-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi mathvariant="normal">∀</mi><mi>y</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>p</mi><mo accent="false" stretchy="false">→</mo><mi>q</mi><mtext>&nbsp;</mtext><mo>≡</mo><mtext>&nbsp;</mtext><mi mathvariant="normal">¬</mi><mi mathvariant="normal">∃</mi><mi>y</mi><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi>p</mi><mo accent="false" stretchy="false">→</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">(\forall y)\ p\to q\ \equiv\ \neg\exists y\ (\neg(p\to q)))</script><span>​  </span></p><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="21.564ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 9531.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-6-TEX-N-2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path><path id="MJX-6-TEX-N-A0" d=""></path><path id="MJX-6-TEX-N-AC" d="M56 323T56 336T70 356H596Q603 353 611 343V102Q598 89 591 89Q587 89 584 90T579 94T575 98T572 102L571 209V316H70Q56 323 56 336Z"></path><path id="MJX-6-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-6-TEX-N-2203" d="M56 661T56 674T70 694H487Q497 686 500 679V15Q497 10 487 1L279 0H70Q56 7 56 20T70 40H460V327H84Q70 334 70 347T84 367H460V654H70Q56 661 56 674Z"></path><path id="MJX-6-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-6-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-6-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-6-TEX-N-222A" d="M591 598H592Q604 598 611 583V376Q611 345 611 296Q610 162 606 148Q605 146 605 145Q586 68 507 23T333 -22Q268 -22 209 -1T106 66T56 173Q55 180 55 384L56 585Q66 598 75 598Q85 598 95 585V378L96 172L98 162Q112 95 181 57T332 18Q415 18 487 58T570 175Q571 180 571 383V583Q579 598 591 598Z"></path><path id="MJX-6-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-6-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="2261" xlink:href="#MJX-6-TEX-N-2261"></use></g><g data-mml-node="mtext" transform="translate(1055.8,0)"><use data-c="A0" xlink:href="#MJX-6-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(1305.8,0)"><use data-c="AC" xlink:href="#MJX-6-TEX-N-AC"></use></g><g data-mml-node="mo" transform="translate(1972.8,0)"><use data-c="28" xlink:href="#MJX-6-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(2361.8,0)"><use data-c="2203" xlink:href="#MJX-6-TEX-N-2203"></use></g><g data-mml-node="mi" transform="translate(2917.8,0)"><use data-c="1D466" xlink:href="#MJX-6-TEX-I-1D466"></use></g><g data-mml-node="mtext" transform="translate(3407.8,0)"><use data-c="A0" xlink:href="#MJX-6-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(3657.8,0)"><use data-c="28" xlink:href="#MJX-6-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(4046.8,0)"><use data-c="AC" xlink:href="#MJX-6-TEX-N-AC"></use></g><g data-mml-node="mo" transform="translate(4713.8,0)"><use data-c="28" xlink:href="#MJX-6-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(5102.8,0)"><use data-c="AC" xlink:href="#MJX-6-TEX-N-AC"></use></g><g data-mml-node="mi" transform="translate(5769.8,0)"><use data-c="1D45D" xlink:href="#MJX-6-TEX-I-1D45D"></use></g><g data-mml-node="mi" transform="translate(6272.8,0)"><use data-c="1D451" xlink:href="#MJX-6-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(7015,0)"><use data-c="222A" xlink:href="#MJX-6-TEX-N-222A"></use></g><g data-mml-node="mi" transform="translate(7904.2,0)"><use data-c="1D45E" xlink:href="#MJX-6-TEX-I-1D45E"></use></g><g data-mml-node="mo" transform="translate(8364.2,0)"><use data-c="29" xlink:href="#MJX-6-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(8753.2,0)"><use data-c="29" xlink:href="#MJX-6-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(9142.2,0)"><use data-c="29" xlink:href="#MJX-6-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≡</mo><mtext>&nbsp;</mtext><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∃</mi><mi>y</mi><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mi>p</mi><mi>d</mi><mo>∪</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">\equiv\ \neg(\exists y\ (\neg (\neg p d∪ q)))</script></p><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="15.358ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6788.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-7-TEX-N-2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path><path id="MJX-7-TEX-N-A0" d=""></path><path id="MJX-7-TEX-N-AC" d="M56 323T56 336T70 356H596Q603 353 611 343V102Q598 89 591 89Q587 89 584 90T579 94T575 98T572 102L571 209V316H70Q56 323 56 336Z"></path><path id="MJX-7-TEX-N-2203" d="M56 661T56 674T70 694H487Q497 686 500 679V15Q497 10 487 1L279 0H70Q56 7 56 20T70 40H460V327H84Q70 334 70 347T84 367H460V654H70Q56 661 56 674Z"></path><path id="MJX-7-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-7-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-7-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-7-TEX-N-2227" d="M318 591Q325 598 333 598Q344 598 348 591Q349 590 414 445T545 151T611 -4Q609 -22 591 -22Q588 -22 586 -21T581 -20T577 -17T575 -13T572 -9T570 -4L333 528L96 -4Q87 -20 80 -21Q78 -22 75 -22Q57 -22 55 -4Q55 2 120 150T251 444T318 591Z"></path><path id="MJX-7-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-7-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="2261" xlink:href="#MJX-7-TEX-N-2261"></use></g><g data-mml-node="mtext" transform="translate(1055.8,0)"><use data-c="A0" xlink:href="#MJX-7-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(1305.8,0)"><use data-c="AC" xlink:href="#MJX-7-TEX-N-AC"></use></g><g data-mml-node="mi" transform="translate(1972.8,0)"><use data-c="2203" xlink:href="#MJX-7-TEX-N-2203"></use></g><g data-mml-node="mi" transform="translate(2528.8,0)"><use data-c="1D466" xlink:href="#MJX-7-TEX-I-1D466"></use></g><g data-mml-node="mtext" transform="translate(3018.8,0)"><use data-c="A0" xlink:href="#MJX-7-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(3268.8,0)"><use data-c="28" xlink:href="#MJX-7-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(3657.8,0)"><use data-c="1D45D" xlink:href="#MJX-7-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(4383,0)"><use data-c="2227" xlink:href="#MJX-7-TEX-N-2227"></use></g><g data-mml-node="mi" transform="translate(5272.2,0)"><use data-c="AC" xlink:href="#MJX-7-TEX-N-AC"></use></g><g data-mml-node="mi" transform="translate(5939.2,0)"><use data-c="1D45E" xlink:href="#MJX-7-TEX-I-1D45E"></use></g><g data-mml-node="mo" transform="translate(6399.2,0)"><use data-c="29" xlink:href="#MJX-7-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≡</mo><mtext>&nbsp;</mtext><mi mathvariant="normal">¬</mi><mi mathvariant="normal">∃</mi><mi>y</mi><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><mi>p</mi><mo>∧</mo><mi mathvariant="normal">¬</mi><mi>q</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">\equiv\ \neg\exists y\ (p\wedge \neg q)</script><span>​</span></p><p><span>变换后语义：不存在这样的课程y，学生201215122选修了y，而学生x没有选。</span></p><p><span>用NOT EXISTS谓词表示:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">DISTINCT</span> Sno</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> SC SCX</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> <span class="cm-keyword">NOT</span> <span class="cm-keyword">EXISTS</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FROM</span> SC SCY</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">WHERE</span> SCY<span class="cm-variable-2">.Sno</span> <span class="cm-operator">=</span> <span class="cm-string">'201215122'</span> <span class="cm-keyword">AND</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">NOT</span> <span class="cm-keyword">EXISTS</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FROM</span> SC SCZ</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">WHERE</span> SCZ<span class="cm-variable-2">.Sno</span><span class="cm-operator">=</span>SCX<span class="cm-variable-2">.Sno</span> <span class="cm-keyword">AND</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>SCZ<span class="cm-variable-2">.Cno</span><span class="cm-operator">=</span>SCY<span class="cm-variable-2">.Cno</span><span class="cm-bracket">)))</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="height: 253px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p><span>参考如下理解方式：</span></p><p><img src="数据库系统概论/image-20240515105849545.png" referrerpolicy="no-referrer" alt="image-20240515105849545"></p><p>&nbsp;</p><blockquote><p><span>【深刻理解数据库SQL语言中的exists和not exists语句】 </span><a href='https://www.bilibili.com/video/BV1vu4m1M7Vm/?share_source=copy_web&amp;vd_source=8fa0ddfc571cb8e214b881be981477a4' target='_blank' class='url'>https://www.bilibili.com/video/BV1vu4m1M7Vm/?share_source=copy_web&vd_source=8fa0ddfc571cb8e214b881be981477a4</a></p></blockquote><p>&nbsp;</p><p><span>在数据库中，什么时候删除用DELETE，什么时候用DROP？</span></p><p><span>在数据库中，</span><code>DELETE</code><span> 和 </span><code>DROP</code><span> 是两个不同的操作，它们用于不同的目的：</span></p><ol start='' ><li><p><code>DELETE</code><span>：</span></p><ul><li><p><code>DELETE</code><span> 语句用于从表中删除行。</span></p></li><li><p><span>它通常用于删除符合特定条件的数据，也可以删除表中的所有行，但表结构本身仍然存在。</span></p></li><li><p><span>语法示例：</span><code>DELETE FROM table_name WHERE condition;</code></p></li></ul></li><li><p><code>DROP</code><span>：</span></p><ul><li><p><code>DROP</code><span> 语句用于删除整个数据库结构，如表、视图或索引。</span></p></li><li><p><span>当你不再需要某个表或数据库结构，并且想要彻底删除它时，你会使用 </span><code>DROP</code><span>。</span></p></li><li><p><span>语法示例：</span><code>DROP TABLE table_name;</code><span> 或 </span><code>DROP DATABASE database_name;</code></p></li></ul></li></ol><p><span>简而言之，如果你只想删除表中的数据行，请使用 </span><code>DELETE</code><span>。如果你想要删除整个表或数据库结构，请使用 </span><code>DROP</code><span>。</span></p><p>&nbsp;</p><h1 id='数据库安全性'><span>数据库安全性</span></h1><p><span>问题的提出</span></p><ul><li><p><span>数据库的一大特点是数据可以共享</span></p></li><li><p><span>数据共享必然带来数据库的安全性问题</span></p></li><li><p><span>数据库系统中的数据共享不能是无条件的共享</span></p></li></ul><p><span>例子：军事秘密、国家机密、新产品实验数据、市场需求分析、市场营销策略、销售计划、客户档案、医疗档案、银行储蓄数据</span></p><p>&nbsp;</p><p><span>数据库的安全性是指保护数据库以防止不合法使用所造成的数据泄露、更改或破坏 。</span></p><p><span>系统安全保护措施是否有效是数据库系统主要的性能指标之一。</span></p><p>&nbsp;</p><p><span>实现数据库系统安全性的技术和方法:</span></p><ul><li><p><span>用户身份认证</span></p></li><li><p><span>访问控制技术：自主访问控制和强制访问控制</span></p></li><li><p><span>视图技术</span></p></li><li><p><span>审计技术</span></p></li><li><p><span>数据加密存储和加密传输</span></p></li></ul><p>&nbsp;</p><h2 id='数据库安全性概述'><span>数据库安全性概述</span></h2><h3 id='数据库的不安全因素'><span>数据库的不安全因素</span></h3><p><span>非授权用户对数据库的恶意存取和破坏</span></p><ul><li><p><span>一些黑客（Hacker）和犯罪分子在用户存取数据库时猎取用户名和用户口令，然后假冒合法用户偷取、修改甚至破坏用户数据。</span></p></li><li><p><span>数据库管理系统提供的安全措施主要包括用户身份认证、访问控制和视图等技术。</span></p></li></ul><p><span>数据库中重要或敏感的数据被泄露</span></p><ul><li><p><span>黑客和敌对分子千方百计盗窃数据库中的重要数据，一些机密信息被暴露。</span></p></li><li><p><span>数据库管理系统提供的主要技术有强制访问控制、数据加密存储和传输加密等。</span></p></li><li><p><span>审计：分析审计日志</span></p></li></ul><p><span>安全环境的脆弱性</span></p><ul><li><p><span>数据库的安全性与计算机系统的安全性紧密联系（计算机硬件、操作系统、网络系统等的安全性）</span></p></li><li><p><span>建立一套可信（Trusted）计算机系统的概念和标准</span></p></li></ul><p>&nbsp;</p><h3 id='安全标准简介'><span>安全标准简介</span></h3><p><span>1985年美国国防部（DoD）正式颁布《DoD可信计算机系统评估准则》（简称TCSEC或DoD85）。不同国家在TCSEC概念上建立自己的评估准则。</span></p><ul><li><p><span>欧洲的信息技术安全评估准则（ITSEC）</span></p></li><li><p><span>加拿大的可信计算机产品评估准则（CTCPEC）</span></p></li><li><p><span>美国的信息技术安全联邦标准（FC）</span></p></li></ul><p>&nbsp;</p><p><span>1993年，CTCPEC、FC、TCSEC和ITSEC联合行动，解决原标准中概念和技术上的差异，称为CC（Common Criteria通用准则）项目。</span></p><p><span>1999年 CC V2.1版被ISO采用为国际标准，2001年 CC V2.1版被我国采用为国家标准。</span></p><p><span>目前CC已基本取代了TCSEC，成为评估信息产品安全性的主要标准。</span></p><p><span>1991年4月美国NCSC（国家计算机安全中心）颁布了《可信计算机系统评估标准关于可信数据库系统的解释》（ Trusted Database Interpretation 简称TDI）</span></p><ul><li><p><span>TDI又称紫皮书。它将TCSEC扩展到数据库管理系统</span></p></li><li><p><span>TDI中定义了数据库管理系统的设计与实现中需满足和用以进行安全性级别评估的标准</span></p></li></ul><p>&nbsp;</p><h4 id='tcsectdi标准的基本内容'><span>TCSEC/TDI标准的基本内容</span></h4><p><span>TCSEC/TDI，从四个方面来描述安全性级别划分的指标：</span></p><ul><li><p><span>安全策略</span></p></li><li><p><span>责任</span></p></li><li><p><span>保证</span></p></li><li><p><span>文档</span></p></li></ul><p>&nbsp;</p><h4 id='tcsectdi安全级别划分'><span>TCSEC/TDI安全级别划分</span></h4><figure class='table-figure'><table><thead><tr><th><span>安全级别</span></th><th><span>定 义</span></th></tr></thead><tbody><tr><td><span>A1</span></td><td><span>验证设计（Verified Design）</span></td></tr><tr><td><span>B3</span></td><td><span>安全域（Security Domains）</span></td></tr><tr><td><span>B2</span></td><td><span>结构化保护（Structural Protection）</span></td></tr><tr><td><span>B1</span></td><td><span>标记安全保护（Labeled Security Protection)</span></td></tr><tr><td><span>C2</span></td><td><span>受控的访问保护（Controlled Access Protection)</span></td></tr><tr><td><span>C1</span></td><td><span>自主安全保护（Discretionary Security Protection)</span></td></tr><tr><td><span>D</span></td><td><span>最小保护（Minimal Protection）</span></td></tr></tbody></table></figure><p><span>四组（division）七个等级：</span></p><ul><li><p><span>D</span></p></li><li><p><span>C（C1，C2）</span></p></li><li><p><span>B（B1，B2，B3）</span></p></li><li><p><span>A（A1）</span></p></li></ul><p><span>按系统可靠或可信程度逐渐增高。</span></p><p><span>各安全级别之间具有一种偏序向下兼容的关系，即较高安全性级别提供的安全保护要包含较低级别的所有保护要求，同时提供更多或更完善的保护能力</span></p><p>&nbsp;</p><h5 id='d'><span>D</span></h5><p><span>将一切不符合更高标准的系统均归于D组</span></p><p><span>典型例子：DOS是安全标准为D的操作系统（DOS在安全性方面几乎没有什么专门的机制来保障）</span></p><p>&nbsp;</p><h5 id='c1'><span>C1</span></h5><p><span>非常初级的自主安全保护</span></p><p><span>能够实现对用户和数据的分离，进行自主访问控制（DAC），保护或限制用户权限的传播。</span></p><p><span>现有的商业系统稍作改进即可满足</span></p><p>&nbsp;</p><h5 id='c2'><span>C2</span></h5><p><span>安全产品的最低档次</span></p><p><span>提供受控的访问保护，将C1级的DAC进一步细化，以个人身份注册，并实施审计和资源隔离</span></p><p><span>达到C2级的产品在其名称中往往不突出“安全”（Security）这一特色</span></p><p><span>典型例子：</span></p><ul><li><p><span>Windows 2000</span></p></li><li><p><span>Oracle 7</span></p></li></ul><p>&nbsp;</p><h5 id='b1'><span>B1</span></h5><p><span>标记安全保护。“安全”（Security）或“可信的”（Trusted）产品</span></p><p><span>对系统的数据加以标记，对标记的主体(用户，进程)和客体(表，视图，索引…)实施强制访问控制（MAC）、审计等安全机制</span></p><p><span>B1级典型例子：</span></p><ul><li><p><span>操作系统：惠普公司的HP-UX BLS release 9.09+</span></p></li><li><p><span>数据库：</span></p><ul><li><p><span>Oracle公司的Trusted Oracle 7</span></p></li><li><p><span>Sybase公司的Secure SQL Server version 11.0.6</span></p></li></ul></li></ul><p>&nbsp;</p><h5 id='b2'><span>B2</span></h5><p><span>结构化保护</span></p><p><span>建立形式化的安全策略模型并对系统内的所有主体和客体实施DAC和MAC</span></p><p>&nbsp;</p><h5 id='b3'><span>B3</span></h5><p><span>安全域</span></p><p><span>该级的TCB必须满足访问监控器( 监控主体和客体之间授权访问关系的部件)的要求，审计跟踪能力更强，并提供系统恢复过程</span></p><p>&nbsp;</p><h5 id='a1'><span>A1</span></h5><p><span>验证设计，即提供B3级保护的同时给出系统的形式化设计说明和验证以确信各安全保护真正实现</span></p><p>&nbsp;</p><h4 id='cc'><span>CC</span></h4><p><span>提出国际公认的表述信息技术安全性的结构</span></p><p><span>把信息产品的安全要求分为:</span></p><ul><li><p><span>安全功能要求</span></p></li><li><p><span>安全保证要求</span></p></li></ul><p>&nbsp;</p><p><span>CC文本组成</span></p><ul><li><p><span>简介和一般模型</span></p><ul><li><p><span>有关术语、基本概念和一般模型以及与评估有关的一些框架</span></p></li></ul></li><li><p><span>安全功能要求</span></p><ul><li><p><span>列出了一系列类、子类和组件</span></p></li></ul></li><li><p><span>安全保证要求</span></p><ul><li><p><span>列出了一系列保证类、子类和组件</span></p></li><li><p><span>提出了评估保证级（Evaluation Assurance Level，EAL），从EAL1至EAL7共分为七级</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>CC评估保证级（EAL）划分</span></p><figure class='table-figure'><table><thead><tr><th><span>评估保证级</span></th><th style='text-align:left;' ><span>定 义</span></th><th><span>TCSEG安全级别(近似相当)</span></th></tr></thead><tbody><tr><td><span>EAL1</span></td><td style='text-align:left;' ><span>功能测试(functionally tested)</span></td><td><span>C1</span></td></tr><tr><td><span>EAL2</span></td><td style='text-align:left;' ><span>结构测试(structurally tested)</span></td><td><span>C1</span></td></tr><tr><td><span>EAL3</span></td><td style='text-align:left;' ><span>系统地测试和检查(methodically tested and checked)</span></td><td><span>C2</span></td></tr><tr><td><span>EAL4</span></td><td style='text-align:left;' ><span>系统地设计、测试和复查(methodically designed,tested,and reviewed)</span></td><td><span>B1</span></td></tr><tr><td><span>EAL5</span></td><td style='text-align:left;' ><span>半形式化设计和测试(semiformally designed and tested)</span></td><td><span>B2</span></td></tr><tr><td><span>EAL6</span></td><td style='text-align:left;' ><span>半形式化验证的设计和测试(semiformally verified design and tested)</span></td><td><span>B3</span></td></tr><tr><td><span>EAL7</span></td><td style='text-align:left;' ><span>形式化验证的设计和测试(formally verified design and tested)</span></td><td><span>A1</span></td></tr></tbody></table></figure><p>&nbsp;</p><h2 id='数据库安全性控制'><span>数据库安全性控制</span></h2><p><span>非法使用数据库的情况:</span></p><ul><li><p><span>编写合法程序绕过数据库管理系统及其授权机制</span></p></li><li><p><span>直接或编写应用程序执行非授权操作</span></p></li><li><p><span>通过多次合法查询数据库从中推导出一些保密数据</span></p></li></ul><p>&nbsp;</p><p><span>计算机系统中，安全措施是一级一级层层设置</span></p><p><span>计算机系统的安全模型如下所示：</span></p><p><img src="数据库系统概论/image-20240415152147531.png" referrerpolicy="no-referrer" alt="image-20240415152147531"></p><p>&nbsp;</p><p><span>系统根据用户标识鉴定用户身份，合法用户才准许进入计算机系统</span></p><p><span>数据库管理系统还要进行访问控制，只允许用户执行合法操作</span></p><p><span>操作系统有自己的保护措施</span></p><p><span>数据以加密形式存储到数据库中</span></p><p><span>数据库管理系统安全性控制模型如下所示：</span></p><p><img src="数据库系统概论/image-20240415152356917.png" referrerpolicy="no-referrer" alt="image-20240415152356917"></p><h3 id='访问控制流程'><span>访问控制流程</span></h3><ol start='' ><li><p><span>首先，数据库管理系统对提出SQL访问请求的数据库用户进行身份认证，防止不可信用户使用系统。</span></p></li><li><p><span>然后，在SQL处理层进行自主访问控制和强制访问控制，进一步可以进行推理控制。</span></p></li><li><p><span>还可以对用户访问行为和系统关键操作进行审计，对异常用户行为进行简单入侵检测。</span></p></li></ol><p>&nbsp;</p><h3 id='数据库安全性控制的常用方法'><span>数据库安全性控制的常用方法</span></h3><ul><li><p><span>用户标识和认证</span></p></li><li><p><span>访问控制</span></p></li><li><p><span>视图</span></p></li><li><p><span>审计</span></p></li><li><p><span>数据加密</span></p></li></ul><p>&nbsp;</p><h4 id='用户标识和认证'><span>用户标识和认证</span></h4><p><span>（Identification &amp; Authentication</span></p><p><span>系统提供的最外层安全保护措施</span></p><p><span>用户标识：由用户名（user name）和用户标识号 UID 组成（用户标识号UID在系统整个生命周期内唯一）</span></p><p>&nbsp;</p><ol start='' ><li><p><span>静态口令认证</span>
<span>●静态口令一般由用户自己设定，这些口令是静态不变的(易破解)</span></p></li><li><p><span>动态口令认证</span>
<span>●口令是动态变化的，每次认证时均需使用动态产生的新口令登录数据库管理系统，即采用一次一密的方法，短信</span></p></li><li><p><span>生物特征认证</span>
<span>●通过生物特征进行认证的技术，生物特征如指纹、虹膜和掌纹等</span></p></li><li><p><span>智能卡认证</span>
<span>●智能卡是一种不可复制的硬件，内置集成电路的芯片，具有硬件加密功能。PIN+智能卡</span></p></li></ol><p>&nbsp;</p><h4 id='访问控制'><span>访问控制</span></h4><p><span>访问控制机制组成：</span></p><ul><li><p><span>定义用户权限，并将用户权限登记到数据字典中</span></p><ul><li><p><span>用户对某一数据对象的操作权力称为权限</span></p></li><li><p><span>DBMS提供适当的语言来定义用户权限，存放在数据字典中，称做安全规则或授权规则</span></p></li></ul></li><li><p><span>合法权限检查</span></p><ul><li><p><span>用户发出存取数据库操作请求</span></p></li><li><p><span>DBMS查找数据字典，进行合法权限检查</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>用户权限定义和合法权检查机制一起组成了数据库管理系统的访问控制子系统</span></p><p>&nbsp;</p><p><span>常用访问控制方法：</span></p><ul><li><p><span>自主访问控制（Discretionary Access Control ，简称DAC）C2</span></p><ul><li><p><span>用户对不同的数据对象有不同的访问权限</span></p></li><li><p><span>不同的用户对同一对象也有不同的权限</span></p></li><li><p><span>用户还可将其拥有的存取权限转授给其他用户</span></p></li></ul></li><li><p><span>强制访问控制（Mandatory Access Control，简称 MAC）B1</span></p><ul><li><p><span>每一个数据对象被标以一定的密级</span></p></li><li><p><span>每一个用户也被授予某一个级别的许可证</span></p></li><li><p><span>对于任意一个对象，只有具有合法许可证的用户才可以访问</span></p></li></ul></li></ul><p>&nbsp;</p><h4 id='自主访问控制方法'><span>自主访问控制方法</span></h4><p><span>通过 SQL 的 GRANT 语句和 REVOKE 语句实现</span></p><p>&nbsp;</p><p><span>用户权限组成：</span></p><ul><li><p><span>数据对象</span></p></li><li><p><span>操作类型</span></p></li></ul><p>&nbsp;</p><p><span>定义用户访问权限：定义用户可以在哪些数据库对象上进行哪些类型的操作</span></p><p><span>定义访问权限称为授权</span></p><p>&nbsp;</p><p><span>关系数据库系统中访问控制对象：</span></p><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>对象类型</span></th><th style='text-align:left;' ><span>对象</span></th><th style='text-align:left;' ><span>操 作 类 型</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>数据库模式</span></td><td style='text-align:left;' ><span>模式</span></td><td style='text-align:left;' ><span>CREATE SCHEMA</span></td></tr><tr><td style='text-align:left;' ><span>数据库模式</span></td><td style='text-align:left;' ><span>基本表</span></td><td style='text-align:left;' ><span>CREATE TABLE, ALTER TABLE</span></td></tr><tr><td style='text-align:left;' ><span>数据库模式</span></td><td style='text-align:left;' ><span>视图</span></td><td style='text-align:left;' ><span>CREATE VIEW</span></td></tr><tr><td style='text-align:left;' ><span>数据库模式</span></td><td style='text-align:left;' ><span>索引</span></td><td style='text-align:left;' ><span>CREATE INDEX</span></td></tr><tr><td style='text-align:left;' ><span>数据</span></td><td style='text-align:left;' ><span>基本表和视图</span></td><td style='text-align:left;' ><span>SELECT, INSERT, UPDATE, DELETE, REFERENCES, ALL PRIVILEGES</span></td></tr><tr><td style='text-align:left;' ><span>数据</span></td><td style='text-align:left;' ><span>属性列</span></td><td style='text-align:left;' ><span>SELECT, INSERT, UPDATE, REFERENCES, ALL PRIVILEGES</span></td></tr></tbody></table></figure><p>&nbsp;</p><h4 id='授权授予与回收'><span>授权：授予与回收</span></h4><p><span>GRANT，语义：将对指定操作对象的指定操作权限授予指定的用户</span></p><p><span>GRANT语句的一般格式如下：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-operator">&lt;</span>权限1<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> <span class="cm-operator">&lt;</span>权限2<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> ...</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>对象类型1<span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span>对象名1<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> <span class="cm-operator">&lt;</span>对象类型2<span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span>对象名2<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> ...</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> <span class="cm-operator">&lt;</span>用户1<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> <span class="cm-operator">&lt;</span>用户2<span class="cm-operator">&gt;</span><span class="cm-punctuation">,</span> ...</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">[</span><span class="cm-keyword">WITH</span> <span class="cm-keyword">GRANT</span> <span class="cm-keyword">OPTION</span><span class="cm-bracket">]</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>其中：</span></p><ul><li><p><code>&lt;权限&gt;</code><span>：指定要授予用户的权限，例如 </span><code>SELECT</code><span>, </span><code>INSERT</code><span>, </span><code>UPDATE</code><span>, </span><code>DELETE</code><span> 等。</span></p></li><li><p><code>&lt;对象类型&gt;</code><span>：指定对象的类型，例如 </span><code>TABLE</code><span>, </span><code>VIEW</code><span>, </span><code>SEQUENCE</code><span> 等。</span></p></li><li><p><code>&lt;对象名&gt;</code><span>：指定具体对象的名称。</span></p></li><li><p><code>&lt;用户&gt;</code><span>：指定要授予权限的用户账户。</span></p></li><li><p><code>[WITH GRANT OPTION]</code><span>：可选参数，如果包含这个选项，那么被授权的用户可以将这些权限再授予给其他用户。</span></p></li></ul><p>&nbsp;</p><p><span>发出GRANT：</span></p><ul><li><p><span>数据库管理员</span></p></li><li><p><span>数据库对象创建者（即属主Owner）</span></p></li><li><p><span>拥有该权限的用户</span></p></li></ul><p><span>接受权限的用户：</span></p><ul><li><p><span>一个或多个具体用户</span></p></li><li><p><span>PUBLIC（即全体用户）</span></p></li></ul><p>&nbsp;</p><p><span>WITH GRANT OPTION子句：</span></p><ul><li><p><span>指定：可以再授予</span></p></li><li><p><span>没有指定：不能传播</span></p></li></ul><p>&nbsp;</p><p><span>不允许循环授权：</span></p><p><img src="数据库系统概论/image-20240415153408587.png" alt="image-20240415153408587" style="zoom: 50%;" /></p><p>&nbsp;</p><p><span>[例4.1] 把查询Student表权限授给用户U1</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.2] 把对Student表和Course表的全部权限授予用户U2和U3</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALL</span> <span class="cm-keyword">PRIVILEGES</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student<span class="cm-punctuation">,</span> Course</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U2<span class="cm-punctuation">,</span> U3<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.3] 把对表SC的查询权限授予所有用户</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> PUBLIC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.4] 把查询Student表和修改学生学号的权限授给用户U4</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">UPDATE</span><span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U4<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><strong><span>对属性列的授权时必须明确指出相应属性列名</span></strong></p><p>&nbsp;</p><p><span>[例4.5] 把对表SC的INSERT权限授予U5用户，并允许他再将此权限授予其他用户</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">INSERT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U5</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> <span class="cm-keyword">GRANT</span> <span class="cm-keyword">OPTION</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.6]执行例4.5后，U5不仅拥有了对表SC的INSERT权限，还可以传播此权限：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">INSERT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U6</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> <span class="cm-keyword">GRANT</span> <span class="cm-keyword">OPTION</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.7]同样，U6还可以将此权限授予U7：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">INSERT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U7<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>但U7不能再传播此权限。</span></p><p>&nbsp;</p><p><span>REVOKE</span></p><p><span>授予的权限可以由数据库管理员或其他授权者用REVOKE语句收回</span></p><p><span>REVOKE语句的一般格式为：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>...</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>对象类型<span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span>对象名<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>对象类型<span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span>对象名<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>...</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> <span class="cm-operator">&lt;</span>用户<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>用户<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>...<span class="cm-bracket">[</span><span class="cm-keyword">CASCADE</span> <span class="cm-operator">|</span> <span class="cm-keyword">RESTRICT</span><span class="cm-bracket">]</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.8] 把用户U4修改学生学号的权限收回</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-keyword">UPDATE</span><span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> U4<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.9] 收回所有用户对表SC的查询权限</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-keyword">SELECT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> PUBLIC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.10] 把用户U5对SC表的INSERT权限收回</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-keyword">INSERT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> SC </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> U5 <span class="cm-keyword">CASCADE</span> <span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>将用户U5的INSERT权限收回的时候应该使用CASCADE，否则拒绝执行该语句</span></p><p><span>如果U6或U7还从其他用户处获得对SC表的INSERT权限，则他们仍具有此权限，系统只收回直接或间接从U5处获得的权限</span></p><p>&nbsp;</p><p><span>小结：SQL灵活的授权机制</span></p><p><span>数据库管理员：</span></p><ul><li><p><span>拥有所有对象的所有权限</span></p></li><li><p><span>根据实际情况不同的权限授予不同的用户</span></p></li></ul><p><span>用户：</span></p><ul><li><p><span>拥有自己建立的对象的的全部的操作权限</span></p></li><li><p><span>可以使用GRANT，把权限授予其他用户</span></p></li></ul><p><span>被授权的用户：</span></p><ul><li><p><span>如果具有“继续授权”的许可，可以把获得的权限再授予其他用户</span>
<span>所有授予出去的权力在必要时又都可用REVOKE语句收回</span></p></li></ul><p>&nbsp;</p><p><span>创建数据库模式的权限：</span></p><p><span>数据库管理员在创建用户时实现</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">USER</span> <span class="cm-operator">&lt;</span>username<span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">[</span><span class="cm-keyword">WITH</span><span class="cm-bracket">]</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">[</span>DBA <span class="cm-operator">|</span> RESOURCE <span class="cm-operator">|</span> <span class="cm-builtin">CONNECT</span><span class="cm-bracket">]</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>其中：</span></p><ul><li><p><code>&lt;username&gt;</code><span>：指定要创建的用户名。</span></p></li><li><p><code>[WITH]</code><span>：可选关键字，用于指定用户的其他属性。</span></p></li><li><p><code>[DBA | RESOURCE | CONNECT]</code><span>：指定用户的角色，</span><code>DBA</code><span>表示数据库管理员角色，</span><code>RESOURCE</code><span>表示用户可以创建某些对象，</span><code>CONNECT</code><span>表示用户可以连接到数据库。这些角色可以控制用户在数据库中的权限级别。</span></p></li></ul><p>&nbsp;</p><p><strong><span>CREATE USER不是SQL标准，各个系统的实现相差甚远</span></strong></p><p><span>CREATE USER语句格式说明：</span></p><ul><li><p><span>只有系统的超级用户才有权创建一个新的数据库用户</span></p></li><li><p><span>新创建的数据库用户有三种权限：CONNECT、RESOURCE和DBA</span></p></li><li><p><span>如没有指定创建的新用户的权限，默认该用户拥有CONNECT权限。拥有CONNECT权限的用户不能创建新用户，不能创建模式，也不能创建基本表，只能登录数据库</span></p></li><li><p><span>拥有RESOURCE权限的用户能创建基本表和视图，成为所创建对象的属主。但不能创建模式，不能创建新的用户</span></p></li><li><p><span>拥有DBA权限的用户是系统中的超级用户，可以创建新的用户、创建模式、创建基本表和视图等；DBA拥有对所有数据库对象的存取权限，还可以把这些权限授予一般用户</span></p></li></ul><p>&nbsp;</p><figure class='table-figure'><table><thead><tr><th style='text-align:center;' ><span>拥有的权限</span></th><th style='text-align:center;' ><span>CREATE USER</span></th><th style='text-align:center;' ><span>CREATE SCHEMA</span></th><th style='text-align:center;' ><span>CREATE TABLE</span></th><th style='text-align:center;' ><span>登录数据库，执行数据查询和操纵</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>DBA</span></td><td style='text-align:center;' ><span>可以</span></td><td style='text-align:center;' ><span>可以</span></td><td style='text-align:center;' ><span>可以</span></td><td style='text-align:center;' ><span>可以</span></td></tr><tr><td style='text-align:center;' ><span>RESOURCE</span></td><td style='text-align:center;' ><span>不可以</span></td><td style='text-align:center;' ><span>不可以</span></td><td style='text-align:center;' ><span>可以</span></td><td style='text-align:center;' ><span>可以</span></td></tr><tr><td style='text-align:center;' ><span>CONNECT</span></td><td style='text-align:center;' ><span>不可以</span></td><td style='text-align:center;' ><span>不可以</span></td><td style='text-align:center;' ><span>不可以</span></td><td style='text-align:center;' ><span>可以，但必须拥有相应权限</span></td></tr></tbody></table></figure><p>&nbsp;</p><h4 id='数据库角色'><span>数据库角色</span></h4><p><span>数据库角色：被命名的一组与数据库操作相关的权限</span></p><ul><li><p><span>角色是权限的集合</span></p></li><li><p><span>可以为一组具有相同权限的用户创建一个角色</span></p></li><li><p><span>简化授权的过程</span></p></li></ul><p>&nbsp;</p><p><span>角色的创建：</span></p><p><span>CREATE ROLE &lt;角色名&gt;</span></p><p>&nbsp;</p><p><span>给角色授权：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>… </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>对象类型<span class="cm-operator">&gt;</span>对象名</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> <span class="cm-operator">&lt;</span>角色<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>角色<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>…<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>将一个角色授予其他的角色或用户：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-operator">&lt;</span>角色1<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>角色2<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>…</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> <span class="cm-operator">&lt;</span>角色3<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>用户1<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>… </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">[</span><span class="cm-keyword">WITH</span> ADMIN <span class="cm-keyword">OPTION</span><span class="cm-bracket">]</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><ul><li><p><span>该语句把角色授予某用户，或授予另一个角色</span></p></li><li><p><span>授予者是角色的创建者或拥有在这个角色上的ADMIN OPTION</span></p></li><li><p><span>指定了WITH ADMIN OPTION则获得某种权限的角色或用户还可以把这种权限授予其他角色</span></p></li></ul><p>&nbsp;</p><p><span>一个角色的权限：直接授予这个角色的全部权限加上其他角色授予这个角色的全部权限</span></p><p>&nbsp;</p><p><span>角色权限的收回:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>权限<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>…</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>对象类型<span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span>对象名<span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> <span class="cm-operator">&lt;</span>角色<span class="cm-operator">&gt;</span><span class="cm-bracket">[</span><span class="cm-punctuation">,</span><span class="cm-operator">&lt;</span>角色<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span>…<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><ul><li><p><span>用户可以回收角色的权限，从而修改角色拥有的权限</span></p></li><li><p><span>REVOKE执行者是</span></p><ul><li><p><span>角色的创建者</span></p></li><li><p><span>拥有在这个（些）角色上的ADMIN OPTION</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>[例4.11] 通过角色来实现将一组权限授予一个用户。</span></p><p><span>步骤如下：</span></p><p><span>首先创建一个角色 R1</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> ROLE R1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>然后使用GRANT语句，使角色R1拥有Student表的SELECT、UPDATE、INSERT权限</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span><span class="cm-punctuation">,</span> <span class="cm-keyword">UPDATE</span><span class="cm-punctuation">,</span> <span class="cm-keyword">INSERT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> R1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>将这个角色授予王平，张明，赵玲。使他们具有角色R1所包含的全部权限</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> R1 </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 王平<span class="cm-punctuation">,</span>张明<span class="cm-punctuation">,</span>赵玲<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>可以一次性通过R1来回收王平的这3个权限</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> R1 </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> 王平<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例4.12] 角色的权限修改</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">DELETE</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> R1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>使角色R1在原来的基础上增加了Student表的 DELETE 权限</span></p><p>&nbsp;</p><p><span>[例4.13]</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">REVOKE</span> <span class="cm-keyword">SELECT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> R1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>使R1减少了SELECT权限</span></p><p>&nbsp;</p><h4 id='强制访问控制方法'><span>强制访问控制方法</span></h4><p><span>可能存在数据的“无意泄露”</span></p><p><span>原因：这种机制仅仅通过对数据的访问权限来进行安全控制，而数据本身并无安全性标记</span></p><p><span>解决：对系统控制下的所有主客体实施强制访问控制策略</span></p><p>&nbsp;</p><p><span>强制访问控制（MAC）</span></p><ul><li><p><span>保证更高程度的安全性</span></p></li><li><p><span>用户不能直接感知或进行控制</span></p></li><li><p><span>适用于对数据有严格而固定密级分类的部门</span></p><ul><li><p><span>军事部门</span></p></li><li><p><span>政府部门</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>在强制访问控制中，数据库管理系统所管理的全部实体被分为主体和客体两大类</span></p><p><span>主体是系统中的活动实体：</span></p><ul><li><p><span>数据库管理系统所管理的实际用户</span></p></li><li><p><span>代表用户的各进程</span></p></li></ul><p><span>客体是系统中的被动实体，受主体操纵：</span></p><ul><li><p><span>文件</span></p></li><li><p><span>基本表</span></p></li><li><p><span>索引</span></p></li><li><p><span>视图</span></p></li></ul><p>&nbsp;</p><p><span>对于主体和客体，DBMS为它们每个实例（值）指派一个敏感度标记（Label）</span></p><p><span>敏感度标记分成若干级别：</span></p><ul><li><p><span>绝密（Top Secret，TS）</span></p></li><li><p><span>机密（Secret，S）</span></p></li><li><p><span>可信（Confidential，C）</span></p></li><li><p><span>公开（Public，P）</span></p></li></ul><p><strong><span>TS&gt;=S&gt;=C&gt;=P</span></strong></p><p><span>主体的敏感度标记称为</span><strong><span>许可证级别</span></strong><span>（Clearance Level）</span></p><p><span>客体的敏感度标记称为</span><strong><span>密级</span></strong><span>（Classification Level）</span></p><p>&nbsp;</p><p><span>强制访问控制规则：</span></p><ol start='' ><li><p><span>仅当主体的许可证级别大于或等于客体的密级时，该主体才能读取相应的客体</span></p></li><li><p><span>仅当主体的许可证级别小于或等于客体的密级时，该主体才能写相应的客体</span></p></li></ol><p>&nbsp;</p><p><span>强制访问控制（MAC）是对数据本身进行密级标记，无论数据如何复制，标记与数据是一个不可分的整体，只有符合密级标记要求的用户才可以操纵数据。</span></p><p>&nbsp;</p><p><span>实现强制访问控制时要首先实现自主访问控制。</span></p><p><span>原因：较高安全性级别提供的安全保护要包含较低级别的所有保护</span></p><p>&nbsp;</p><p><span>自主访问控制与强制访问控制共同构成数据库管理系统的安全机制</span></p><p>&nbsp;</p><p><span>DAC + MAC安全检查</span></p><p><img src="数据库系统概论/image-20240415155434908.png" alt="image-20240415155434908" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>先进行自主访问控制检查，通过自主访问控制检查的数据对象再由系统进行强制访问控制检查，只有通过强制访问控制检查的数据对象方可访问。</span></p><p>&nbsp;</p><h2 id='视图机制'><span>视图机制</span></h2><p><span>把要保密的数据对无权存取这些数据的用户隐藏起来，对数据提供一定程度的安全保护</span></p><p>&nbsp;</p><p><span>间接地实现支持存取谓词的用户权限定义</span></p><p>&nbsp;</p><p><span>[例4.14] 建立计算机系学生的视图，把对该视图的 SELECT 权限授于王平，把该视图上的所有操作权限授于张明</span></p><p><span>先建立计算机系学生的视图CS_Student：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">VIEW</span> CS_Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">AS</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> Sdept<span class="cm-operator">=</span><span class="cm-string">'CS'</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>在视图上进一步定义存取权限：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> CS_Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 王平<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALL</span> PRIVILIGES</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> CS_Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 张明<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h2 id='审计audit）'><span>审计（Audit）</span></h2><h3 id='什么是审计'><span>什么是审计</span></h3><ul><li><p><span>启用一个专用的审计日志（Audit Log），将用户对数据库的所有操作记录在上面</span></p></li><li><p><span>审计员利用审计日志监控数据库中的各种行为，找出非法存取数据的人、时间和内容</span></p></li><li><p><span>C2以上安全级别的DBMS必须具有审计功能</span></p></li></ul><p>&nbsp;</p><h3 id='审计功能的可选性'><span>审计功能的可选性</span></h3><ul><li><p><span>审计很费时间和空间</span></p></li><li><p><span>DBA可以根据应用对安全性的要求，灵活地打开或关闭审计功能</span></p></li><li><p><span>审计功能主要用于安全性要求较高的部门</span></p></li></ul><p>&nbsp;</p><h3 id='审计事件'><span>审计事件</span></h3><h4 id='服务器事件'><span>服务器事件</span></h4><p><span>审计数据库服务器发生的事件(启动,停止,…)</span></p><h4 id='系统权限'><span>系统权限</span></h4><p><span>对系统拥有的结构或模式对象进行操作的审计</span></p><p><span>要求该操作的权限是通过系统权限获得的</span></p><h4 id='语句事件'><span>语句事件</span></h4><p><span>对SQL语句，如DDL(Creat, drop…)、DML(update, insert, delete)、DQL(select)及DCL(Grant)语句的审计</span></p><h4 id='模式对象事件'><span>模式对象事件</span></h4><p><span>对特定模式对象上进行的SELECT或DML操作的审计</span></p><p>&nbsp;</p><h3 id='审计功能'><span>审计功能</span></h3><ul><li><p><span>基本功能：提供多种审计查阅方式</span></p></li><li><p><span>多套审计规则：一般在初始化设定</span></p></li><li><p><span>提供审计分析和报表功能</span></p></li><li><p><span>审计日志管理功能</span></p><ul><li><p><span>防止审计员误删审计记录，审计日志必须先转储后删除</span></p></li><li><p><span>对转储的审计记录文件提供完整性和保密性保护</span></p></li><li><p><span>只允许审计员查阅和转储审计记录，不允许任何用户新增和修改审计记录等</span></p></li></ul></li><li><p><span>提供查询审计设置及审计记录信息的专门视图</span></p></li></ul><p>&nbsp;</p><h3 id='语句'><span>语句</span></h3><p><span>AUDIT语句和NOAUDIT语句</span></p><p><span>AUDIT语句：设置审计功能</span></p><p><span>NOAUDIT语句：取消审计功能</span></p><p>&nbsp;</p><h3 id='用户级审计'><span>用户级审计</span></h3><p><span>任何用户可设置的审计</span></p><p><span>主要是用户针对自己创建的数据库表和视图进行审计</span></p><p>&nbsp;</p><h3 id='系统级审计'><span>系统级审计</span></h3><p><span>只能由数据库管理员设置</span></p><p><span>监测成功或失败的登录要求、监测授权和收回操作以及其他数据库级权限下的操作</span></p><p>&nbsp;</p><p><span>[例4.15] 对修改SC表结构或修改SC表数据的操作进行审计</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">AUDIT <span class="cm-keyword">ALTER</span><span class="cm-punctuation">,</span><span class="cm-keyword">UPDATE</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> SC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>[例4.16] 取消对SC表的一切审计</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NOAUDIT <span class="cm-keyword">ALTER</span><span class="cm-punctuation">,</span><span class="cm-keyword">UPDATE</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> SC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h2 id='数据加密'><span>数据加密</span></h2><p><span>数据加密：防止数据库中数据在存储和传输中失密的有效手段</span></p><p><span>加密的基本思想：根据一定的算法将原始数据—明文（Plain text）变换为不可直接识别的格式—密文（Cipher text）</span></p><p><span>加密方法：</span></p><ul><li><p><span>存储加密</span></p></li><li><p><span>传输加密</span></p></li></ul><p>&nbsp;</p><h3 id='存储加密'><span>存储加密</span></h3><p><span>透明存储加密：</span></p><ul><li><p><span>内核级加密保护方式，对用户完全透明</span></p></li><li><p><span>将数据在写到磁盘时对数据进行加密，授权用户读取数据时再对其进行解密</span></p></li><li><p><span>数据库的应用程序不需要做任何修改，只需在创建表语句中说明需加密的字段即可</span></p></li></ul><p><span>内核级加密方法: 性能较好，安全完备性较高</span></p><p>&nbsp;</p><p><span>非透明存储加密：</span></p><ul><li><p><span>通过多个加密函数实现</span></p></li></ul><p>&nbsp;</p><h3 id='传输加密'><span>传输加密</span></h3><p><span>链路加密：</span></p><ul><li><p><span>在链路层进行加密</span></p></li><li><p><span>传输信息由报头和报文两部分组成</span></p></li><li><p><span>报文和报头均加密</span></p></li></ul><p><span>端到端加密：</span></p><ul><li><p><span>在发送端加密，接收端解密</span></p></li><li><p><span>只加密报文不加密报头</span></p></li><li><p><span>所需密码设备数量相对较少，容易被非法监听者发现并从中获取敏感信息</span></p></li></ul><p>&nbsp;</p><p><span>数据库管理系统可信传输示意图如下所示：</span></p><p><img src="数据库系统概论/image-20240415160157244.png" referrerpolicy="no-referrer" alt="image-20240415160157244"></p><p>&nbsp;</p><p><span>基于安全套接层协议SSL传输方案的实现思路：</span></p><ol start='' ><li><p><span>确认通信双方端点的可靠性</span></p><ul><li><p><span>采用基于数字证书的服务器和客户端认证方式</span></p></li><li><p><span>通信时均首先向对方提供己方证书，然后使用本地的 CA 信任列表和证书撤销列表对接收到的对方证书进行验证</span></p></li></ul></li><li><p><span>协商加密算法和密钥</span></p><ul><li><p><span>确认双方端点的可靠性后，通信双方协商本次会话的加密算法与密钥</span></p></li></ul></li><li><p><span>可信数据传输</span></p><ul><li><p><span>业务数据在被发送之前将被用某一组特定的密钥进行加密和消息摘要计算，以密文形式在网络上传输</span></p></li><li><p><span>当业务数据被接收的时候，需用相同一组特定的密钥进行解密和摘要计算</span></p></li></ul></li></ol><p>&nbsp;</p><h2 id='其他安全性保护'><span>其他安全性保护</span></h2><h3 id='推理控制'><span>推理控制</span></h3><p><span>处理强制访问控制未解决的问题</span></p><p><span>避免用户利用能够访问的数据推知更高密级的数据</span></p><p><span>常用方法:</span></p><ul><li><p><span>基于函数依赖的推理控制</span></p></li><li><p><span>基于敏感关联的推理控制</span></p></li></ul><p>&nbsp;</p><h3 id='隐蔽信道'><span>隐蔽信道</span></h3><p><span>处理强制访问控制未解决的问题</span></p><p>&nbsp;</p><h3 id='数据隐私保护'><span>数据隐私保护</span></h3><p><span>描述个人控制其不愿他人知道或他人不便知道的个人数据的能力</span></p><p><span>范围很广：数据收集、数据存储、数据处理和数据发布等各个阶段</span></p><p>&nbsp;</p><h1 id='数据库完整性'><span>数据库完整性</span></h1><p><span>数据库的完整性：</span></p><ul><li><p><span>数据的正确性：是指数据是符合现实世界语义，反映了当前的实际状况</span></p></li><li><p><span>数据的相容性：是指数据库同一对象在不同关系表中的数据是符合逻辑的不互相矛盾</span></p></li></ul><p>&nbsp;</p><p><img src="数据库系统概论/image-20240415221004829.png" referrerpolicy="no-referrer" alt="image-20240415221004829"></p><p>&nbsp;</p><p><strong><span>数据的完整性和安全性是两个不同概念</span></strong></p><p><span>数据的完整性：</span></p><ul><li><p><span>防止数据库中存在不符合语义的数据，也就是防止数据库中存在不正确的数据</span></p></li><li><p><span>防范对象：不合语义的、不正确的数据</span></p></li></ul><p><span>数据的安全性：</span></p><ul><li><p><span>保护数据库 防止恶意的破坏和非法的存取</span></p></li><li><p><span>防范对象：非法用户和非法操作</span></p></li></ul><p>&nbsp;</p><p><span>为维护数据库的完整性，数据库管理系统必须：</span></p><ol start='' ><li><p><span>提供定义完整性约束条件的机制</span></p><ul><li><p><span>完整性约束条件也称为完整性规则，是数据库中的数据必须满足的语义约束条件</span></p></li><li><p><span>SQL标准使用了一系列概念来描述完整性，包括关系模型的实体完整性、参照完整性和用户定义完整性</span></p></li><li><p><span>这些完整性一般由SQL的数据定义语言语句来实现</span></p></li></ul></li><li><p><span>提供完整性检查的方法</span></p><ul><li><p><span>数据库管理系统中检查数据是否满足完整性约束条件的机制称为完整性检查</span></p></li><li><p><span>一般在INSERT、UPDATE、DELETE语句执行后开始检查，也可以在事务提交时检查</span></p></li></ul></li><li><p><span>违约处理</span></p><ul><li><p><span>数据库管理系统若发现用户的操作违背了完整性约束条件，就采取一定的动作</span></p><ul><li><p><span>拒绝（NO ACTION）执行该操作</span></p></li><li><p><span>级连（CASCADE）执行其他操作</span></p></li></ul></li></ul></li></ol><p>&nbsp;</p><p><span>DBMS自动处理，早期的DBMS不能实现。</span></p><p><span>应用也可以实现，但无法保障，且增加程序员负担。</span></p><p>&nbsp;</p><h2 id='实体完整性'><span>实体完整性</span></h2><h3 id='实体完整性定义'><span>实体完整性定义</span></h3><p><span>关系模型的实体完整性：</span></p><p><span>CREATE TABLE中用PRIMARY KEY定义</span></p><p>&nbsp;</p><p><span>单属性构成的码有两种说明方法：</span></p><ul><li><p><span>定义为列级约束条件</span></p></li><li><p><span>定义为表级约束条件</span></p></li></ul><p>&nbsp;</p><p><span>对多个属性构成的码只有一种说明方法：定义为表级约束条件</span></p><p>&nbsp;</p><p><span>[例5.1] 将Student表中的Sno属性定义为码</span></p><p><span>在列级定义主码</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ssex <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sage <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sdept <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="height: 161px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>在表级定义主码</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ssex <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sage <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sdept <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span> </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="height: 184px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.2] 将SC表中的Sno，Cno属性组定义为码</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Cno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Grade <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span>Cno<span class="cm-bracket">)</span> <span class="cm-comment">/*只能在表级定义主码*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span> </span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='实体完整性检查和违约处理'><span>实体完整性检查和违约处理</span></h3><p><span>插入或对主码列进行更新操作时，关系数据库管理系统按照实体完整性规则自动进行检查。包括：</span></p><ul><li><p><span>检查主码值是否唯一，如果不唯一则拒绝插入或修改</span></p></li><li><p><span>检查主码的各个属性是否为空，只要有一个为空就拒绝插入或修改</span></p></li></ul><p>&nbsp;</p><p><span>检查记录中主码值是否唯一的一种方法是进行全表扫描，依次判断表中每一条记录的主码值与将插入记录上的主码值（或者修改的新主码值）是否相同</span></p><p><img src="数据库系统概论/image-20240415221532646.png" referrerpolicy="no-referrer" alt="image-20240415221532646"></p><p>&nbsp;</p><p><span>表扫描缺点：十分耗时</span></p><p>&nbsp;</p><p><span>为避免对基本表进行全表扫描，RDBMS核心一般都在主码上自动建立一个索引</span></p><p><span>B+树索引</span></p><p><img src="数据库系统概论/image-20240415221621762.png" referrerpolicy="no-referrer" alt="image-20240415221621762"></p><ol start='' ><li><p><span>新插入记录的主码值是25</span></p></li><li><p><span>通过主码索引，从B+树的根结点开始查找</span></p></li><li><p><span>读取3个结点：根结点（51）、中间结点（12 30）、叶结点（15 20 25）</span></p></li><li><p><span>该主码值已经存在，不能插入这条记录</span></p></li></ol><p>&nbsp;</p><h2 id='参照完整性'><span>参照完整性</span></h2><h3 id='参照完整性定义'><span>参照完整性定义</span></h3><p><span>关系模型的参照完整性定义：</span></p><p><span>在CREATE TABLE中用FOREIGN KEY短语定义哪些列为外码，用REFERENCES短语指明这些外码参照哪些表的主码</span></p><p>&nbsp;</p><p><span>例如，关系SC中（Sno，Cno）是主码。Sno，Cno分别参照Student表的主码和Course表的主码</span></p><p>&nbsp;</p><p><span>[例5.3]定义SC中的参照完整性</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Cno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Grade <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span> Cno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span> <span class="cm-comment">/*在表级定义实体完整性*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Student<span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*在表级定义参照完整性*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Course<span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*在表级定义参照完整性*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="height: 230px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='参照完整性检查和违约处理'><span>参照完整性检查和违约处理</span></h3><p><span>一个参照完整性将两个表中的相应元组联系起来，对被参照表和参照表进行增删改操作时有可能破坏参照完整性，必须进行检查。</span></p><p>&nbsp;</p><p><span>例如，对表SC和Student有四种可能破坏参照完整性的情况 :</span></p><ul><li><p><span>SC表中增加一个元组，该元组的Sno属性的值在表Student中找不到一个元组，其Sno属性的值与之相等</span></p></li><li><p><span>修改SC表中的一个元组，修改后该元组的Sno属性的值在表Student中找不到一个元组，其Sno属性的值与之相等</span></p></li></ul><p>&nbsp;</p><p><span>例如，对表SC和Student有四种可能破坏参照完整性的情况 （续）:</span></p><ul><li><p><span>从Student表中删除一个元组，造成SC表中某些元组的Sno属性的值在表Student中找不到一个元组，其Sno属性的值与之相等。</span></p></li><li><p><span>修改Student表中一个元组的Sno属性，造成SC表中某些元组的Sno属性的值在表Student中找不到一个元组，其Sno属性的值与之相等 。</span></p></li></ul><p>&nbsp;</p><p><span>可能破坏参照完整性的情况及违约处理如下图所示：</span></p><p><img src="数据库系统概论/image-20240415221922230.png" referrerpolicy="no-referrer" alt="image-20240415221922230"></p><p>&nbsp;</p><p><span>参照完整性违约处理：</span></p><ol start='' ><li><p><span>拒绝（NO ACTION）执行：不允许该操作执行。该策略一般设置为默认策略。</span></p></li><li><p><span>级联（CASCADE）操作：当删除或修改被参照表（Student）的一个元组造成了与参照表（SC）的不一致，则删除或修改参照表中的所有造成不一致的元组</span></p></li><li><p><span>设置为空值（SET-NULL）：当删除或修改被参照表的一个元组时造成了不一致，则将参照表中的所有造成不一致的元组的对应属性设置为空值。</span></p></li></ol><p>&nbsp;</p><p><span>例如，有下面2个关系：</span></p><p><span>学生（学号，姓名，性别，专业号，年龄）</span></p><p><span>专业（专业号，专业名）</span></p><p><span>假设专业表中某个元组被删除，专业号为12</span></p><p><span>按照设置为空值的策略，就要把学生表中专业号=12的所有元组的专业号设置为空值</span></p><p><span>对应语义：某个专业删除了，该专业的所有学生专业未定，等待重新分配专业</span></p><p>&nbsp;</p><p><span>对于参照完整性，除了应该定义外码，还应定义外码列是否允许空值</span></p><p>&nbsp;</p><p><span>[例5.4] 显式说明参照完整性的违约处理示例</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>12</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> SC <span class="cm-bracket">(</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Cno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Grade <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span>Cno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Student<span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ON</span> <span class="cm-keyword">DELETE</span> <span class="cm-keyword">CASCADE</span> <span class="cm-comment">-- 级联删除SC表中相应的元组</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ON</span> <span class="cm-keyword">UPDATE</span> <span class="cm-keyword">CASCADE</span><span class="cm-punctuation">,</span> <span class="cm-comment">-- 级联更新SC表中相应的元组</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Course<span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ON</span> <span class="cm-keyword">DELETE</span> <span class="cm-keyword">NO</span> <span class="cm-keyword">ACTION</span> <span class="cm-comment">-- 当删除course表中的元组造成了与SC表不一致时拒绝删除</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ON</span> <span class="cm-keyword">UPDATE</span> <span class="cm-keyword">CASCADE</span> <span class="cm-comment">-- 当更新course表中的cno时，级联更新SC表中相应的元组</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 276px;"></div><div class="CodeMirror-gutters" style="height: 276px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p><h2 id='用户定义的完整性'><span>用户定义的完整性</span></h2><p><span>用户定义的完整性是：针对某一具体应用的数据必须满足的语义要求。</span></p><p><span>关系数据库管理系统提供了定义和检验用户定义完整性的机制，不必由应用程序承担</span></p><p>&nbsp;</p><h3 id='属性上的约束条件'><span>属性上的约束条件</span></h3><p><span>CREATE TABLE时定义属性上的约束条件：</span></p><ul><li><p><span>列值非空（NOT NULL）</span></p></li><li><p><span>列值唯一（UNIQUE）</span></p></li><li><p><span>检查列值是否满足一个条件表达式（CHECK）</span></p></li></ul><p>&nbsp;</p><h4 id='不允许取空值'><span>不允许取空值</span></h4><p><span>[例5.5] 在定义SC表时，说明Sno、Cno、Grade属性不允许取空值。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Cno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Grade <span class="cm-keyword">SMALLINT</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span> Cno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>…</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/* 如果在表级定义实体完整性，隐含了Sno，Cno不允许取空值，则在</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-comment"><span class="cm-tab" role="presentation" cm-text="	">    </span>列级不允许取空值的定义 可以不写（不同DBMS处理方式可能不同） * /</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">); </span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 207px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h4 id='列值唯一'><span>列值唯一</span></h4><p><span>[例5.6]建立部门表DEPT，要求部门名称Dname列取值唯一，部门编号Deptno列为主码</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> DEPT</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Deptno <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Dname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">UNIQUE</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span>，</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*要求Dname列值唯一, 并且不能取空值*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Location <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">10</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Deptno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="height: 161px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h4 id='check短语'><span>CHECK短语</span></h4><p><span>用CHECK短语指定列值应该满足的条件</span></p><p><span>[例5.7] Student表的Ssex只允许取“男”或“女”。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">8</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ssex <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span> <span class="cm-keyword">CHECK</span> （Ssex <span class="cm-keyword">IN</span> （‘男’<span class="cm-punctuation">,</span>’女’）），</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*性别属性Ssex只允许取'男'或'女' */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sage <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sdept <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="height: 184px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.8] SC表的Grade的值应该在0和100之间。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span> <span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Cno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Grade <span class="cm-keyword">SMALLINT</span> <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Grade<span class="cm-operator">&gt;=</span><span class="cm-number">0</span> <span class="cm-keyword">AND</span> Grade <span class="cm-operator">&lt;=</span><span class="cm-number">100</span><span class="cm-bracket">)</span>，</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*Grade取值范围是0到100*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span>Cno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Student<span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Course<span class="cm-bracket">(</span>Cno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 207px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='属性上的约束条件检查和违约处理'><span>属性上的约束条件检查和违约处理</span></h3><p><span>插入元组或修改属性的值时，关系数据库管理系统检查属性上的约束条件是否被满足，如果不满足则操作被拒绝执行。</span></p><p>&nbsp;</p><h3 id='元组上的约束条件'><span>元组上的约束条件</span></h3><p><span>在CREATE TABLE时可以用CHECK短语定义元组上的约束条件，即元组级的限制。</span></p><p><span>同属性值限制相比，元组级的限制可以设置不同属性之间的取值的相互约束条件。</span></p><p>&nbsp;</p><p><span>[例5.9]当学生的性别是男时，其名字不能以Ms.打头。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">9</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">8</span><span class="cm-bracket">)</span> <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span>，</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ssex <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sage <span class="cm-keyword">SMALLINT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sdept <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Ssex<span class="cm-operator">=</span><span class="cm-string">'女'</span> <span class="cm-keyword">OR</span> Sname <span class="cm-keyword">NOT</span> <span class="cm-keyword">LIKE</span> <span class="cm-string">'Ms.%'</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*定义了元组中Sname和 Ssex两个属性值之间的约束条件*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="height: 230px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p><span>性别是女性的元组都能通过该项检查，因为Ssex=‘女’成立;</span></p><p><span>当性别是男性时，要通过检查则名字一定不能以Ms.打头</span></p><p>&nbsp;</p><h3 id='元组上的约束条件检查和违约处理'><span>元组上的约束条件检查和违约处理</span></h3><p><span>插入元组或修改属性的值时，关系数据库管理系统检查元组上的约束条件是否被满足，如果不满足则操作被拒绝执行</span></p><p>&nbsp;</p><h2 id='完整性约束命名字句'><span>完整性约束命名字句</span></h2><h3 id='新建'><span>新建</span></h3><p><span>完整性约束命名子句：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CONSTRAINT</span> <span class="cm-operator">&lt;</span>完整性约束条件名<span class="cm-operator">&gt;&lt;</span>完整性约束条件<span class="cm-operator">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>&lt;完整性约束条件&gt;包括NOT NULL、UNIQUE、PRIMARY KEY短语、FOREIGN KEY短语、CHECK短语等</span></p><p>&nbsp;</p><p><span>[例5.10]建立学生登记表Student，要求学号在90000~99999之间，姓名不能取空值，年龄小于30，性别只能是“男”或“女”。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Sno <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">6</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> C1 <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Sno <span class="cm-keyword">BETWEEN</span> <span class="cm-number">90000</span> <span class="cm-keyword">AND</span> <span class="cm-number">99999</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sname <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> C2 <span class="cm-keyword">NOT</span> <span class="cm-atom">NULL</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sage <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">3</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> C3 <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Sage <span class="cm-operator">&lt;</span> <span class="cm-number">30</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ssex <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> C4 <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Ssex <span class="cm-keyword">IN</span> <span class="cm-bracket">(</span> ‘男’<span class="cm-punctuation">,</span><span class="cm-string">'女'</span><span class="cm-bracket">))</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> StudentKey <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-bracket">(</span>Sno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="height: 253px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p><span>在Student表上建立了5个约束条件，包括主码约束（命名为 StudentKey）以及C1、C2、C3、C4四个列级约束。</span></p><p>&nbsp;</p><p><span>[例5.11]建立教师表TEACHER，要求每个教师的应发工资不低于3000元。</span></p><p><span>应发工资是工资列Sal与扣除项Deduct之和。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>11</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> TEACHER</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">(</span> <span class="cm-tab" role="presentation" cm-text="	">  </span>Eno <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">4</span><span class="cm-bracket">)</span> <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span> <span class="cm-comment">/*在列级定义主码*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Ename <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">10</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Job <span class="cm-type">CHAR</span><span class="cm-bracket">(</span><span class="cm-number">8</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Sal <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">7</span><span class="cm-punctuation">,</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Deduct <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">7</span><span class="cm-punctuation">,</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span>Deptno <span class="cm-type">NUMERIC</span><span class="cm-bracket">(</span><span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> TEACHERFKey <span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>Deptno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">REFERENCES</span> DEPT<span class="cm-bracket">(</span>Deptno<span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CONSTRAINT</span> C1 <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Sal <span class="cm-operator">+</span> Deduct <span class="cm-operator">&gt;=</span> <span class="cm-number">3000</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="height: 253px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='修改'><span>修改</span></h3><p><span>修改表中的完整性限制：使用ALTER TABLE语句修改表中的完整性限制</span></p><p>&nbsp;</p><p><span>[例5.12]去掉例5.10 Student表中对性别的限制。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> <span class="cm-keyword">CONSTRAINT</span> C4<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.13] 修改表Student中的约束条件，要求学号改为在900000~999999之间，年龄由小于30改为小于40</span></p><p><strong><span>可以先删除原来的约束条件，再增加新的约束条件</span></strong></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> <span class="cm-keyword">CONSTRAINT</span> C1<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ADD</span> <span class="cm-keyword">CONSTRAINT</span> C1 <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Sno <span class="cm-keyword">BETWEEN</span> <span class="cm-number">900000</span> <span class="cm-keyword">AND</span> <span class="cm-number">999999</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> <span class="cm-keyword">CONSTRAINT</span> C3<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ADD</span> <span class="cm-keyword">CONSTRAINT</span> C3 <span class="cm-keyword">CHECK</span><span class="cm-bracket">(</span>Sage <span class="cm-operator">&lt;</span> <span class="cm-number">40</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="height: 184px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h2 id='域中的完整性限制'><span>*域中的完整性限制</span></h2><p>&nbsp;</p><h2 id='断言'><span>断言</span></h2><p><span>SQL中，可以使用 CREATE ASSERTION语句，通过声明性断言来指定更具一般性的约束。</span></p><p><span>断言可以定义涉及多个表的或聚集操作的比较复杂的完整性约束。</span></p><p><span>断言创建以后，任何对断言中所涉及的关系的操作都会触发关系数据库管理系统对断言的检查，任何使断言不为真值的操作都会被拒绝执行。</span></p><p>&nbsp;</p><p><span>创建断言的语句格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> ASSERTION<span class="cm-operator">&lt;</span>断言名<span class="cm-operator">&gt;&lt;</span><span class="cm-keyword">CHECK</span> 子句<span class="cm-operator">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>每个断言都被赋予一个名字，&lt;CHECK 子句&gt;中的约束条件与WHERE子句的条件表达式类似。</span></p><p>&nbsp;</p><p><span>[例5.18] 限制数据库课程最多60名学生选修</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> ASSERTION ASSE_SC_DB_NUM</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span><span class="cm-number">60</span> <span class="cm-operator">&gt;=</span> <span class="cm-bracket">(</span><span class="cm-keyword">select</span> <span class="cm-keyword">count</span><span class="cm-bracket">(</span><span class="cm-operator">*</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*此断言的谓词涉及聚集操作count的SQL语句*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">From</span> Course<span class="cm-punctuation">,</span>SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">Where</span> SC<span class="cm-variable-2">.Cno</span><span class="cm-operator">=</span>Course<span class="cm-variable-2">.Cno</span> <span class="cm-keyword">and</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>Course<span class="cm-variable-2">.Cname</span> <span class="cm-operator">=</span><span class="cm-string">'数据库'</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="height: 161px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.19]限制每一门课程最多60名学生选修</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> ASSERTION ASSE_SC_CNUM1</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CHECK</span><span class="cm-bracket">(</span><span class="cm-number">60</span> <span class="cm-operator">&gt;=</span> <span class="cm-keyword">ALL</span> <span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-keyword">count</span><span class="cm-bracket">(</span><span class="cm-operator">*</span><span class="cm-bracket">)</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FROM</span> SC </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">GROUP</span> <span class="cm-keyword">by</span> cno<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*此断言的谓词，涉及聚集操作count 和分组函数group by的SQL语句*/</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.20]限制每个学期每一门课程最多60名学生选修</span></p><p><strong><span>首先需要修改SC表的模式，增加一个“学期（TERM）”属性</span></strong></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ALTER</span> <span class="cm-keyword">TABLE</span> SC <span class="cm-keyword">ADD</span> TERM <span class="cm-type">DATE</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>然后，定义断言：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> ASSERTION ASSE_SC_CNUM2</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">CHECK</span><span class="cm-bracket">(</span><span class="cm-number">60</span> <span class="cm-operator">&gt;=</span> <span class="cm-keyword">ALL</span> <span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-keyword">count</span><span class="cm-bracket">(</span><span class="cm-operator">*</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">FROM</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">GROUP</span> <span class="cm-keyword">by</span> cno<span class="cm-punctuation">,</span>TERM<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>删除断言的语句格式为：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> ASSERTION <span class="cm-operator">&lt;</span>断言名<span class="cm-operator">&gt;</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>如果断言很复杂，则系统在检测和维护断言的开销较高，这是在使用断言时应该注意的</span></p><p>&nbsp;</p><h2 id='触发器'><span>触发器</span></h2><p><span>触发器（Trigger）是用户定义在关系表上的一类由事件驱动的特殊过程</span></p><ul><li><p><span>触发器保存在数据库服务器中</span></p></li><li><p><span>任何用户对表的增、删、改操作均由服务器自动激活相应的触发器</span></p></li><li><p><span>触发器可以实施更为复杂的检查和操作，具有更精细和更强大的数据控制能力</span></p></li></ul><p>&nbsp;</p><h3 id='定义触发器'><span>定义触发器</span></h3><p><span>CREATE TRIGGER语法格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TRIGGER</span> <span class="cm-operator">&lt;</span>触发器名<span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">{</span><span class="cm-keyword">BEFORE</span> <span class="cm-operator">|</span> <span class="cm-keyword">AFTER</span><span class="cm-bracket">}</span> <span class="cm-operator">&lt;</span>触发事件<span class="cm-operator">&gt;</span> <span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>表名<span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">REFERENCING NEW<span class="cm-operator">|</span>OLD <span class="cm-keyword">ROW</span> <span class="cm-keyword">AS</span> <span class="cm-operator">&lt;</span>变量<span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FOR</span> <span class="cm-keyword">EACH</span> <span class="cm-bracket">{</span><span class="cm-keyword">ROW</span> <span class="cm-operator">|</span> STATEMENT<span class="cm-bracket">}</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">[</span><span class="cm-keyword">WHEN</span> <span class="cm-operator">&lt;</span>触发条件<span class="cm-operator">&gt;</span><span class="cm-bracket">]</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span>触发动作体<span class="cm-operator">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>触发器又叫做事件-条件-动作（event-condition-action）规则。</span></p><p><span>当特定的系统事件发生时，对规则的条件进行检查，如果条件成立则执行规则中的动作，否则不执行该动作。规则中的动作体可以很复杂，通常是一段SQL存储过程。</span></p><p>&nbsp;</p><p><span>定义触发器的语法说明：</span></p><ul><li><p><span>表的拥有者才可以在表上创建触发器</span></p></li><li><p><span>触发器名</span></p><ul><li><p><span>触发器名可以包含模式名，也可以不包含模式名</span></p></li><li><p><span>同一模式下，触发器名必须是唯一的</span></p></li><li><p><span>触发器名和表名必须在同一模式下</span></p></li></ul></li><li><p><span>表名</span></p><ul><li><p><span>触发器只能定义在基本表上，不能定义在视图上</span></p></li><li><p><span>当基本表的数据发生变化时，将激活定义在该表上相应触发事件的触发器</span></p></li></ul></li><li><p><span>触发事件</span></p><ul><li><p><span>触发事件可以是INSERT、DELETE或UPDATE也可以是这几个事件的组合</span></p></li><li><p><span>还可以UPDATE OF&lt;触发列，...&gt;，即进一步指明修改哪些列时激活触发器</span></p></li><li><p><span>AFTER/BEFORE是触发的时机</span></p><ul><li><p><span>AFTER表示在触发事件的操作执行之后激活触发器</span></p></li><li><p><span>BEFORE表示在触发事件的操作执行之前激活触发器</span></p></li></ul></li></ul></li><li><p><span>触发器类型</span></p><ul><li><p><span>行级触发器（FOR EACH ROW）</span></p></li><li><p><span>语句级触发器（FOR EACH STATEMENT）</span></p></li></ul></li><li><p><span>触发条件</span></p><ul><li><p><span>触发器被激活时，只有当触发条件为真时触发动作体才执行；否则触发动作体不执行</span></p></li><li><p><span>如果省略WHEN触发条件，则触发动作体在触发器激活后立即执行</span></p></li></ul></li><li><p><span>触发动作体</span></p><ul><li><p><span>触发动作体可以是一个匿名PL/SQL过程块，也可以是对已创建存储过程的调用</span></p></li><li><p><span>如果是行级触发器，用户都可以在过程体中使用NEW和OLD引用事件之后的新值和事件之前的旧值</span></p></li><li><p><span>如果是语句级触发器，则不能在触发动作体中使用NEW或OLD进行引用</span></p></li><li><p><span>如果触发动作体执行失败，激活触发器的事件就会终止执行，触发器的目标表或触发器可能影响的其他对象不发生任何变化</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>例如，在例5.11的TEACHER表上创建一个AFTER UPDATE触发器，触发事件是UPDATE语句：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">UPDATE</span> TEACHER <span class="cm-keyword">SET</span> Deptno<span class="cm-operator">=</span><span class="cm-number">5</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>假设表TEACHER有1000行</span></p><ul><li><p><span>如果是语句级触发器，那么执行完该语句后，触发动作只发生一次</span></p></li><li><p><span>如果是行级触发器，触发动作将执行1000次</span></p></li></ul><p>&nbsp;</p><p><span>[例5.21]当对表SC的Grade属性进行修改时，若分数增加了10%则将此次操作记录到下面表中：SC_U（Sno,Cno,Oldgrade,Newgrade）</span></p><p><span>其中Oldgrade是修改前的分数，Newgrade是修改后的分数。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TRIGGER</span> SC_T</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">AFTER</span> <span class="cm-keyword">UPDATE</span> OF Grade <span class="cm-keyword">ON</span> SC</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">REFERENCING</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  OLD <span class="cm-keyword">ROW</span> <span class="cm-keyword">AS</span> OldTuple<span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  NEW <span class="cm-keyword">ROW</span> <span class="cm-keyword">AS</span> NewTuple</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FOR</span> <span class="cm-keyword">EACH</span> <span class="cm-keyword">ROW</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHEN</span> <span class="cm-bracket">(</span>NewTuple<span class="cm-variable-2">.Grade</span> <span class="cm-operator">&gt;=</span> <span class="cm-number">1.1</span> <span class="cm-operator">*</span> OldTuple<span class="cm-variable-2">.Grade</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">INSERT</span> <span class="cm-keyword">INTO</span> SC_U<span class="cm-bracket">(</span>Sno<span class="cm-punctuation">,</span> Cno<span class="cm-punctuation">,</span> OldGrade<span class="cm-punctuation">,</span> NewGrade<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">VALUES</span><span class="cm-bracket">(</span>OldTuple<span class="cm-variable-2">.Sno</span><span class="cm-punctuation">,</span> OldTuple<span class="cm-variable-2">.Cno</span><span class="cm-punctuation">,</span> OldTuple<span class="cm-variable-2">.Grade</span><span class="cm-punctuation">,</span> NewTuple<span class="cm-variable-2">.Grade</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 207px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.22] 将每次对表Student的插入操作所增加的学生个数记录到表StudentInsertLog中。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TRIGGER</span> Student_Count</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">AFTER</span> <span class="cm-keyword">INSERT</span> <span class="cm-keyword">ON</span> Student</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/* 指明触发器激活的时间是在执行INSERT后 */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">REFERENCING</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  NEW <span class="cm-keyword">TABLE</span> <span class="cm-keyword">AS</span> DELTA</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FOR</span> <span class="cm-keyword">EACH</span> STATEMENT</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/* 语句级触发器，即执行完INSERT语句后下面的触发动作体才执行一次 */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">INSERT</span> <span class="cm-keyword">INTO</span> StudentInsertLog <span class="cm-bracket">(</span>Numbers<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">COUNT</span><span class="cm-bracket">(</span><span class="cm-operator">*</span><span class="cm-bracket">)</span> <span class="cm-keyword">FROM</span> DELTA<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 207px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>[例5.23] 定义一个BEFORE行级触发器，为教师表Teacher定义完整性规则“教授的工资不得低于4000元，如果低于4000元，自动改为4000元”。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TRIGGER</span> Insert_Or_Update_Sal</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">BEFORE</span> <span class="cm-keyword">INSERT</span> <span class="cm-keyword">OR</span> <span class="cm-keyword">UPDATE</span> <span class="cm-keyword">ON</span> Teacher</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/* 触发事件是插入或更新操作 */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FOR</span> <span class="cm-keyword">EACH</span> <span class="cm-keyword">ROW</span> <span class="cm-comment">/* 行级触发器 */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">BEGIN</span> <span class="cm-comment">/* 定义触发动作体，是 PL/SQL 过程块 */</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">IF</span> <span class="cm-bracket">(</span>new<span class="cm-variable-2">.Job</span> <span class="cm-operator">=</span> <span class="cm-string">'教授'</span><span class="cm-bracket">)</span> <span class="cm-keyword">AND</span> <span class="cm-bracket">(</span>new<span class="cm-variable-2">.Sal</span> <span class="cm-operator">&lt;</span> <span class="cm-number">4000</span><span class="cm-bracket">)</span> <span class="cm-keyword">THEN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  new<span class="cm-variable-2">.Sal</span> <span class="cm-punctuation">:</span><span class="cm-operator">=</span> <span class="cm-number">4000</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">END</span> <span class="cm-keyword">IF</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">END</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="height: 207px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='激活触发器'><span>激活触发器</span></h3><p><span>触发器的执行，是由触发事件激活的，并由数据库服务器自动执行</span></p><p>&nbsp;</p><p><span>一个数据表上可能定义了多个触发器，遵循如下的执行顺序：</span></p><ol start='' ><li><p><span>执行该表上的BEFORE触发器</span></p></li><li><p><span>激活触发器的SQL语句</span></p></li><li><p><span>执行该表上的AFTER触发器</span></p></li></ol><p>&nbsp;</p><h3 id='删除触发器'><span>删除触发器</span></h3><p><span>删除触发器的SQL语法：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> <span class="cm-keyword">TRIGGER</span> <span class="cm-operator">&lt;</span>触发器名<span class="cm-operator">&gt;</span> <span class="cm-keyword">ON</span> <span class="cm-operator">&lt;</span>表名<span class="cm-operator">&gt;</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>触发器必须是一个已经创建的触发器，并且只能由具有相应权限的用户删除。</span></p><p>&nbsp;</p><h2 id='小结'><span>小结</span></h2><p><span>数据库的完整性是为了保证数据库中存储的数据是正确的。</span></p><p>&nbsp;</p><p><span>关系数据库管理系统完整性实现的机制：</span></p><ol start='' ><li><p><span>完整性约束定义机制</span></p></li><li><p><span>完整性检查机制</span></p></li><li><p><span>违背完整性约束条件时关系数据库管理系统应采取的动作</span></p></li></ol><p>&nbsp;</p><h1 id='关系数据理论'><span>关系数据理论</span></h1><h2 id='问题的提出'><span>问题的提出</span></h2><p><span>回顾一下《数据库系统概论》中对二维表结构的定义</span></p><p><span>关系模式由五部分组成，即它是一个五元组：</span></p><p><span>R(U, D, DOM, F)：</span></p><ul><li><p><span>R： 关系名，即表名</span></p></li><li><p><span>U： 组成该关系的属性名集合</span></p></li><li><p><span>D： 属性组U中属性所来自的域。数据的取值范围和类型</span></p></li><li><p><span>DOM： 属性向域的映象集合</span></p></li><li><p><span>F： 属性组U上的一组数据依赖。</span></p></li></ul><p>&nbsp;</p><p><strong><span>关系数据库规范化理论研究的就是R、U、F，之间的关系。</span></strong></p><p>&nbsp;</p><p><span>因为D和DOM对研究表的设计关系不大，所以在学习关系数据库规范化理论时可以将五元组简化成三元组：</span><code>R（U, F）</code></p><p><span>当且仅当U上的一个关系</span><code>r</code><span>满足</span><code>F</code><span>时，</span><code>r</code><span>称为</span><code>关系模式 R（U, F）的一个关系</code></p><p>&nbsp;</p><p><span>作为二维表，关系要符合一个最基本的条件：每个分量必须是不可分开的数据项。满足了这个条件的关系模式就属于第一范式（1NF）</span></p><p>&nbsp;</p><p><span>规范化理论主要包括三个方面的内容：</span></p><ul><li><p><span>数据依赖：数据依赖是一个关系内部属性与属性之间的一种约束关系。这种约束关系是通过属性间值的相等与否体现出来的数据间相关联系。它是现实世界属性间相互联系的抽象，是数据内在的性质，是语义的体现。</span></p></li><li><p><span>范式（Normal Form）</span></p></li><li><p><span>模式设计</span></p></li></ul><p>&nbsp;</p><p><span>其中：</span></p><ul><li><p><span>数据依赖是一个关系内部属性与属性之间的一种约束关系。这种约束关系通过数据值的相等与否体现出数据间的相关关系。</span></p><ul><li><p><span>函数依赖（Functional Dependancy, FD）</span></p></li><li><p><span>多值依赖（Multi-Valued Depandancy, MVD）</span></p></li></ul></li><li><p><strong><span>函数依赖起着核心的作用，是模式分解和模式设计的基础，范式是模式分解的标准。</span></strong></p></li></ul><p>&nbsp;</p><p><span>函数依赖极为普遍地存在于现实生活中。比如描述一个学生的关系，可以有学号(Sno)、姓名(Sname)、系名(Sdept) 等几个属性。由于一个学号只对应一个学生，一个学生只在一个系学习。因而当“学号”值确定之后，学生的姓名及所在系的值也就被唯一地确定了。属性间的这种依赖关系类似于数学中的函数y=f(x)，自变量x确定之后，相应的函数值y也就唯一地确定了。</span></p><p>&nbsp;</p><p><span>[例6.1] 建立一个描述学校教务的数据库</span></p><p><span>涉及的对象包括：</span></p><ul><li><p><span>学生的学号（Sno）</span></p></li><li><p><span>所在系（Sdept）</span></p></li><li><p><span>系主任姓名（Mname）</span></p></li><li><p><span>课程号（Cno）</span></p></li><li><p><span>成绩（Grade）</span></p></li></ul><p>&nbsp;</p><p><span>假设学校教务的数据库模式用一个单一的关系模式Student来表示，则该关系模式的属性集合为：U ＝{Sno, Sdept, Mname, Cno, Grade} </span></p><p><span>现实世界的已知事实（语义）：</span></p><ul><li><p><span>一个系有若干学生， 但一个学生只属于一个系</span></p></li><li><p><span>一个系只有一名（正职）负责人</span></p></li><li><p><span>一个学生可以选修多门课程，每门课程有若干学生选修</span></p></li><li><p><span>每个学生学习每一门课程有一个成绩</span></p></li></ul><p>&nbsp;</p><p><span>由此可得到属性组U上的一组函数依赖F：</span></p><p><span>F={Sno- &gt; Sdept, Sdept- &gt;Mname, (Sno, Cno)- &gt;Grade}</span></p><p><img src="数据库系统概论/image-20240416155124445.png" alt="image-20240416155124445" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>这个关系模式设计的并不好，存在以下问题：</span></p><ol start='' ><li><p><span>数据冗余(Data redundancy)</span></p><ul><li><p><span>比如，每一个系的系主任姓名重复出现，重复次数与该系所有学生的所有课程成绩出现次数相同，如表6.1所示。这将浪费大量的存储空间。</span></p></li></ul></li><li><p><span>更新异常(update anomalies )</span></p><ul><li><p><span>由于数据冗余，当更新数据库中的数据时，系统要付出很大的代价来维护数据库的完整性，否则会面临数据不一致的危险。 比如，某系更换系主任后，必须修改与该系学生有关的每一个元组。</span></p></li></ul></li><li><p><span>插入异常(insertion anomalies )</span></p><ul><li><p><span>如果一个系刚成立，尚无学生，则无法把这个系及其系主任的信息存入数据库。</span></p></li></ul></li><li><p><span>删除异常( deletion anomalies)</span></p><ul><li><p><span>如果某个系的学生全部毕业了，则在删除该系学生信息的同时，这个系及其系主任的信息也丢掉了。</span></p></li></ul></li></ol><p>&nbsp;</p><p><span>鉴于存在以上种种问题，可以得出这样的结论：</span></p><ul><li><p><span>Student关系模式不是一个好的模式</span></p></li><li><p><span>“好”的模式：不会发生插入异常、删除异常、更新异常，数据冗余应尽可能少</span></p></li><li><p><span>产生关系数据库中这些异常问题的根本原因：关系模式中存在不合适的属性间联系</span></p></li><li><p><span>解决方法：通过</span><strong><span>分解</span></strong><span>关系模式来消除其中不合适的数据依赖</span>
<span>也就是说，用规范化理论改造关系模式来消除其中不合适的数据依赖</span></p></li></ul><p>&nbsp;</p><p><span>可以把这个单一模式分成3个关系模式：</span></p><ul><li><p><span>S（Sno，Sdept，Sno → Sdept）</span></p></li><li><p><span>SC（Sno，Cno，Grade，（Sno，Cno） → Grade）</span></p></li><li><p><span>DEPT（Sdept，Mname，Sdept→ Mname）</span></p></li></ul><p><span>这三个模式都不会发生插入异常、删除异常的问题，数据的冗余也得到了控制。</span></p><p>&nbsp;</p><p><span>一个好的关系模式应该具备以下四个条件：</span></p><ul><li><p><span>尽可能少的数据冗余</span></p></li><li><p><span>没有更新异常</span></p></li><li><p><span>没有插入异常</span></p></li><li><p><span>没有删除异常</span></p></li></ul><p>&nbsp;</p><p><span>产生关系数据库中这些异常问题的根本原因：关系模式中存在不合适的属性间联系</span></p><p><span>解决问题的方法：采用分解策略消去不合适联系</span></p><p>&nbsp;</p><p><span>分解后的关系模式是“好” 的。</span></p><p><span>不过，一个好的关系模式并不是在任何情况下都是最优的。</span></p><p><strong><span>关系的规范化：如何按照一定的规范设计关系模式，将结构复杂的关系分解成结构简单的关系，从而把“不好”的关系数据库模式转变为“好”的关系数据库模式。</span></strong></p><p><span>规范化又可以根据不同的要求而分成若干级别。</span></p><p><span>数据库模式的好坏和关系中各属性间的依赖关系有关，因此，我们先讨论属性间的依赖关系，然后再讨论关系规范化理论。</span></p><p>&nbsp;</p><h2 id='规范化'><span>规范化</span></h2><p><strong><span>一个模式的数据依赖会有哪些不好的性质，如何改造一个不好的模式，这就是接下来规范化要讨论的内容。</span></strong></p><p>&nbsp;</p><h3 id='规范化研究什么'><span>规范化研究什么</span></h3><ul><li><p><span>规范化讨论</span><strong><span>如何根据属性间依赖情况来判定关系是否具有某些不合适的性质</span></strong></p></li><li><p><span>通常</span><strong><span>按属性间依赖情况来区分</span></strong><span>关系</span><strong><span>规范化程度</span></strong><span>为第一范式、第二范式、第三范式和第四范式等</span></p></li><li><p><span>用来改造关系模式，通过分解关系模式来消除其中不合适的数据依赖，以解决插入异常、删除异常、更新异常和数据冗余问题。</span></p></li></ul><p>&nbsp;</p><h3 id='函数依赖'><span>函数依赖</span></h3><p><span>这里我们讨论数据依赖F中的函数依赖，分为以下几种类型：</span></p><ul><li><p><span>函数依赖</span></p></li><li><p><span>平凡函数依赖与非平凡函数依赖</span></p></li><li><p><span>完全函数依赖与部分函数依赖</span></p></li><li><p><span>传递函数依赖</span></p></li></ul><p>&nbsp;</p><h4 id='函数依赖-2'><span>函数依赖</span></h4><p><img src="数据库系统概论/image-20240416165130679.png" alt="image-20240416165130679" style="zoom: 25%;" /></p><p>&nbsp;</p><p><span>函数依赖和别的数据依赖样是语义范畴的概念，只能根据语义来确定一个函数依赖。</span></p><p><span>例如：姓名→年龄或者姓名→性别这两个函数依赖只有在该部门没有同名人的条件下成立。</span></p><p><span>如果允许有同名人，则年龄就不再函数依赖于姓名了。</span></p><p><span>函数依赖反映了一种语义完整性约束。</span></p><p>&nbsp;</p><p><img src="数据库系统概论/image-20240416165227166.png" alt="image-20240416165227166" style="zoom:33%;" /></p><p><img src="数据库系统概论/image-20240416165247679.png" alt="image-20240416165247679" style="zoom: 25%;" /></p><p><img src="数据库系统概论/image-20240416165347334.png" alt="image-20240416165347334" style="zoom: 25%;" /></p><p><img src="数据库系统概论/image-20240416165409725.png" alt="image-20240416165409725" style="zoom: 25%;" /></p><ul><li><p><strong><span>函数依赖不是指关系模式R的某个或某些关系满足的约束条件，而是指R的一切关系均要满足的约束条件。</span></strong></p></li><li><p><span>函数依赖关系的存在与时间无关。</span></p></li><li><p><span>属性间联系与函数依赖的对应关系：</span></p><ul><li><p><span>1:1联系：存在函数依赖X→Y，且 Y→X，即X←→Y</span></p></li><li><p><span>1:m联系：存在函数依赖X→Y，但不存在Y→X</span></p></li><li><p><span>m:n联系：不存在函数依赖</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>例：关系模式SCD中存在的函数依赖——属性间的联系：</span></p><ul><li><p><span>学号→姓名，学号→年龄，学号→所在系，1:m</span></p></li><li><p><span>所在系→系主任，1:1</span></p></li><li><p><span>(学号，课程号) →成绩, 学号和课程之间 m:n</span></p></li></ul><p>&nbsp;</p><h4 id='平凡函数依赖与非平凡函数依赖'><span>平凡函数依赖与非平凡函数依赖</span></h4><p><span>如果X→Y，但Y⊈X，则称X→Y是非平凡的函数依赖。</span></p><p><span>如果X→Y，但Y⊆X，则称X→Y是平凡的函数依赖。</span></p><p>&nbsp;</p><p><span>对于任一关系模式，平凡函数依赖都是必然成立的，它不反映新的语义。</span></p><p><span>若不特别声明， 我们总是讨论非平凡函数依赖。</span></p><p>&nbsp;</p><p><img src="数据库系统概论/image-20240416165901846.png" alt="image-20240416165901846" style="zoom: 25%;" /></p><p>&nbsp;</p><p><img src="数据库系统概论/image-20240416170206245.png" alt="image-20240416170206245" style="zoom: 25%;" /></p><p>&nbsp;</p><h4 id='完全函数依赖与部分函数依赖'><span>完全函数依赖与部分函数依赖</span></h4><p><img src="数据库系统概论/image-20240416170345893.png" alt="image-20240416170345893" style="zoom:25%;" /></p><p><img src="数据库系统概论/image-20240416170439524.png" alt="image-20240416170439524" style="zoom:25%;" /></p><p>&nbsp;</p><h4 id='传递函数依赖'><span>传递函数依赖</span></h4><p><img src="数据库系统概论/image-20240416170548083.png" alt="image-20240416170548083" style="zoom:25%;" /></p><p><strong><span>注: 如果Y→X, 即X←→Y，则Z直接依赖于X，而不是传递函数依赖。</span></strong></p><p>&nbsp;</p><p><span>[例] 在关系Std(Sno, Sdept, Mname)中，有：Sno → Sdept，Sdept → Mname</span></p><p><span>故Mname传递函数依赖于Sno</span></p><p>&nbsp;</p><p><span>举例说明直接依赖：</span></p><p><span>BH(sno,idCard,address)</span></p><ul><li><p><span>X：sno 学号</span></p></li><li><p><span>Y：idCard 身份证号</span></p></li><li><p><span>Z：address 住址</span></p></li></ul><p><span>X-&gt;Y，Y-&gt;X，X&lt;-&gt;Y，Y-&gt;Z</span></p><p><span>所以我们说Z直接依赖于X</span></p><p>&nbsp;</p><h3 id='码-2'><span>码</span></h3><h4 id='定义-4'><span>定义</span></h4><p><span>之前已经提到了有关码的若干定义， 这里用函数依赖的概念来定义码。</span></p><p><img src="数据库系统概论/image-20240416173447818.png" alt="image-20240416173447818" style="zoom:25%;" /></p><p><span>若关系模式R有多个候选码，则选定其中的一个做为主码(Primary key)。</span></p><p>&nbsp;</p><h4 id='主属性与非主属性'><span>主属性与非主属性</span></h4><p><span>包含在任何一个候选码中的属性 ，称为主属性（Prime attribute）</span></p><p><span>不包含在任何码中的属性称为非主属性（Nonprime attribute）或非码属性（Non-key attribute）</span></p><p>&nbsp;</p><p><span>全码：整个属性组是码，称为全码（All-key）</span></p><p>&nbsp;</p><p><span>[例2]</span></p><p><span>关系模式S（Sno,Sdept,Sage），单个属性Sno是码</span></p><p><span>SC（Sno，Cno，Grade）中，（Sno，Cno）是码</span></p><p>&nbsp;</p><p><span>[例3]</span></p><p><span>关系模式R（P，W，A）</span></p><p><span>P：演奏者 W：作品 A：听众</span></p><p><span>一个演奏者可以演奏多个作品，某一作品可被多个演奏者演奏，听众可以欣赏不同演奏者的不同作品</span></p><p><span>码为(P，W，A)，即All-Key</span></p><p>&nbsp;</p><h4 id='外部码'><span>外部码</span></h4><p><span>定义6.5 关系模式 R 中属性或属性组 X 并非 R 的码，但 X 是另一个关系模式的码，则称 X 是 R 的外部码（Foreign key）也称外码。</span></p><ul><li><p><span>SC(Sno,Cno,Grade)中，Sno不是码</span></p></li><li><p><span>Sno是S(Sno,Sdept,Sage)的码，则Sno是SC的外码</span></p></li></ul><p>&nbsp;</p><p><span>主码与外部码一起提供了表示关系间联系的手段。</span></p><p>&nbsp;</p><h3 id='范式'><span>范式</span></h3><p><span>范式是符合某一种级别的关系模式的集合。</span></p><p><span>关系数据库中的关系必须满足一定的要求。满足不同程度要求的为不同的范式。</span></p><p><span>级别越高，表设计的越合理</span></p><p>&nbsp;</p><p><span>范式的种类：</span></p><ul><li><p><span>第一范式(1NF)</span></p></li><li><p><span>第二范式(2NF)</span></p></li><li><p><span>第三范式(3NF)</span></p></li><li><p><span>BC范式(BCNF)</span></p></li><li><p><span>第四范式(4NF)</span></p></li><li><p><span>第五范式(5NF)</span></p></li></ul><p>&nbsp;</p><p><span>各种范式之间存在联系：</span></p><p><span>1NF ⊂ 2NF ⊂ 3NF ⊂ BCNF ⊂ 4NF ⊂ 5NF</span></p><p>&nbsp;</p><p><span>某一关系模式R为第n范式，可简记为R∈nNF。</span></p><p>&nbsp;</p><p><span>一个低一级范式的关系模式，通过模式分解可以转换为若干个高一级范式的关系模式的集合，这种过程就叫规范化</span></p><p>&nbsp;</p><h4 id='1nf'><span>1NF</span></h4><p><span>如果一个关系模式R的所有属性都是不可分的基本数据项，则R∈1NF</span></p><p><span>第一范式是对关系模式的最起码的要求。不满足第一范式的数据库模式不能称为关系数据库</span></p><p>&nbsp;</p><p><span>例如：以下关系是一个非规范化的关系</span></p><p><img src="数据库系统概论/image-20240416223908665.png" alt="image-20240416223908665" style="zoom: 50%;" /></p><p><img src="数据库系统概论/image-20240416223923174.png" alt="image-20240416223923174" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>但是满足第一范式的关系模式并不一定是一个好的关系模式。</span></p><p>&nbsp;</p><p><span>以下是一个满足1NF，但不是好的关系模式的例子：</span></p><p><span>关系模式 S-L-C(Sno, Sdept, Sloc, Cno, Grade)，Sloc为学生住处，假设每个系的学生住在同一个地方</span></p><p><span>这个例子中存在函数依赖，不是一个好的关系模式。</span></p><p><img src="数据库系统概论/image-20240416224005656.png" alt="image-20240416224005656" style="zoom:50%;" /></p><p><span>图形化表示：</span></p><p><img src="数据库系统概论/image-20240416224147726.png" alt="image-20240416224147726" style="zoom:50%;" /></p><p><strong><span>非主属性Sdept和Sloc部分所数依赖于码(Sno，Cno)</span></strong></p><p>&nbsp;</p><p><span>S-L-C不是一个好的关系模式，一个关系模式 R不属于2NF,就会产生以下几个问题：</span></p><ul><li><p><span>插入异常。假若要插入一个学生Sno=S7， Sdept =PHY， Sloc =BLD2， 但该生还未选课，即这个学生无Cno,这样的元组就插不进S-L-C中。因为插入元组时必须给定码值，而这时码值的一部分 为空，因而学生的固有信息无法插入。</span></p></li><li><p><span>删除异常。假定某个学生只选一门课，如S4就选了一门课C3，现在C3这门课他也不选了，那么C3这个数据项就要删除。而C3是主属性，删除了C3，整个元组就必须一起删除，使得S4的其他信息也被删除了，从而造成删除异常，即不应删除的信息也删除了。</span></p></li><li><p><span>修改复杂。某个学生从数学系(MA)转到计算机科学系(CS)，这本来只需修改此学生元组中的Sdept分量即可，但因为关系模式S-L-C中还含有系的住处Sloc属性，学生转系将同时改变住处，因而还必须修改元组中的Sloc分量。另外，如果这个学生选修了k门课，Sdept、 Sloc重复存储了k次，不仅存储冗余度大，而且必须无遗漏地修改k个元组中全部Sdept、Sloc 信息，造成修改的复杂化。</span></p></li></ul><p><strong><span>为什么会有这些问题呢？</span></strong></p><p><span>原因：Sdept、 Sloc部分函数依赖于码。</span></p><p><span>解决方法(也就是将1NF变成2NF的处理方法)：规范化（投影分解），也就是消除非主属性码对码的部分函数依赖</span></p><ul><li><p><span>用投影分解把关系模式S-L-C分解成两个关系模式，以消除这些部分函数依赖</span></p></li><li><p><span>SC（Sno， Cno， Grade）</span></p></li><li><p><span>S-L（Sno， Sdept， Sloc）</span></p></li></ul><p>&nbsp;</p><p><span>修改之后的图形化表示：</span></p><p><img src="数据库系统概论/image-20240416224212194.png" alt="image-20240416224212194" style="zoom:50%;" /></p><p><span>关系模式SC的码为(Sno，Cno)</span></p><p><span>关系模式S-L的码为Sno</span></p><p><span>这样非主属性的码都是完全函数依赖</span></p><p>&nbsp;</p><p><span>此时，该关系模式属于2NF。</span></p><p>&nbsp;</p><h4 id='2nf'><span>2NF</span></h4><p><span>若关系模式R∈1NF，并且每一个非主属性都完全函数依赖于任何一个候选码，则R∈2NF。</span></p><p>&nbsp;</p><p><strong><span>推论：若R∈1NF，并且其候选码为单个属性，则R∈2NF</span></strong></p><p><span>why？</span></p><p><span>because：一定是完全函数依赖，以为候选码只有一个属性。</span></p><p>&nbsp;</p><p><span>2NF依然存在一些问题：</span></p><p><img src="数据库系统概论/image-20240416224951134.png" alt="image-20240416224951134" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='3nf'><span>3NF</span></h4><p><img src="数据库系统概论/image-20240416225047948.png" alt="image-20240416225047948" style="zoom:50%;" /></p><p><span>简单一点说就是：没有任何非主属性对码传递依赖或部分依赖</span></p><p>&nbsp;</p><p><span>在该图中：</span></p><p><img src="数据库系统概论/image-20240416224212194.png" alt="image-20240416224212194" style="zoom:50%;" /></p><p><img src="数据库系统概论/image-20240416225237674.png" alt="image-20240416225237674" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>一个证明过程：（不用仔细探究，不是重点）</span></p><p><img src="数据库系统概论/image-20240416225311461.png" alt="image-20240416225311461" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>以2NF关系模式SD为例，说明3NF规范化的过程</span></p><p><span>SD(学号, 姓名, 年龄, 所在系, 系主任)</span></p><p><span>分析SD的属性，可以发现关系SD实际上描述了两个实体：</span></p><ul><li><p><span>一个为学生实体，属性有学号，姓名，年龄，所在系</span></p></li><li><p><span>一个是系的实体，其属性有系名和系主任</span></p></li></ul><p><span>可以将SD分解成如下两个关系：</span></p><ul><li><p><span>S(学号,姓名,年龄,所在系)，描述学生实体</span></p></li><li><p><span>D(系名, 系主任)，描述系的实体</span></p></li></ul><p><span>分解后的两个关系S和D，码分别为学号和系名，不存在非主属性对码的传递函数依赖。因此，S∈3NF，D∈3NF</span></p><p>&nbsp;</p><p><span>分解为3NF后：</span></p><ul><li><p><span>数据冗余降低</span></p></li><li><p><span>不存在插入异常、不存在删除异常、不存在更新异常</span></p></li></ul><p>&nbsp;</p><p><strong><span>推论1: 若R∈2NF，且至多存在一个非主属性，则R∈3NF</span></strong></p><p><strong><span>推论2: 任何二元关系模式R(A,B)必为3NF</span></strong></p><p>&nbsp;</p><p><span>说明：</span></p><ol start='' ><li><p><span>部分FD和传递FD是冗余及操作异常的重要根源</span></p></li><li><p><span>3NF不存在非主属性对候选码的部分FD和传递FD</span></p></li><li><p><span>3NF消去了大部分冗余及操作异常</span></p></li><li><p><span>但并非所有的3NF都能完全消除冗余及操作异常</span></p></li></ol><p>&nbsp;</p><p><span>3NF-练习</span></p><p><span>试证明，若关系模式R是二元关系，则R∈3NF</span></p><p><img src="数据库系统概论/image-20240417134447611.png" alt="image-20240417134447611" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='bcnf'><span>BCNF</span></h4><p><span>BCNF ( Boyce Codd Normal Form)是由Boyce与Codd提出的，比上述的3NF又进了一步，通常认为BCNF是修正的第三范式，有时也称为扩充的第三范式。</span></p><p>&nbsp;</p><p><img src="数据库系统概论/image-20240417134945205.png" alt="image-20240417134945205" style="zoom:50%;" /></p><p><img src="数据库系统概论/image-20240417135059031.png" alt="image-20240417135059031" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>BCNF的关系模式所具有的性质：</span></p><ul><li><p><span>所有非主属性都完全函数依赖于每个候选码</span></p></li><li><p><span>所有主属性都完全函数依赖于每个不包含它的候选码</span></p></li><li><p><span>没有任何属性完全函数依赖于非码的任何一组属性</span></p></li></ul><p>&nbsp;</p><p><span>如果一个关系数据库中的所有关系模式都属于BCNF，不存在任何属性对码的传递依赖和部分依赖。那么在函数依赖范畴内，它已实现了模式的彻底分解，达到了最高的规范化程度，消除了插入异常和删除异常。</span></p><p>&nbsp;</p><p><strong><span>下面用几个例子说明属于3NF的关系模式有的属于BCNF，但有的不属于BCNF。</span></strong></p><p>&nbsp;</p><p><span>[例5] 关系模式C（Cno，Cname，Pcno）</span>
<span>C∈3NF</span>
<span>C∈BCNF</span></p><p><span>关系模式C(Cno, Cname, Peno)， 它只有一个码Cno, 这里没有任何属性对Cno部分依赖或传递依赖，所以C∈3NF。同时C中Cno是唯一的决定因素， 所以C ∈BCNF。</span></p><p>&nbsp;</p><p><span>[例6] 关系模式S(Sno, Sname, Sdept, Sage)</span>
<span>假定S有两个码Sno，Sname</span>
<span>S∈3NF</span>
<span>S∈BCNF</span></p><p><span>假定Sname也具有唯一性， 那么S就有两个码，这两个码都由单个属性组成，彼此不相交。其他属性不存在对码的传递依赖与部分依赖，所以S∈3NF。</span>
<span>同时S中除Sno、Sname外没有其他决定因素，所以S也属于BCNF。</span></p><blockquote><p><span>这里可以复习一下传递依赖的概念：</span></p><p><img src="数据库系统概论/image-20240416170548083.png" alt="image-20240416170548083" style="zoom:25%;" /></p><p><span>注: 如果Y→X, 即X←→Y，则Z直接依赖于X，而不是传递函数依赖。</span></p></blockquote><p>&nbsp;</p><p><span>[例7] 关系模式SJP（S，J，P）</span>
<span>SJP∈3NF，</span>
<span>SJP∈BCNF</span></p><p><span>关系模式SJP(S, J, P)中，S是学生，J表示课程，P表示名次。</span>
<span>每一个学生选修每门课程的成绩有一定的名次，</span>
<span>每门课程中每一名次只有一个学生(即没有并列名次)。</span>
<span>由语义可得到下面的函数依赖:</span>
<span>(S,J)→P; (J,P)→S</span>
<strong><span>所以(S,J) 与(J,P)都可以作为候选码</span></strong>
<span>这两个码各由两个属性组成，而且它们是相交的。</span>
<span>这个关系模式中显然没有属性对码传递依赖或部分依赖。</span>
<span>所以SJP∈3NF，而且</span><strong><span>除(S,J)与(J,P)以外没有其他决定因素</span></strong><span>，所以SJP∈BCNF。</span></p><blockquote><p><span>BCNF定义等价于：每一个决定属性因素都包含码</span></p></blockquote><p>&nbsp;</p><p><span>[例8] 关系模式STJ(S, T, J)中，S表示学生，T表示教师，J表示课程。</span></p><p><span>每一教师只教一门课，</span>
<span>每门课有若干教师，</span>
<span>某一学生选定某门课， 就对应一个固定的教师。</span>
<span>由语义可得到如下的函数依赖。</span>
<span>(S,J)→T，(S,T)-J, T→J</span>
<span>STJ中的函数依赖关系可以用下图表示：</span></p><p><img src="数据库系统概论/image-20240417140451234.png" alt="image-20240417140451234" style="zoom:50%;" /></p><p><span>这里(S,J)、 (S,T)都是候选码。</span>
<span>STJ是3NF,因为没有任何非主属性对码传递依赖或部分依赖，</span>
<span>但STJ不是BCNF关系，因为T是决定因素，而T不包含码。</span></p><blockquote><p><span>复习一下BCNF的定义：</span></p><p><img src="数据库系统概论/image-20240417134945205.png" alt="image-20240417134945205" style="zoom:50%;" /></p></blockquote><p>&nbsp;</p><blockquote><p><span>智谱清言给出的关于决定因素的定义：</span></p><p><span>在关系数据理论中，决定因素（Determinant）通常是指在关系数据库中，能够唯一确定一个元组（即表中一行数据）的一组属性。具体来说，假设有一个关系模式R，它有属性集A，如果存在一个子集X属于A，那么X就是R的一个候选键（Candidate Key），如果X是最小的这样的子集（即X的真子集都不能成为候选键），那么X就是R的一个决定因素。</span>
<span>简单来说，决定因素是那些能够唯一标识表中每一行的属性组合。在数据库设计和规范化过程中，确定决定因素对于保证数据的完整性和一致性是非常重要的。</span></p></blockquote><p>&nbsp;</p><p><span>如何解决才能让STJ是BCNF关系呢？</span></p><p><img src="数据库系统概论/image-20240417150751112.png" alt="image-20240417150751112" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='3nf与bcnf的关系'><span>3NF与BCNF的关系</span></h4><p><img src="数据库系统概论/image-20240417150855974.png" alt="image-20240417150855974" style="zoom:50%;" /></p><p>&nbsp;</p><ul><li><p><span>对于不是BCNF的关系模式，仍然存在不合适的地方</span></p></li><li><p><span>非BCNF的关系模式也可以通过分解成为BCNF。例如STJ可分解为ST(S,T)与TJ(T,J)，它们都是BCNF</span></p></li><li><p><span>3NF和BCNF是在函数依赖的条件下对模式分解所能达到的分离程度的测度</span></p></li><li><p><span>一个模式中的关系模式如果都属于BCNF，那么在函数依赖范畴内，它已实现了彻底的分离，已消除了插入和删除的异常</span></p></li><li><p><span>3NF的“不彻底”性表现在可能存在主属性对码的部分依赖和传递依赖</span></p></li></ul><p>&nbsp;</p><h3 id='多值依赖'><span>多值依赖</span></h3><p><span>例[6.9]设学校中某一门课程由多个教师讲授，他们使用相同的一套参考书。每个教师可以讲授多门课程，每种参考书可以供多门课程使用</span></p><p><span>可以用一个非规范化的关系来表示教师T、课程C和参考书B之间的关系：</span></p><p><img src="数据库系统概论/image-20240417151202810.png" alt="image-20240417151202810" style="zoom:67%;" /></p><p><span>规范化的二维表Teaching：</span></p><p><img src="数据库系统概论/image-20240417151225417.png" alt="image-20240417151225417" style="zoom: 67%;" /></p><p><span>Teaching具有唯一候选码(C,T,B)， 即全码</span></p><p><span>Teaching∈BCNF</span></p><p><span>但是当某一课程(如物理)增加一名讲课教师(如周英)时，必须插入多个(这里是三个)元组：(物理，周英，普通物理学)，(物理，周英，光学原理)，(物理，周英，物理习题集)。</span></p><p><span>同样，某一门课(如数学)要去掉一本参考书(如微分方程)，则必须删除多个(这里是两个)元组：(数学，李勇，微分方程)，(数学，张平，微分方程)。</span></p><p><span>可以看出对数据的增删改很不方便，数据的冗余也十分明显。</span></p><p><span>仔细考察这类关系模式，发现它具有一种称之为多值依赖(Multi-Valued Dependency, MVD)的数据依赖。</span></p><p>&nbsp;</p><h4 id='定义-5'><span>定义</span></h4><p><img src="数据库系统概论/image-20240417152112268.png" alt="image-20240417152112268" style="zoom:50%;" /></p><blockquote><p><span>自己总结就是：一个X对应多个Y</span></p></blockquote><p>&nbsp;</p><p><span>例 Teaching（C, T, B）</span></p><p><span>对于C的每一个值，T有一组值与之对应，而不论B取何值。因此T多值依赖于C，即C→→T</span></p><p><span>例如，在关系模式Teaching中，对于一个(物理，光学原理)有一组T值{李勇，王军}，这组值仅仅决定于课程C上的值(物理)。</span>
<span>也就是说对于另一个(物理，普通物理学)，它对应的一组T值仍是{李勇，王军}，尽管这时参考书B的值已经改变了。</span>
<span>因此T多值依赖于C，即C→→T。</span></p><p><img src="数据库系统概论/image-20240417152256160.png" alt="image-20240417152256160" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>多值依赖的另一个等价的定义：</span></p><p><span>在R(U)的任一关系r中，如果存在元组t，s使得t[X]=s[X]，那么就必然存在元组w，v∈r，（w，v可以与s，t相同）, 使得w[X]=v[X]=t[X]，而w[Y]=t[Y]，w[Z]=s[Z]，v[Y]=s[Y]，v[Z]=t[Z]（即交换s，t元组的Y值所得的两个新元组必在r中则Y多值依赖于X，记为X→→Y。这里X，Y是U的子集，Z=U-X-Y。</span></p><p>&nbsp;</p><h4 id='平凡多值依赖和非平凡的多值依赖'><span>平凡多值依赖和非平凡的多值依赖</span></h4><p><span>若X→→Y，而Z＝Ф，即Z为空，则称X→→Y为平凡的多值依赖。</span></p><p><span>否则称X→→Y为非平凡的多值依赖。</span></p><p>&nbsp;</p><p><span>[例6.10]关系模式WSC(W,S,C)中，W表示仓库，S 表示保管员，C 表示商品。假设每个仓库有若干个保管员，有若干种商品。每个保管员保管所在仓库的所有商品，每种商品被所有保管员保管</span></p><p><img src="数据库系统概论/image-20240417163642285.png" alt="image-20240417163642285" style="zoom: 33%;" /></p><p><span>按照语义对于W的每一个值W</span><sub><span>i</span></sub><span>，S有一个完整的集合与之对应而不问C取何值。所以W→→S。</span></p><p><span>对应W的某一个值W</span><sub><span>i</span></sub><span>的全部S值记作{S}</span><sub><span>Wi</span></sub><span>（表示此仓库工作的全部保管员）</span></p><p><span>全部C值记作{C}</span><sub><span>Wi</span></sub><span>（表示在此仓库中存放的所有商品）</span></p><p><span>应当有{S}</span><sub><span>Wi</span></sub><span>中的每一个值和{C}</span><sub><span>Wi</span></sub><span>中的每一个C值对应</span></p><p><span>于是{S}</span><sub><span>Wi</span></sub><span>与{C}</span><sub><span>Wi</span></sub><span>之间正好形成一个完全二分图，因而W→→S</span></p><p>&nbsp;</p><p><span>由于C与S的完全对称性，必然有W→→C成立</span></p><p><img src="数据库系统概论/image-20240417164000049.png" alt="image-20240417164000049" style="zoom: 33%;" /></p><p>&nbsp;</p><h4 id='性质'><span>性质</span></h4><p><span>性质1</span></p><p><span>多值依赖具有对称性。</span></p><p><span>即若X→→Y，则X→→Z，其中Z＝U－X－Y</span></p><p><span>多值依赖的对称性可以用完全二分图直观地表示出来</span></p><p><span>从[例6.10] 容易看出，因为每个保管员保管所有商品，同时每种商品被所有保管员保管，显然若W→→S，必然有W→→C</span></p><p><span>性质2</span></p><p><span>多值依赖具有传递性。即若X→→Y，Y→→Z， 则 X→→Z - Y</span></p><p><span>性质3</span></p><p><span>函数依赖是多值依赖的特殊情况。即若X→Y，则 X→→Y</span></p><p><span>性质4</span></p><p><span>若X→→Y，X→→Z，则X→→YZ</span></p><p><span>性质5</span></p><p><span>若X→→Y，X→→Z，则X→→Y∩Z</span></p><p><span>性质6</span></p><p><span>若X→→Y，X→→Z，则X→→Y-Z，X→→Z - Y</span></p><p>&nbsp;</p><h4 id='多值依赖与函数依赖的区别'><span>多值依赖与函数依赖的区别</span></h4><p><span>多值依赖的有效性与属性集的范围有关</span></p><p>&nbsp;</p><h4 id='4nf'><span>4NF</span></h4><p><img src="数据库系统概论/image-20240417153927891.png" alt="image-20240417153927891" style="zoom:50%;" /></p><p><span>4NF就是限制关系模式的属性之间不允许有非平凡且非函数依赖的多值依赖。</span></p><p><span>4NF所允许的非平凡多值依赖实际上是函数依赖。</span></p><p>&nbsp;</p><h2 id='数据依赖的公理系统'><span>数据依赖的公理系统</span></h2><h2 id='模式的分解'><span>*模式的分解</span></h2><h2 id='小结-2'><span>小结</span></h2><p>&nbsp;</p><p><img src="数据库系统概论/image-20240417164658813.png" alt="image-20240417164658813" style="zoom: 33%;" /></p><p>&nbsp;</p><h1 id='数据库设计'><span>数据库设计</span></h1><h2 id='数据库设计概述'><span>数据库设计概述</span></h2><p><span>数据库设计是指对于一个给定的应用环境，构造（设计）优化的数据库逻辑模式和物理结构，并据此建立数据库及其应用系统，使之能够有效地存储和管理数据，满足各种用户的应用需求，包括信息管理要求和数据操作要求。</span></p><p>&nbsp;</p><p><span>信息管理要求：在数据库中应该存储和管理哪些数据对象 。</span></p><p><span>数据操作要求：对数据对象需要进行哪些操作，如查询、增、删、改、统计等操作。</span></p><p>&nbsp;</p><p><span>数据库设计的目标是为用户和各种应用系统提供一个信息基础设施和高效率的运行环境</span></p><p>&nbsp;</p><p><span>高效率的运行环境：</span></p><ul><li><p><span>数据库数据的存取效率高</span></p></li><li><p><span>数据库存储空间的利用率高</span></p></li><li><p><span>数据库系统运行管理的效率高</span></p></li></ul><p>&nbsp;</p><h3 id='数据库设计的特点'><span>数据库设计的特点</span></h3><p><span>数据库建设的基本规律：</span></p><p><span>三分技术，七分管理，十二分基础数据</span></p><p><span>管理：</span></p><ul><li><p><span>数据库建设项目管理</span></p></li><li><p><span>企业（即应用部门）的业务管理</span></p></li></ul><p><span>基础数据：数据的收集、整理、组织和不断更新</span></p><p>&nbsp;</p><p><span>结构（数据）设计和行为（处理）设计相结合：将数据库结构设计和数据处理设计密切结合</span></p><p><span>结构和行为分离的设计</span></p><p><span>传统的软件工程：重行为设计</span></p><ul><li><p><span>忽视对应用中数据语义的分析和抽象，只要有可能就尽量推迟数据结构设计的决策</span></p></li></ul><p><span>早期的数据库设计：重结构设计</span></p><ul><li><p><span>致力于数据模型和数据库建模方法研究，忽视了行为设计对结构设计的影响</span></p></li></ul><p>&nbsp;</p><p><span>结构和行为分离的设计如下图所示：</span></p><p><img src="数据库系统概论/image-20240422145445938.png" alt="image-20240422145445938" style="zoom: 67%;" /></p><p>&nbsp;</p><h3 id='数据库设计方法'><span>数据库设计方法</span></h3><p><span>大型数据库设计是涉及多学科的综合性技术，又是一项庞大的工程项目。</span></p><p><span>它要求多方面的知识和技术。主要包括：</span></p><ul><li><p><span>计算机的基础知识</span></p></li><li><p><span>软件工程的原理和方法</span></p></li><li><p><span>程序设计的方法和技巧</span></p></li><li><p><span>数据库的基本知识</span></p></li><li><p><span>数据库设计技术</span></p></li><li><p><span>应用领域的知识</span></p></li></ul><p>&nbsp;</p><p><strong><span>手工试凑法</span></strong></p><ul><li><p><span>设计质量与设计人员的经验和水平有直接关系</span></p></li><li><p><span>缺乏科学理论和工程方法的支持，工程的质量难以保证</span></p></li><li><p><span>数据库运行一段时间后常常又不同程度地发现各种问题，增加了维护代价</span></p></li></ul><p>&nbsp;</p><p><strong><span>规范设计法</span></strong></p><p><span>基本思想：过程迭代和逐步求精</span></p><p><span>典型方法：</span></p><ol start='' ><li><p><span>新奥尔良（New Orleans）方法(需求分析，概念设计，逻辑设计，物理设计)</span></p></li><li><p><span>基于E-R模型的数据库设计方法</span></p></li><li><p><span>3NF（第三范式）的设计方法</span></p></li><li><p><span>面向对象的数据库设计方法</span></p></li><li><p><span>统一建模语言（UML）方法</span></p></li></ol><p>&nbsp;</p><h3 id='数据库设计的基本步骤'><span>数据库设计的基本步骤</span></h3><p><span>数据库设计分6个阶段：</span></p><ol start='' ><li><p><span>需求分析</span></p></li><li><p><span>概念结构设计</span></p></li><li><p><span>逻辑结构设计</span></p></li><li><p><span>物理结构设计</span></p></li><li><p><span>数据库实施</span></p></li><li><p><span>数据库运行和维护</span></p></li></ol><p><span>需求分析和概念设计独立于任何数据库管理系统</span></p><p><span>逻辑设计和物理设计与选用的数据库管理系统密切相关</span></p><p><img src="数据库系统概论/image-20240422145824565.png" referrerpolicy="no-referrer" alt="image-20240422145824565"></p><p>&nbsp;</p><p><span>参加数据库设计的人员：</span></p><ul><li><p><span>系统分析人员和数据库设计人员</span></p><ul><li><p><span>自始至终参与数据库设计，其水平决定了数据库系统的质量</span></p></li></ul></li><li><p><span>数据库管理员和用户代表</span></p><ul><li><p><span>主要参加需求分析与数据库的运行和维护</span></p></li></ul></li><li><p><span>应用开发人员</span></p><ul><li><p><span>包括程序员和操作员</span></p></li><li><p><span>在实施阶段参与进来，分别负责编制程序和准备软硬件环境</span></p></li></ul></li></ul><p>&nbsp;</p><ol start='' ><li><p><span>需求分析：是否做得充分与准确，决定了构建数据库的速度和质量</span></p></li><li><p><span>概念结构设计：通过对用户需求进行综合、归纳与抽象，形成一个独立于具体数据库管理系统的概念模型（E-R图）</span></p></li><li><p><span>逻辑结构设计：将概念结构转换为某个数据库管理系统所支持的数据模型，并对其进行优化</span></p></li><li><p><span>物理结构设计：</span></p><ul><li><p><span>为逻辑数据结构选取一个最适合应用环境的物理结构</span></p></li><li><p><span>包括存储结构和存取方法</span></p></li></ul></li><li><p><span>数据库实施：</span></p><ul><li><p><span>根据逻辑设计和物理设计的结果构建数据库</span></p></li><li><p><span>编写与调试应用程序</span></p></li><li><p><span>组织数据入库并进行试运行</span></p></li></ul></li><li><p><span>数据库运行和维护</span></p><ul><li><p><span>经过试运行后即可投入正式运行</span></p></li><li><p><span>在运行过程中必须不断对其进行评估、调整与修改</span></p></li></ul></li></ol><p>&nbsp;</p><p><span>设计一个完善的数据库应用系统往往是上述6个阶段的不断反复</span></p><p><span>这个设计步骤既是数据库设计的过程，也包括了数据库应用系统的设计过程</span></p><p><span>把数据库的设计和对数据库中数据处理的设计紧密结合起来，将这两个方面的需求分析、抽象、设计、实现在各个阶段同时进行，相互参照，相互补充，以完善两方面的设计</span></p><p>&nbsp;</p><p><span>数据库设计各个阶段的数据设计描述如下图所示：</span></p><p><img src="数据库系统概论/image-20240422150147796.png" referrerpolicy="no-referrer" alt="image-20240422150147796"></p><p>&nbsp;</p><h3 id='数据库设计过程中的各级模式'><span>数据库设计过程中的各级模式</span></h3><p><span>数据库的各级模式如下图所示：</span></p><p><img src="数据库系统概论/image-20240422150218334.png" alt="image-20240422150218334" style="zoom:67%;" /></p><p>&nbsp;</p><h2 id='需求分析'><span>需求分析</span></h2><p><span>需求分析就是分析用户的要求。</span></p><ul><li><p><span>是设计数据库的起点</span></p></li><li><p><span>结果是否准确地反映了用户的实际要求，将直接影响到后面各个阶段的设计，并影响到设计结果是否合理和实用</span></p></li></ul><p>&nbsp;</p><h3 id='需求分析的任务'><span>需求分析的任务</span></h3><ul><li><p><span>详细调查现实世界要处理的对象（组织、部门、企业等）</span></p></li><li><p><span>充分了解原系统（手工系统或计算机系统）工作概况</span></p></li><li><p><span>明确用户的各种需求</span></p></li><li><p><span>在此基础上确定新系统的功能</span></p></li><li><p><span>新系统必须充分考虑今后可能的扩充和改变</span></p></li></ul><p>&nbsp;</p><p><span>调查的重点是“数据”和“处理”，获得用户对数据库的要求：</span></p><ul><li><p><span>信息要求</span></p><ul><li><p><span>用户需要从数据库中获得信息的内容与性质</span></p></li><li><p><span>由信息要求可以导出数据要求，即在数据库中需要存储哪些数据</span></p></li></ul></li><li><p><span>处理要求</span></p><ul><li><p><span>用户要完成的处理功能</span></p></li><li><p><span>对处理性能的要求</span></p></li></ul></li><li><p><span>安全性和完整性要求</span></p></li></ul><p>&nbsp;</p><p><span>确定用户最终需求的难点：</span></p><ul><li><p><span>用户缺少计算机知识，不能准确地表达自己的需求，他们所提出的需求往往不断地变化</span></p></li><li><p><span>设计人员缺少用户的专业知识，不易理解用户的真正需求，甚至误解用户的需求</span></p></li></ul><p><span>解决方法：</span></p><ul><li><p><span>设计人员必须不断深入地与用户进行交流，才能逐步确定用户的实际需求</span></p></li></ul><p>&nbsp;</p><h3 id='需求分析的方法'><span>需求分析的方法</span></h3><p><span>调查清楚用户的实际需求并进行初步分析</span></p><p><span>与用户达成共识</span></p><p><span>分析与表达这些需求</span></p><p>&nbsp;</p><p><span>调查用户需求的步骤：</span></p><ol start='' ><li><p><span>调查组织机构情况</span></p></li><li><p><span>调查各部门的业务活动情况</span></p></li><li><p><span>协助用户明确对新系统的各种要求，包括信息要求、处理要求、完全性与完整性要求</span></p></li><li><p><span>确定新系统的边界</span></p></li></ol><p>&nbsp;</p><p><span>常用调查方法：</span></p><ul><li><p><span>跟班作业</span></p></li><li><p><span>开调查会</span></p></li><li><p><span>请专人介绍</span></p></li><li><p><span>询问</span></p></li><li><p><span>设计调查表请用户填写</span></p></li><li><p><span>查阅记录</span></p></li></ul><p>&nbsp;</p><p><span>进一步分析和表达用户需求：</span></p><ul><li><p><span>分析方法：结构化分析方法（Structured Analysis，简称SA方法）</span></p><ul><li><p><span>SA方法从最上层的系统组织机构入手</span></p></li><li><p><span>采用自顶向下、逐层分解的方式分析系统</span></p></li></ul></li><li><p><span>对用户需求进行分析与表达后，需求分析报告必须提交给用户，征得用户的认可</span></p></li></ul><p>&nbsp;</p><h3 id='数据字典'><span>数据字典</span></h3><p><span>数据字典是关于数据流图中数据的描述，不是数据本身（和元数据是有区别的）</span></p><p><span>数据字典在需求分析阶段建立，在数据库设计过程中不断修改、充实、完善</span></p><p><span>数据字典是进行详细的数据收集和数据分析所获得的主要结果</span></p><p><span>例如：银行存折的数据字典</span></p><p>&nbsp;</p><p><span>数据字典的内容：</span></p><ul><li><p><span>数据项</span></p></li><li><p><span>数据结构</span></p></li><li><p><span>数据流</span></p></li><li><p><span>数据存储</span></p></li><li><p><span>处理过程</span></p></li></ul><p>&nbsp;</p><p><span>数据项是数据的最小组成单位</span></p><p><span>若干个数据项可以组成一个数据结构</span></p><p><span>数据字典通过对数据项和数据结构的定义来描述数据流、数据存储的逻辑内容</span></p><p>&nbsp;</p><h4 id='数据项'><span>数据项</span></h4><p><span>数据项是不可再分的数据单位</span></p><p><span>对数据项的描述</span></p><p><span>数据项描述 = {数据项名，数据项含义说明，别名，数据类型，长度，取值范围，取值含义，与其他数据项的逻辑关系，数据项之间的联系}</span></p><p><span>“取值范围”、 “与其他数据项的逻辑关系”定义了数据的完整性约束条件，是设计数据检验功能的依据</span></p><p><span>可以用关系规范化理论为指导，用数据依赖的概念分析和表示数据项之间的联系</span></p><p>&nbsp;</p><h4 id='数据结构-4'><span>数据结构</span></h4><p><span>数据结构反映了数据之间的组合关系</span></p><p><span>一个数据结构可以由若干个数据项组成，也可以由若干个数据结构组成，或由若干个数据项和数据结构混合组成</span></p><p><span>对数据结构的描述：数据结构描述 = {数据结构名，含义说明，组成：{数据项或数据结构}}</span></p><p>&nbsp;</p><h4 id='数据流'><span>数据流</span></h4><p><span>数据流是数据结构在系统内传输的路径</span></p><p><span>对数据流的描述：数据流描述 = {数据流名，说明，数据流来源，数据流去向，组成:{数据结构}，平均流量，高峰期流量}</span></p><p><span>数据流来源：说明该数据流来自哪个过程</span></p><p><span>数据流去向：说明该数据流将到哪个过程去</span></p><p><span>平均流量：在单位时间（每天、每周、每月等）里的传输次数</span></p><p><span>高峰期流量：在高峰时期的数据流量</span></p><p>&nbsp;</p><h4 id='数据存储'><span>数据存储</span></h4><p><span>数据存储是数据结构停留或保存的地方，也是数据流的来源和去向之一</span></p><p><span>对数据存储的描述：数据存储描述 = {数据存储名，说明，编号，输入的数据流 ，输出的数据流，组成：{数据结构}，数据量，存取频度，存取方式}</span></p><p><span>存取频度：每小时、每天或每周存取次数，每次存取的数据量等信息</span></p><p><span>存取方法：批处理 / 联机处理；检索 / 更新；顺序检索 /随机检索</span></p><p><span>输入的数据流：数据来源</span></p><p><span>输出的数据流：数据去向</span></p><p>&nbsp;</p><h4 id='处理过程'><span>处理过程</span></h4><p><span>处理过程的具体处理逻辑一般用判定表或判定树来描述。数据字典中只需要描述处理过程的说明性信息</span></p><p><span>处理过程说明性信息的描述：处理过程描述 = {处理过程名，说明，输入：{数据流}，输出：{数据流}，处理：{简要说明}}</span></p><p><span>简要说明：说明该处理过程的功能及处理要求</span></p><ul><li><p><span>功能：该处理过程用来做什么</span></p></li><li><p><span>处理要求：处理频度要求，如单位时间里处理多少事务，多少数据量、响应时间要求等</span></p></li><li><p><span>处理要求是后面物理设计的输入及性能评价的标准</span></p></li></ul><p>&nbsp;</p><h3 id='需求分析小结'><span>需求分析小结</span></h3><p><span>把需求收集和分析作为数据库设计的第一阶段是十分重要的。</span></p><p><span>第一阶段收集的基础数据（用数据字典来表达）是下一步进行概念设计的基础</span></p><p><span>强调两点：</span></p><ul><li><p><span>设计人员应充分考虑到可能的扩充和改变，使设计易于更改，系统易于扩充</span></p></li><li><p><span>必须强调用户的参与</span></p></li></ul><p>&nbsp;</p><h2 id='概念结构设计'><span>概念结构设计</span></h2><h3 id='概念模型-2'><span>概念模型</span></h3><p><span>将需求分析得到的用户需求抽象为信息结构（即</span><strong><span>概念模型</span></strong><span>）的过程就是概念结构设计</span></p><p><span>概念模型的特点：</span></p><ul><li><p><span>能真实、充分地反映现实世界，是现实世界的一个真实模型</span></p></li><li><p><span>易于理解，从而可以用它和不熟悉计算机的用户交换意见</span></p></li><li><p><span>易于更改，当应用环境和应用要求改变时，容易对概念模型修改和扩充</span></p></li><li><p><span>易于向关系、网状、层次等各种数据模型转换</span></p></li></ul><p>&nbsp;</p><p><span>描述概念模型的工具：</span><strong><span>E-R模型</span></strong></p><p>&nbsp;</p><h3 id='e-r模型'><span>E-R模型</span></h3><h4 id='实体之间的联系'><span>实体之间的联系</span></h4><p><strong><span>两个实体型之间的联系</span></strong></p><ul><li><p><span>一对一联系（1∶1）</span></p></li><li><p><span>一对多联系（1∶n）</span></p></li><li><p><span>多对多联系（m∶n）</span></p></li></ul><p>&nbsp;</p><p><span>一对一联系（1∶1）</span></p><p><span>如果对于实体集A中的每一个实体，实体集B中至多有一个（也可以没有）实体与之联系，反之亦然，则称实体集A与实体集B具有一对一联系，记为1∶1。</span></p><p><span>例如，学校里一个班级只有一个正班长，而一个班长只在一个班中任职，则班级与班长之间具有一对一联系。</span></p><p>&nbsp;</p><p><span>一对多联系（1∶n）</span></p><p><span>如果对于实体集A中的每一个实体，实体集B中有n个实体（n≥0）与之联系，反之，对于实体集B中的每一个实体，实体集A中至多只有一个实体与之联系，则称实体集A与实体集B有一对多联系，记为1∶n。</span></p><p><span>例如，一个班级中有若干名学生，而每个学生只在一个班级中学习，则班级与学生之间具有一对多联系。</span></p><p>&nbsp;</p><p><span>多对多联系（m∶n）</span></p><p><span>如果对于实体集A中的每一个实体，实体集B中有n个实体（n≥0）与之联系，反之，对于实体集B中的每一个实体，实体集A中也有m个实体（m≥0）与之联系，则称实体集A与实体集B具有多对多联系，记为m∶n。</span></p><p><span>例如，一门课程同时有若干个学生选修，而一个学生可以同时选修多门课程，则课程与学生之间具有多对多联系。</span></p><p>&nbsp;</p><p><span>两个实体型之间的三类联系如下图所示：</span></p><p><img src="数据库系统概论/image-20240422152141875.png" alt="image-20240422152141875" style="zoom:67%;" /></p><p>&nbsp;</p><p><strong><span>两个以上的实体型之间的联系</span></strong></p><p><span>一般地，两个以上的实体型之间也存在着一对一、一对多、多对多联系。</span></p><p><span>对于课程、教师与参考书3个实体型，如果一门课程可以有若干个教师讲授，使用若干本参考书，而每一个教师只讲授一门课程，每一本参考书只供一门课程使用，则课程与教师、参考书之间的联系是一对多的。</span></p><p>&nbsp;</p><p><span>三个实体型之间的联系示例如下图所示：</span></p><p><img src="数据库系统概论/image-20240422152240357.png" alt="image-20240422152240357" style="zoom:67%;" /></p><p>&nbsp;</p><p><strong><span>单个实体型内的联系</span></strong></p><p><span>同一个实体集内的各实体之间也可以存在一对一、一对多、多对多的联系。</span></p><p><span>例如，职工实体型内部具有领导与被领导的联系，即某一职工（干部）“领导”若干名职工，而一个职工仅被另外一个职工直接领导，因此这是一对多的联系，如下图所示（单个实体型内的一对多联系的示例）</span></p><p><img src="数据库系统概论/image-20240422152737871.png" alt="image-20240422152737871" style="zoom:67%;" /></p><p>&nbsp;</p><p><strong><span>联系的度：参与联系的实体型的数目</span></strong></p><ul><li><p><span>2个实体型之间的联系度为2，也称为二元联系</span></p></li><li><p><span>3个实体型之间的联系度为3，称为三元联系</span></p></li><li><p><span>N个实体型之间的联系度为N，也称为N元联系</span></p></li></ul><p>&nbsp;</p><h4 id='e-r图'><span>E-R图</span></h4><p><span>E-R图提供了表示</span><strong><span>实体型</span></strong><span>、</span><strong><span>属性</span></strong><span>和</span><strong><span>联系</span></strong><span>的方法</span></p><p><span>实体型：用矩形表示，矩形框内写明实体名</span></p><p><span>属性：用椭圆形表示，并用无向边将其与相应的实体型连接起来</span></p><p><span>例如，学生实体具有学号、姓名、性别、出生年份、系、入学时间等属性，用E-R图表示学生实体及属性，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422152920798.png" alt="image-20240422152920798" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>联系：用菱形表示，菱形框内写明联系名，并用无向边分别与有关实体型连接起来，同时在无向边旁标上联系的类型（1∶1，1∶n 或 m∶n）</span></p><p><strong><span>联系也可以具有属性</span></strong><span>，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422153039215.png" alt="image-20240422153039215" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>一个实例：</span></p><p><span>某个工厂物资管理的概念模型。物资管理涉及的实体有：</span></p><ul><li><p><span>仓库：属性有仓库号、面积、电话号码</span></p></li><li><p><span>零件：属性有零件号、名称、规格、单价、描述</span></p></li><li><p><span>供应商：属性有供应商号、姓名、地址、电话号码、账号</span></p></li><li><p><span>项目：属性有项目号、预算、开工日期</span></p></li><li><p><span>职工：属性有职工号、姓名、年龄、职称</span></p></li></ul><p><span>这些实体之间的联系如下：</span></p><ol start='' ><li><p><span>一个仓库可以存放多种零件，一种零件可以存放在多个仓库中，因此仓库和零件具有多对多的联系。用库存量来表示某种零件在某个仓库中的数量。</span></p></li><li><p><span>一个仓库有多个职工当仓库保管员，一个职工只能在一个仓库工作，因此仓库和职工之间是一对多的联系。</span></p></li><li><p><span>职工之间具有领导与被领导关系。即仓库主任领导若干保管员，因此职工实体型中具有一对多的联系。</span></p></li><li><p><span>供应商、项目和零件三者之间具有多对多的联系。即一个供应商可以供给若干项目多种零件，每个项目可以使用不同供应商供应的零件，每种零件可由不同供应商供给。</span></p></li></ol><p><strong><span>实体及其属性图</span></strong><span>，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422153215661.png" alt="image-20240422153215661" style="zoom:67%;" /></p><p><strong><span>实体及其联系图</span></strong><span>，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422153255120.png" alt="image-20240422153255120" style="zoom:67%;" /></p><p><strong><span>完整的实体-联系图</span></strong><span>，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422153310043.png" referrerpolicy="no-referrer" alt="image-20240422153310043"></p><p>&nbsp;</p><h3 id='扩展的e-r模型'><span>扩展的E-R模型</span></h3><p><span>略</span></p><p>&nbsp;</p><h3 id='uml'><span>UML</span></h3><p><span>略</span></p><p>&nbsp;</p><h3 id='概念结构设计-2'><span>概念结构设计</span></h3><h4 id='实体与属性的划分原则'><span>实体与属性的划分原则</span></h4><p><span>为了简化E-R图的处置，现实世界的事物能作为属性对待的，尽量作为属性对待。</span></p><p><span>两条准则：</span></p><ul><li><p><span>作为属性，不能再具有需要描述的性质。属性必须是不可分的数据项，不能包含其他属性</span></p></li><li><p><span>属性不能与其他实体具有联系，即E-R图中所表示的联系是实体之间的联系</span></p></li></ul><p>&nbsp;</p><p><span>[例1] 职工是一个实体，职工号、姓名、年龄是职工的属性。</span></p><p><span>职称如果没有与工资、福利挂钩，根据准则（1）可以作为职工实体的属性</span></p><p><span>如果不同的职称有不同的工资、住房标准和不同的附加福利，则职称作为一个实体更恰当</span></p><p><img src="数据库系统概论/image-20240422153506851.png" alt="image-20240422153506851" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>[例2] 在医院中，一个病人只能住在一个病房，病房号可以作为病人实体的一个属性</span></p><p><span>如果病房还要与医生实体发生联系，即一个医生负责几个病房的病人的医疗工作，则根据准则（2） 病房应作为一个实体。</span></p><p><img src="数据库系统概论/image-20240422153601193.png" alt="image-20240422153601193" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>[例3] 如果一种货物只存放在一个仓库，那么就可以把存放货物的仓库的仓库号作为描述货物存放地点的属性。</span></p><p><span>如果一种货物可以存放在多个仓库中，或者仓库本身又用面积作为属性，或者仓库与职工发生管理上的联系，那么就应把仓库作为一个实体。</span></p><p><img src="数据库系统概论/image-20240422153641256.png" alt="image-20240422153641256" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>[例7.1] 销售管理子系统E-R图的设计</span></p><p><span>该子系统的主要功能是：</span></p><ul><li><p><span>处理顾客和销售员送来的订单</span></p></li><li><p><span>工厂是根据订货安排生产的</span></p></li><li><p><span>交出货物同时开出发票</span></p></li><li><p><span>收到顾客付款后，根据发票存根和信贷情况进行应收款处理</span></p></li></ul><p><span>参照需求分析和数据字典中的详尽描述，遵循前面给出的两个准则，进行了如下调整：</span></p><ol start='' ><li><p><span>每张订单由订单号、若干头信息和订单细节组成。订单细节又有订货的零件号、数量等来描述。按照准则（2），订单细节就不能作订单的属性处理而应该上升为实体。一张订单可以订若干产品，所以订单与订单细节两个实体之间是1∶n的联系</span></p></li><li><p><span>原订单和产品的联系实际上是订单细节和产品的联系。每条订货细节对应一个产品描述，订单处理时从中获得当前单价、产品重量等信息</span></p></li><li><p><span>工厂对大宗订货给予优惠。每种产品都规定了不同订货数量的折扣，应增加一个“折扣规则”实体存放这些信息，而不应把它们放在产品实体中</span></p></li></ol><p><span>最后得到销售管理子系统E-R图，如下图所示：</span></p><p><img src="数据库系统概论/image-20240422154548212.png" alt="image-20240422154548212" style="zoom:67%;" /></p><p>&nbsp;</p><p><span>对每个实体定义的属性如下：</span></p><ul><li><p><span>顾客：{顾客号，顾客名，地址，电话，信贷状况，账目余额}</span></p></li><li><p><span>订单：{订单号，顾客号，订货项数，订货日期，交货日期，工种号，生产地点}</span></p></li><li><p><span>订单细则：{订单号，细则号，零件号，订货数，金额}</span></p></li><li><p><span>应收账款：{顾客号，订单号，发票号，应收金额，支付日期，支付金额，当前余额，货款限额}</span></p></li><li><p><span>产品：{产品号，产品名，单价，重量}</span></p></li><li><p><span>折扣规则：{产品号，订货量，折扣}</span></p></li></ul><p>&nbsp;</p><h4 id='e-r图的集成'><span>E-R图的集成</span></h4><p><span>E-R图的集成一般需要分两步：</span></p><ol start='' ><li><p><span>合并。解决各分E-R图之间的冲突，将分E-R图合并起来生成初步E-R图</span></p></li><li><p><span>修改和重构。消除不必要的冗余，生成基本E-R图</span></p></li></ol><p>&nbsp;</p><h5 id='合并e-r图生成初步e-r图'><span>合并E-R图，生成初步E-R图</span></h5><p><span>各个局部应用所面向的问题不同，各个子系统的E-R图之间必定会存在许多不一致的地方，称之为冲突。</span></p><p><span>子系统E-R图之间的冲突主要有三类：</span></p><ul><li><p><span>属性冲突</span></p></li><li><p><span>命名冲突</span></p></li><li><p><span>结构冲突</span></p></li></ul><p>&nbsp;</p><p><span>属性冲突</span></p><ul><li><p><span>属性域冲突，即属性值的类型、取值范围或取值集合不同</span></p><ul><li><p><span>例如零件号，有的部门把它定义为整数，有的部门把它定义为字符型</span></p></li><li><p><span>年龄，某些部门以出生日期形式表示职工的年龄，而另一些部门用整数表示职工的年龄</span></p></li></ul></li><li><p><span>属性取值单位冲突</span></p><ul><li><p><span>例如，零件的重量有的以公斤为单位，有的以斤为单位，有的以克为单位</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>命名冲突</span></p><ul><li><p><span>同名异义，即不同意义的对象在不同的局部应用中具有相同的名字</span></p></li><li><p><span>异名同义（一义多名），即同一意义的对象在不同的局部应用中具有不同的名字</span></p><ul><li><p><span>如对科研项目，财务科称为项目，科研处称为课题，生产管理处称为工程</span></p></li></ul></li><li><p><span>命名冲突</span></p><ul><li><p><span>可能发生在实体、联系一级上</span></p></li><li><p><span>也可能发生在属性一级上</span></p></li><li><p><span>通过讨论、协商等行政手段加以解决</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>结构冲突</span></p><ul><li><p><span>同一对象在不同应用中具有不同的抽象</span></p><ul><li><p><span>例如，职工在某一局部应用中被当作实体，而在另一局部应用中则被当作属性</span></p></li><li><p><span>解决方法：把属性变换为实体或把实体变换为属性，使同一对象具有相同的抽象</span></p></li></ul></li><li><p><span>同一实体在不同子系统的E-R图中所包含的属性个数和属性排列次序不完全相同</span></p><ul><li><p><span>解决方法：使该实体的属性取各子系统的E-R图中属性的并集，再适当调整属性的次序</span></p></li></ul></li><li><p><span>实体间的联系在不同的E-R图中为不同的类型</span></p><ul><li><p><span>实体E1与E2在一个E-R图中是多对多联系，在另一个E-R图中是一对多联系</span></p></li><li><p><span>解决方法是根据应用的语义对实体联系的类型进行综合或者调整</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>零件与产品之间存在多对多的联系“构成”：</span></p><p><img src="数据库系统概论/image-20240422155913934.png" alt="image-20240422155913934" style="zoom:67%;" /></p><p><span>产品、零件与供应商三者之间还存在多对多的联系“供应”：</span></p><p><img src="数据库系统概论/image-20240422155934578.png" alt="image-20240422155934578" style="zoom:67%;" /></p><p><span>合并两个E-R图：</span></p><p><img src="数据库系统概论/image-20240422160006145.png" alt="image-20240422160006145" style="zoom:67%;" /></p><p>&nbsp;</p><h5 id='消除不必要的冗余设计基本e-r图'><span>消除不必要的冗余，设计基本E-R图</span></h5><p><span>所谓冗余的数据是指可由基本数据导出的数据</span></p><p><span>所谓冗余的联系是指可由其他联系导出的联系</span></p><p><span>消除冗余主要采用分析方法，即以数据字典和数据流图为依据，根据数据字典中关于数据项之间逻辑关系的说明来消除冗余</span></p><p>&nbsp;</p><p><span>如下图所示，Q3=Q1×Q2，Q4=∑Q5。所以Q3和Q4是冗余数据，可以消去。并且由于Q3消去，产品与材料间 m : n 的冗余联系也应消去。</span></p><p><img src="数据库系统概论/image-20240422160449851.png" alt="image-20240422160449851" style="zoom:67%;" /></p><p>&nbsp;</p><p><em><span>并不是所有的冗余数据与冗余联系都必须加以消除，有时为了提高效率，不得不以冗余信息作为代价。</span></em></p><p>&nbsp;</p><p><strong><span>用规范化理论来消除冗余</span></strong></p><ol start='' ><li><p><span>确定分E-R图实体之间的数据依赖</span></p><ul><li><p><span>实体之间一对一、一对多、多对多的联系可以用实体码之间的函数依赖来表示。于是有函数依赖集F</span><sub><span>L</span></sub></p></li><li><p><span>部门和职工之间一对多的联系可表示为职工号→部门号职工和产品之间多对多的联系可表示为（职工号，产品号）→工作天数</span></p></li></ul></li><li><p><span>求FL的最小覆盖GL，差集为 D=FL-GL。</span></p><ul><li><p><span>逐一考察D中的函数依赖，确定是否是冗余的联系，若是，就把它去掉</span></p></li></ul></li></ol><p>&nbsp;</p><p><img src="数据库系统概论/image-20240422160939877.png" referrerpolicy="no-referrer" alt="image-20240422160939877"></p><p><img src="数据库系统概论/image-20240422160952154.png" referrerpolicy="no-referrer" alt="image-20240422160952154"></p><p>&nbsp;</p><p><span>由于规范化理论受到泛关系假设的限制，应注意下面两个问题：</span></p><ul><li><p><span>冗余的联系一定在D中，而D中的联系不一定是冗余的</span></p></li><li><p><span>当实体之间存在多种联系时，要将实体之间的联系在形式上加以区分</span></p></li></ul><p>&nbsp;</p><p><span>[例7.2] 某工厂管理信息系统的视图集成。</span></p><p><span>工厂物资管理E-R图如下所示：</span></p><p><img src="数据库系统概论/image-20240422163840211.png" alt="image-20240422163840211" style="zoom:80%;" /></p><p><span>销售管理子系统的E-R图如下所示：</span></p><p><img src="数据库系统概论/image-20240422163931415.png" alt="image-20240422163931415" style="zoom: 80%;" /></p><p><span>劳动人事管理的分E-R图如下所示：</span></p><p><img src="数据库系统概论/image-20240422163953790.png" alt="image-20240422163953790" style="zoom:80%;" /></p><p>&nbsp;</p><p><span>异名同义，项目和产品含义相同。某个项目实质上是指某个产品的生产。统一用产品作实体名。</span></p><p><span>库存管理中职工与仓库的工作关系已包含在劳动人事管理的部门与职工之间的联系之中，所以可以取消。职工之间领导与被领导关系可由部门与职工（经理）之间的领导关系、部门与职工之间的从属关系两者导出，所以也可以取消</span></p><p>&nbsp;</p><h2 id='逻辑结构设计'><span>逻辑结构设计</span></h2><p><span>逻辑结构设计的任务</span></p><p><span>把概念结构设计阶段设计好的基本E-R图转换为与选用数据库管理系统产品所支持的数据模型相符合的逻辑结构</span></p><p>&nbsp;</p><h2 id='物理结构设计'><span>物理结构设计</span></h2><h2 id='数据库的实施和维护'><span>数据库的实施和维护</span></h2><h2 id='小结-3'><span>小结</span></h2><p>&nbsp;</p><p>&nbsp;</p><h1 id='数据库编程'><span>数据库编程</span></h1><p><span>SQL语言是非过程化查询语言：操作统一、面向集合、功能丰富、使用简单</span></p><p><span>缺点：缺少流程控制、无法实现业务过程中的逻辑控制（if else）</span></p><p><span>SQL编程可以克服上面的缺点</span></p><p><span>嵌入式SQL、过程化SQL、存储过程、函数、ODBC、OLEDB、JDBC</span></p><p>&nbsp;</p><h2 id='嵌入式sql'><span>嵌入式SQL</span></h2><p><span>SQL语言提供了两种不同的使用方式:</span></p><ul><li><p><span>交互式</span></p></li><li><p><span>嵌入式</span></p></li></ul><p>&nbsp;</p><p><span>为什么要引入嵌入式SQL：</span></p><ul><li><p><span>SQL语言是非过程性语言</span></p></li><li><p><span>事务处理应用需要高级语言</span></p></li></ul><p>&nbsp;</p><p><span>这两种方式细节上有差别，在程序设计的环境下，SQL语句要做某些必要的扩充</span></p><p>&nbsp;</p><h3 id='嵌入式sql的处理过程'><span>嵌入式SQL的处理过程</span></h3><p><span>主语言：嵌入式SQL是将SQL语句嵌入程序设计语言中，被嵌入的程序设计语言，如C、C++、Java，称为宿主语言，简称主语言。</span></p><p><span>处理过程：预编译方法</span></p><p>&nbsp;</p><p><img src="数据库系统概论/image-20240515211544764.png" alt="image-20240515211544764" style="zoom:50%;" /></p><p>&nbsp;</p><p><span>为了区分SQL语句与主语言语句，所有SQL语句必须加前缀EXEC SQL</span></p><p>&nbsp;</p><p><span>主语言为C语言时，语句格式：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="c"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-operator">&lt;</span><span class="cm-variable">SQL语句</span><span class="cm-operator">&gt;</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>主语言为Java语言时，语句格式：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">#SQL</span> {<span class="cm-operator">&lt;</span><span class="cm-variable">SQL语句</span><span class="cm-operator">&gt;</span>};</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='嵌入式sql语句与主语言之间的通信'><span>嵌入式SQL语句与主语言之间的通信</span></h3><p><span>将SQL嵌入到高级语言中混合编程，程序中会含有两种不同计算模型的语句</span></p><p><span>SQL语句：</span></p><ul><li><p><span>描述性的面向集合的语句</span></p></li><li><p><span>负责操纵数据库</span></p></li></ul><p><span>高级语言语句：</span></p><ul><li><p><span>过程性的面向记录的语句</span></p></li><li><p><span>负责控制逻辑流程</span></p></li></ul><p>&nbsp;</p><p><span>数据库工作单元与源程序工作单元之间的通信：</span></p><ol start='' ><li><p><span>向主语言传递SQL语句的执行状态信息，使主语言能够据此控制程序流程，主要用SQL通信区实现</span></p></li><li><p><span>主语言向SQL语句提供参数，主要用主变量实现</span></p></li><li><p><span>将SQL语句查询数据库的结果交主语言处理，主要用主变量和游标实现</span></p></li></ol><p>&nbsp;</p><p><span>SQLCA： SQL Communication Area</span></p><p><span>SQLCA是一个数据结构</span></p><p>&nbsp;</p><blockquote><p><span>SQLCA（SQL Communications Area）是用于与IBM的DB2数据库通信的遗留数据结构。它是一个全局的静态结构，用于在主机语言（如COBOL或PL/I）和数据库之间传递信息。SQLCA包含有关最近执行的SQL语句的状态信息，包括错误代码、警告、返回码等。</span>
<span>在执行SQL语句后，应用程序会检查SQLCA以确定操作是否成功，并获取任何相关的错误信息。这是早期IBM数据库编程中一种常见的做法，但现代应用程序开发倾向于使用更高级的API，如ODBC、JDBC或DBI，这些API提供了更灵活、更面向对象的错误处理机制。</span>
<span>随着技术的进步，直接使用SQLCA的方式已经逐渐被淘汰，但在一些老旧的系统或特定环境下，它仍然可能被使用。</span></p></blockquote><p>&nbsp;</p><p><span>SQLCA的用途：</span></p><ul><li><p><span>SQL语句执行后，系统反馈给应用程序信息</span></p><ul><li><p><span>描述系统当前工作状态</span></p></li><li><p><span>描述运行环境</span></p></li></ul></li><li><p><span>这些信息将送到SQL通信区中</span></p></li><li><p><span>应用程序从SQL通信区中取出这些状态信息，据此决定接下来执行的语句</span></p></li></ul><p>&nbsp;</p><p><span>SQLCA使用方法：</span></p><ul><li><p><span>定义SQLCA</span></p><ul><li><p><span>用EXEC SQL INCLUDE SQLCA定义</span></p></li></ul></li><li><p><span>使用SQLCA</span></p><ul><li><p><span>SQLCA中有一个存放每次执行SQL语句后返回代码的变量SQLCODE (0:success,100:no rows,-1:失败)</span></p></li><li><p><span>如果SQLCODE等于预定义的常量SUCCESS，则表示SQL语句成功，否则表示出错</span></p></li><li><p><span>应用程序每执行完一条SQL 语句之后都应该测试一下SQLCODE的值，以了解该SQL语句执行情况并做相应处理</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>SQL通信区：</span></p><ol start='' ><li><p><span>Sqlca.dbms：这是一个用于存储数据库管理系统的名称或类型的变量。在Oracle数据库中，它指向当前连接的数据库管理系统。</span></p></li><li><p><span>Sqlca.database：这个变量指向当前连接的数据库名。在Oracle数据库中，它通常包含数据库的完全 qualified name（例如，mydatabase）。</span></p></li><li><p><span>Sqlca.logid：这是日志 ID 的变量，用于标识特定的日志文件或日志记录。在Oracle数据库中，它可能指向一个日志文件的名称或编号。</span></p></li><li><p><span>Sqlca.logpass：这个变量用于存储登录到数据库的用户密码。在Oracle数据库中，它通常包含用户的密码，但为了安全起见，密码不会直接存储在这个变量中，而是通过加密方式保存。</span></p></li><li><p><span>Sqlca.servername：这个变量指向服务器名。在Oracle数据库中，它通常包含服务器的全称或 IP 地址。</span></p></li><li><p><span>Sqlca.autocommit：这个变量控制自动提交事务的行为。如果设置为 TRUE，那么每次执行 SQL 语句都会自动提交；如果设置为 FALSE，那么需要手动调用 COMMIT 或 ROLLBACK 命令来提交或回滚事务。</span></p></li><li><p><span>Sqlca.sqlerrtext：这个变量指向 SQL 错误消息文本。在Oracle数据库中，当发生SQL错误时，该变量会包含详细的错误消息。</span></p></li><li><p><span>Sqlca.sqlcode：这个变量指向 SQL 错误代码。在Oracle数据库中，它表示错误的严重性级别，如0表示成功，其他值表示不同的错误类型。</span></p></li><li><p><span>Sqlca.sqdbcode...：这可能是一个省略的部分，表示还有更多的相关变量或参数。</span></p></li></ol><p>&nbsp;</p><p><span>主变量：嵌入式SQL语句中可以使用主语言的程序变量来输入或输出数据。</span></p><p><span>在SQL语句中使用的主语言程序变量简称为主变量（Host Variable）。</span></p><p>&nbsp;</p><p><span>主变量的类型：</span></p><ul><li><p><span>输入主变量：由应用程序对其赋值，SQL语句引用</span></p></li><li><p><span>输出主变量：由SQL语句对其赋值或设置状态信息，返回给应用程序</span></p></li></ul><p>&nbsp;</p><p><span>指示变量：</span></p><ul><li><p><span>是一个整型变量，用来“指示”所指主变量的值或条件</span></p></li><li><p><span>一个主变量可以附带一个指示变量（Indicator Variable）</span></p></li><li><p><span>指示变量的用途</span></p><ul><li><p><span>指示输入主变量是否为空值</span></p></li><li><p><span>检测输出变量是否为空值，值是否被截断</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>在SQL语句中使用主变量和指示变量的方法：</span></p><p><span>说明主变量和指示变量：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="C"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BEGIN</span> <span class="cm-variable">DECLARE</span> <span class="cm-variable">SECTION</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">……</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//（说明主变量和指示变量）</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">……</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">END</span> <span class="cm-variable">DECLARE</span> <span class="cm-variable">SECTION</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>使用主变量：</span></p><ul><li><p><span>说明之后的主变量可以在SQL语句中任何一个能够使用表达式的地方出现</span></p></li><li><p><span>为了与数据库对象名（表名、视图名、列名等）区别，SQL语句中的主变量名前要加冒号（:）作为标志</span></p></li></ul><p><span>使用指示变量：</span></p><ul><li><p><span>指示变量前也必须加冒号标志</span></p></li><li><p><span>必须紧跟在所指主变量之后</span></p></li></ul><p>&nbsp;</p><p><span>在SQL语句之外（主语言语句中）使用主变量和指示变量的方法：可以直接引用，不必加冒号</span></p><p>&nbsp;</p><p><span>游标</span></p><p><span>为什么要使用游标：</span></p><ul><li><p><span>SQL语言与主语言具有不同数据处理方式</span></p></li><li><p><span>SQL语言是面向集合的，一条SQL语句原则上可以产生或处理多条记录</span></p></li><li><p><span>主语言是面向记录的，一组主变量一次只能存放一条记录</span></p></li><li><p><span>仅使用主变量并不能完全满足SQL语句向应用程序输出数据的要求</span></p></li><li><p><span>嵌入式SQL引入了游标的概念，用来协调这两种不同的处理方式</span></p></li></ul><p>&nbsp;</p><p><span>游标是系统为用户开设的一个数据缓冲区，存放SQL语句的执行结果</span></p><p><span>每个游标区都有一个名字</span></p><p><span>用户可以用SQL语句逐一从游标中获取记录，并赋给主变量，交由主语言进一步处理</span></p><p>&nbsp;</p><p><span>建立和关闭数据库连接：</span></p><p><span>建立数据库连接</span></p><p><span>EXEC SQL CONNECT TO target</span><span>[</span><span>AS connectionname][USER user-name];</span></p><p><span>target是要连接的数据库服务器</span></p><p><span>常见的服务器标识串，如</span><span>&lt;</span><span>dbname&gt;@</span><span>&lt;</span><span>hostname&gt;:</span><span>&lt;</span><span>port&gt;</span></p><p><span>包含服务器标识的SQL串常量</span></p><p><span>DEFAULT</span></p><p><span>connect-name是可选的连接名，连接名必须是一个有效的标识符</span></p><p><span>在整个程序内只有一个连接时可以不指定连接名</span></p><p><span>程序运行过程中可以修改当前连接：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">SET</span> <span class="cm-variable">CONNECTION</span> <span class="cm-variable">connection</span><span class="cm-operator">-</span><span class="cm-variable">name</span><span class="cm-operator">|</span><span class="cm-variable">DEFAULT</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>关闭数据库连接</span></p><p><span>EXEC SQL DISCONNECT [connection];</span></p><p>&nbsp;</p><p><span>[例8.1] 依次检查某个系的学生记录，交互式更新某些学生年龄</span></p><p>&nbsp;</p><p>&nbsp;</p><h3 id='不用游标的sql语句'><span>不用游标的SQL语句</span></h3><p><span>不用游标的SQL语句的种类：</span></p><ul><li><p><span>说明性语句</span></p></li><li><p><span>数据定义语句</span></p></li><li><p><span>数据控制语句</span></p></li><li><p><span>查询结果为单记录的SELECT语句</span></p></li><li><p><span>非CURRENT形式的增删改语句</span></p></li></ul><p>&nbsp;</p><p><span>查询结果为单记录的SELECT语句：</span></p><p><span>这类语句不需要使用游标，只需用INTO子句指定存放查询结果的主变量。</span></p><p>&nbsp;</p><p><span>[例8.2] 根据学生号码查询学生信息</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">SELECT</span> <span class="cm-variable">Sno</span>,<span class="cm-variable">Sname</span>,<span class="cm-variable">Ssex</span>,<span class="cm-variable">Sage</span>,<span class="cm-variable">Sdept</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">INTO</span>:<span class="cm-variable">Hsno</span>,:<span class="cm-variable">Hname</span>,:<span class="cm-variable">Hsex</span>,:<span class="cm-variable">Hage</span>,:<span class="cm-variable">Hdept</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">FROM</span> <span class="cm-variable">Student</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">WHERE</span> <span class="cm-variable">Sno</span><span class="cm-operator">=</span>:<span class="cm-variable">givensno</span>;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*把要查询的学生的学号赋给为了主变量givensno*/</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p><span>INTO子句、WHERE子句和HAVING短语的条件表达式中均可以使用主变量</span></p><p><span>查询返回的记录中，可能某些列为空值NULL</span></p><p><span>如果查询结果实际上并不是单条记录，而是多条记录，则程序出错，关系数据库管理系统会在SQLCA中返回错误信息</span></p><p>&nbsp;</p><p><span>在UPDATE的SET子句和WHERE子句中可以使用主变量，SET子句还可以使用指示变量</span></p><p><span>[例8.4] 修改某个学生选修1号课程的成绩。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">UPDATE</span> <span class="cm-variable">SC</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*修改的成绩已赋给主变量：newgrade*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">SET</span> <span class="cm-variable">Grade</span><span class="cm-operator">=</span>:<span class="cm-variable">newgrade</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">/*学号赋给主变量：givensno*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">WHERE</span> <span class="cm-variable">Sno</span><span class="cm-operator">=</span>:<span class="cm-variable">givensno</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='使用游标的sql语句'><span>使用游标的SQL语句</span></h3><p><span>必须使用游标的SQL语句：</span></p><ul><li><p><span>查询结果为多条记录的SELECT语句</span></p></li><li><p><span>CURRENT形式的UPDATE语句</span></p></li><li><p><span>CURRENT形式的DELETE语句</span></p></li></ul><p>&nbsp;</p><p><span>查询结果为多条记录的SELECT语句</span></p><p><span>使用游标的步骤：</span></p><ol start='' ><li><p><span>说明游标</span></p></li><li><p><span>打开游标</span></p></li><li><p><span>推进游标指针并取当前记录</span></p></li><li><p><span>关闭游标</span></p></li></ol><p>&nbsp;</p><p><strong><span>使用DECLARE语句</span></strong></p><p><span>语句格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">EXEC <span class="cm-keyword">SQL</span> <span class="cm-keyword">DECLARE</span> <span class="cm-operator">&lt;</span>游标名<span class="cm-operator">&gt;</span> <span class="cm-keyword">CURSOR</span> <span class="cm-keyword">FOR</span> <span class="cm-operator">&lt;</span><span class="cm-keyword">SELECT</span>语句<span class="cm-operator">&gt;</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>功能：是一条说明性语句，这时关系数据库管理系统并不执行SELECT语句</span></p><p><strong><span>使用OPEN语句</span></strong></p><p><span>语句格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">OPEN</span> <span class="cm-operator">&lt;</span><span class="cm-variable">游标名</span><span class="cm-operator">&gt;</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>功能：</span></p><ul><li><p><span>打开游标实际上是执行相应的SELECT语句，把查询结果取到缓冲区中</span></p></li><li><p><span>这时游标处于活动状态，指针指向查询结果集中的第一条记录</span></p></li></ul><p><strong><span>使用FETCH语句</span></strong></p><p><span>语句格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">FETCH</span> <span class="cm-operator">&lt;</span><span class="cm-variable">游标名</span><span class="cm-operator">&gt;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">INTO</span> <span class="cm-operator">&lt;</span><span class="cm-variable">主变量</span><span class="cm-operator">&gt;</span>[<span class="cm-operator">&lt;</span><span class="cm-variable">指示变量</span><span class="cm-operator">&gt;</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>[,<span class="cm-operator">&lt;</span><span class="cm-variable">主变量</span><span class="cm-operator">&gt;</span>[<span class="cm-operator">&lt;</span><span class="cm-variable">指示变量</span><span class="cm-operator">&gt;</span>]]...;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>功能：指定方向推动游标指针，同时将缓冲区中的当前记录取出来送至主变量供主语言进一步处理</span></p><p><strong><span>使用CLOSE语句</span></strong></p><p><span>语句格式</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">EXEC</span> <span class="cm-variable">SQL</span> <span class="cm-variable">CLOSE</span> <span class="cm-operator">&lt;</span><span class="cm-variable">游标名</span><span class="cm-operator">&gt;</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>功能：关闭游标，释放结果集占用的缓冲区及其他资源</span></p><p><span>说明：</span></p><ul><li><p><span>游标被关闭后，就不再和原来的查询结果集相联系</span></p></li><li><p><span>被关闭的游标可以再次被打开，与新的查询结果相联系</span></p></li></ul><p>&nbsp;</p><p><span>CURRENT形式的UPDATE语句和DELETE语句</span></p><p><span>CURRENT形式的UPDATE语句和DELETE语句的用途：</span></p><ul><li><p><span>非CURRENT形式的UPDATE语句和DELETE语句</span></p><ul><li><p><span>面向集合的操作</span></p></li><li><p><span>一次修改或删除所有满足条件的记录</span></p></li></ul></li></ul><p><span>如果只想修改或删除其中某个记录：</span></p><ul><li><p><span>用带游标的SELECT语句查出所有满足条件的记录</span></p></li><li><p><span>从中进一步找出要修改或删除的记录</span></p></li><li><p><span>用CURRENT形式的UPDATE语句和DELETE语句修改或删除之</span></p></li><li><p><span>UPDATE语句和DELETE语句中要用子句</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="java"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="java"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">WHERE</span> <span class="cm-variable">CURRENT</span> <span class="cm-variable">OF</span> <span class="cm-operator">&lt;</span><span class="cm-variable">游标名</span><span class="cm-operator">&gt;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>表示修改或删除的是最近一次取出的记录，即游标指针指向的记录</span></p></li></ul><p><span>不能使用CURRENT形式的UPDATE语句和DELETE语句</span></p><ul><li><p><span>当游标定义中的SELECT语句带有UNION或ORDER  BY子句</span></p></li><li><p><span>该SELECT语句相当于定义了一个不可更新的视图</span></p></li></ul><p>&nbsp;</p><h3 id='动态sql'><span>动态SQL</span></h3><p><span>静态嵌入式SQL：</span></p><ul><li><p><span>静态嵌入式SQL语句能够满足一般要求</span></p></li><li><p><span>无法满足要到执行时才能够确定要提交的SQL语句、查询的条件</span></p></li></ul><p><span>动态嵌入式SQL：</span></p><ul><li><p><span>允许在程序运行过程中临时“组装”SQL语句</span></p></li><li><p><span>支持动态组装SQL语句和动态参数两种形式</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2 id='过程化sql'><span>过程化SQL</span></h2><h3 id='过程化sql的块结构'><span>过程化SQL的块结构</span></h3><p><span>过程化SQL：</span></p><ul><li><p><span>SQL的扩展</span></p></li><li><p><span>增加了过程化语句功能</span></p></li><li><p><span>基本结构是块</span></p><ul><li><p><span>块之间可以互相嵌套</span></p></li><li><p><span>每个块完成一个逻辑操作</span></p></li></ul></li></ul><p>&nbsp;</p><p><span>过程化SQL块的基本结构：</span></p><p><span>定义部分：DECLARE 变量、常量、游标、异常等</span></p><ul><li><p><span>定义的变量、常量等只能在该基本块中使用</span></p></li><li><p><span>当基本块执行结束时，定义就不再存在</span></p></li></ul><p><span>执行部分:</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">BEGIN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">%</span> <span class="cm-keyword">SQL</span>语句、过程化SQL的流程控制语句</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">EXCEPTION</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">%</span> 异常处理部分</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">END</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='变量和常量的定义'><span>变量和常量的定义</span></h3><ol start='' ><li><p><span>变量定义：</span></p><ul><li><p><span>变量名 数据类型 [[NOT NULL]:=初值表达式]</span></p></li><li><p><span>或者：</span></p></li><li><p><span>变量名 数据类型 [[NOT NULL] 初值表达式]</span></p></li></ul></li><li><p><span>常量定义：</span></p><ul><li><p><span>常量名 数据类型 CONSTANT :=常量表达式</span></p></li><li><p><span>常量必须要给一个值，并且该值在存在期间或常量的作用域内不能改变。如果试图修改它，过程化SQL将返回一个异常</span></p></li></ul></li><li><p><span>赋值语句：</span></p><ul><li><p><span>变量名称 :=表达式</span></p></li></ul></li></ol><p>&nbsp;</p><h3 id='流程控制'><span>流程控制</span></h3><p><span>过程化SQL功能：</span></p><ul><li><p><span>条件控制语句</span></p></li><li><p><span>循环控制语句</span></p></li><li><p><span>错误处理</span></p></li></ul><p>&nbsp;</p><h4 id='条件控制语句'><span>条件控制语句</span></h4><p><span>IF-THEN，IF-THEN-ELSE和嵌套的IF语句</span>
<span>（1）</span></p><p><span>IF condition THEN</span>
<span>Sequence_of_statements;</span>
<span>END IF;</span></p><p><span>（2）</span></p><p><span>IF condition THEN</span>
<span>Sequence_of_statements1;</span>
<span>ELSE</span>
<span>Sequence_of_statements2;</span>
<span>END IF;</span></p><p><span>（3）</span></p><p><span>在THEN和ELSE子句中还可以再包含IF语句，即IF语句可以嵌套</span></p><p>&nbsp;</p><h4 id='循环控制语句'><span>循环控制语句</span></h4><p><span>LOOP，WHILE-LOOP和FOR-LOOP</span></p><p><span>（1）简单的循环语句LOOP</span></p><p><span>LOOP</span>
<span>Sequence_of_statements; </span>
<span>END LOOP;</span></p><p><span>多数数据库服务器的过程化SQL都提供EXIT、BREAK或LEAVE等循环结束语句，保证LOOP语句块能够结束</span></p><p><span>（2）WHILE-LOOP</span></p><p><span>WHILE condition LOOP</span>
<span>Sequence_of_statements;</span>
<span>END LOOP;</span></p><ul><li><p><span>每次执行循环体语句之前，首先对条件进行求值</span></p></li><li><p><span>如果条件为真，则执行循环体内的语句序列</span></p></li><li><p><span>如果条件为假，则跳过循环并把控制传递给下一个语句</span></p></li></ul><p><span>（3）FOR-LOOP</span></p><p><span>FOR count IN [REVERSE] bound1 … bound2 LOOP</span>
<span>Sequence_of_statements;</span>
<span>END LOOP;</span></p><p>&nbsp;</p><h4 id='错误处理'><span>错误处理</span></h4><ul><li><p><span>如果过程化SQL在执行时出现异常，则应该让程序在产生异常的语句处停下来，根据异常的类型去执行异常处理语句</span></p></li><li><p><span>SQL标准对数据库服务器提供什么样的异常处理做出了建议，要求过程化SQL管理器提供完善的异常处理机制</span></p></li></ul><p>&nbsp;</p><h2 id='存储过程和函数'><span>存储过程和函数</span></h2><h3 id='存储过程'><span>存储过程</span></h3><p><span>过程化SQL块类型：</span></p><ul><li><p><span>命名块：编译后保存在数据库中，可以被反复调用，运行速度较快，过程和函数是命名块</span></p></li><li><p><span>匿名块：每次执行时都要进行编译，它不能被存储到数据库中，也不能在其他过程化SQL块中调用</span></p></li></ul><p>&nbsp;</p><p><span>存储过程：由过程化SQL语句书写的过程，经编译和优化后存储在数据库服务器中，使用时只要调用即可。</span></p><p>&nbsp;</p><p><span>存储过程的优点：</span></p><ul><li><p><span>运行效率高</span></p></li><li><p><span>降低了客户机和服务器之间的通信量</span></p></li><li><p><span>方便实施企业规则</span></p></li></ul><p>&nbsp;</p><p><span>存储过程的用户接口：</span></p><ul><li><p><span>创建存储过程</span></p></li><li><p><span>执行存储过程</span></p></li><li><p><span>修改存储过程</span></p></li><li><p><span>删除存储过程</span></p></li></ul><p>&nbsp;</p><h4 id='创建存储过程'><span>创建存储过程</span></h4><p><span>CREATE OR REPLACE PROCEDURE 过程名([参数1, 参数2,...]) AS &lt;过程化SQL块&gt;；</span></p><p><span>过程名：数据库服务器合法的对象标识</span></p><p><span>参数列表：用名字来标识调用时给出的参数值，必须指定值的数据类型。参数也可以定义输入参数、输出参数或输入/输出参数，默认为输入参数</span></p><p><span>过程体：是一个&lt;过程化SQL块&gt;，包括声明部分和可执行语句部分</span></p><p>&nbsp;</p><p><span>[例8.8] 利用存储过程来实现下面的应用：从账户1转指定数额的款项到账户2中。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>48</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">OR</span> <span class="cm-keyword">REPLACE</span> <span class="cm-keyword">PROCEDURE</span> TRANSFER <span class="cm-bracket">(</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  inAccount <span class="cm-type">INT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  outAccount <span class="cm-type">INT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  amount <span class="cm-type">FLOAT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span> <span class="cm-keyword">AS</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DECLARE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  totalDepositOut <span class="cm-type">FLOAT</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  totalDepositIn <span class="cm-type">FLOAT</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  inAccountnum <span class="cm-type">INT</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">BEGIN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Total</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">INTO</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  totalDepositOut</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">FROM</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Account</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">WHERE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  accountnum <span class="cm-operator">=</span> outAccount<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">IF</span> totalDepositOut <span class="cm-keyword">IS</span> <span class="cm-atom">NULL</span> <span class="cm-keyword">THEN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ROLLBACK</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">RETURN</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">END</span> <span class="cm-keyword">IF</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Accountnum</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">INTO</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  inAccountnum</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">FROM</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Account</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">WHERE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  accountnum <span class="cm-operator">=</span> inAccount<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">IF</span> inAccount <span class="cm-keyword">IS</span> <span class="cm-atom">NULL</span> <span class="cm-keyword">THEN</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">ROLLBACK</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">RETURN</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">END</span> <span class="cm-keyword">IF</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">UPDATE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Account</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">SET</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  total <span class="cm-operator">=</span> total <span class="cm-operator">-</span> amount</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">WHERE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  accountnum <span class="cm-operator">=</span> outAccount<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">UPDATE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  Account</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">43</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">SET</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">44</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  total <span class="cm-operator">=</span> total <span class="cm-operator">+</span> amount</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">45</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">WHERE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">46</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  accountnum <span class="cm-operator">=</span> inAccount<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">47</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">COMMIT</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">48</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">END</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1106px;"></div><div class="CodeMirror-gutters" style="height: 1106px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><h4 id='执行存储过程'><span>执行存储过程</span></h4><p><span>CALL/PERFORM PROCEDURE 过程名([参数1,参数2,...])；</span></p><p><span>使用CALL或者PERFORM等方式激活存储过程的执行</span></p><p><span>在过程化SQL中，数据库服务器支持在过程体中调用其他存储过程</span></p><p>&nbsp;</p><p><span>[例8.9] 从账户01003815868转10000元到01003813828账户中。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CALL</span> <span class="cm-keyword">PROCEDURE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">TRANSFER<span class="cm-bracket">(</span><span class="cm-number">01003813828</span><span class="cm-punctuation">,</span><span class="cm-number">01003815868</span><span class="cm-punctuation">,</span><span class="cm-number">10000</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><h4 id='修改存储过程'><span>修改存储过程</span></h4><p><span>ALTER PROCEDURE 过程名1 RENAME TO 过程名2;</span></p><p>&nbsp;</p><h4 id='删除存储过程'><span>删除存储过程</span></h4><p><span>DROP PROCEDURE 过程名()；</span></p><p>&nbsp;</p><h3 id='函数'><span>函数</span></h3><p><span>函数和存储过程的异同：</span></p><p><span>同：都是持久性存储模块</span></p><p><span>异：函数必须指定返回的类型</span></p><p>&nbsp;</p><h4 id='函数的定义语句格式'><span>函数的定义语句格式</span></h4><p><span>CREATE OR REPLACE FUNCTION 函数名 ([参数1,参 数2,…]) RETURNS &lt;类型&gt; AS &lt;过程化SQL块&gt;;</span></p><p>&nbsp;</p><h4 id='函数的执行语句格式'><span>函数的执行语句格式</span></h4><p><span>CALL/SELECT 函数名 ([参数1,参数2,…]);</span></p><p>&nbsp;</p><h4 id='修改函数'><span>修改函数</span></h4><p><span>重命名：</span></p><p><span>ALTER FUNCTION 过程名1 RENAME TO 过程名2;</span></p><p>&nbsp;</p><p><span>重新编译：</span></p><p><span>ALTER FUNCTION 过程名 COMPILE;</span></p><p>&nbsp;</p><h2 id='odbc编程'><span>ODBC编程</span></h2><p><span>ODBC优点：</span></p><ul><li><p><span>移植性好</span></p></li><li><p><span>能同时访问不同的数据库</span></p></li><li><p><span>共享多个数据资源</span></p></li></ul><p>&nbsp;</p><h3 id='odbc概述'><span>ODBC概述</span></h3><p><span>ODBC产生的原因：</span></p><ul><li><p><span>由于不同的数据库管理系统的存在，在某个关系数据库管理系统下编写的应用程序就不能在另一个关系数据库管理系统下运行</span></p></li><li><p><span>许多应用程序需要共享多个部门的数据资源，访问不同的关系数据库管理系统</span></p></li></ul><p>&nbsp;</p><p><span>ODBC</span></p><ul><li><p><span>是微软公司开放服务体系（Windows Open Services Architecture，WOSA）中有关数据库的一个组成部分</span></p></li><li><p><span>提供了一组访问数据库的应用程序编程接口（Application Programming Interface，API ）</span></p></li></ul><p>&nbsp;</p><p><span>ODBC约束力</span></p><ul><li><p><span>规范应用开发</span></p></li><li><p><span>规范关系数据库管理系统应用接口</span></p></li></ul><p>&nbsp;</p><h3 id='odbc工作原理概述'><span>ODBC工作原理概述</span></h3><p><span>ODBC应用系统的体系结构：</span></p><ol start='' ><li><p><span>用户应用程序</span></p></li><li><p><span>ODBC驱动程序管理器</span></p></li><li><p><span>数据库驱动程序</span></p></li><li><p><span>数据源</span></p></li></ol><p>&nbsp;</p><p><img src="数据库系统概论/image-20240516180823928.png" referrerpolicy="no-referrer" alt="image-20240516180823928"></p><p>&nbsp;</p><h4 id='用户应用程序'><span>用户应用程序</span></h4><p><span>应用程序提供用户界面、应用逻辑和事务逻辑。</span></p><p><span>应用程序调用标准的ODBC函数和SQL语句。</span></p><p><span>应用层使用ODBC API调用接口和数据库交互。</span></p><p>&nbsp;</p><p><span>ODBC应用程序包括的内容：</span></p><ul><li><p><span>请求连接数据库</span></p></li><li><p><span>向数据源发送SQL语句</span></p></li><li><p><span>为SQL语句执行结果分配存储空间，定义所读取的数据格式</span></p></li><li><p><span>获取数据库操作结果或处理错误</span></p></li><li><p><span>进行数据处理并向用户提交处理结果</span></p></li><li><p><span>请求事务的提交和回滚操作</span></p></li><li><p><span>断开与数据源的连接</span></p></li></ul><p>&nbsp;</p><h4 id='odbc驱动程序管理器'><span>ODBC驱动程序管理器</span></h4><p><span>驱动程序管理器：用来管理各种驱动程序</span></p><ul><li><p><span>包含在ODBC32.DLL中，对用户透明</span></p></li><li><p><span>管理应用程序和驱动程序之间的通信</span></p></li><li><p><span>建立、配置或删除数据源，并查看系统当前所安装的数据库ODBC驱动程序</span></p></li></ul><p>&nbsp;</p><p><span>主要功能：</span></p><ul><li><p><span>装载ODBC驱动程序</span></p></li><li><p><span>选择和连接正确的驱动程序</span></p></li><li><p><span>管理数据源</span></p></li><li><p><span>检查ODBC调用参数的合法性</span></p></li><li><p><span>记录ODBC函数的调用等</span></p></li></ul><p>&nbsp;</p><h4 id='数据库驱动程序'><span>数据库驱动程序</span></h4><p><span>ODBC通过驱动程序来提供应用系统与数据库平台的独立性</span></p><p><span>ODBC应用程序不能直接存取数据库</span></p><ul><li><p><span>其各种操作请求由驱动程序管理器提交给某个关系数据库管理系统的ODBC驱动程序</span></p></li><li><p><span>通过调用驱动程序所支持的函数来存取数据库</span></p></li><li><p><span>数据库的操作结果也通过驱动程序返回给应用程序</span></p></li><li><p><span>如果应用程序要操纵不同的数据库，就要动态地链接到不同的驱动程序上</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><h1 id='数据库恢复技术'><span>数据库恢复技术</span></h1><h2 id='事务'><span>事务</span></h2><p><span>事务(Transaction)是用户定义的一个数据库操作序列，这些操作要么全做，要么全不做，是一个不可分割的工作单位。</span></p><p>&nbsp;</p><p><span>事务和程序是两个概念：</span></p><ul><li><p><span>在关系数据库中，一个事务可以是一条SQL语句，一组SQL语句或整个程序</span></p></li><li><p><span>一个程序通常包含多个事务</span></p></li></ul><p>&nbsp;</p><p><span>事务是恢复和并发控制的基本单位</span></p><p>&nbsp;</p><p><span>COMMIT：</span></p><ul><li><p><span>事务正常结束</span></p></li><li><p><span>提交事务的所有操作（读+更新）</span></p></li><li><p><span>事务中所有对数据库的更新写回到磁盘上的物理数据库中</span></p></li></ul><p><span>ROLLBACK：</span></p><ul><li><p><span>事务异常终止</span></p></li><li><p><span>事务运行的过程中发生了故障，不能继续执行</span></p></li><li><p><span>系统将事务中对数据库的所有已完成的操作全部撤销</span></p></li><li><p><span>事务滚回到开始时的状态</span></p></li></ul><p>&nbsp;</p><h2 id='事务的acid特性'><span>事务的ACID特性</span></h2><h3 id='原子性'><span>原子性</span></h3><p><span>原子性：事务是数据库的逻辑工作单位</span></p><p><span>事务中包括的诸操作要么都做，要么都不做</span></p><p>&nbsp;</p><h3 id='一致性'><span>一致性</span></h3><p><span>一致性：事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态</span></p><p>&nbsp;</p><p><span>一致性状态：数据库中只包含成功事务提交的结果</span></p><p><span>不一致状态：</span></p><ul><li><p><span>数据库系统运行中发生故障，有些事务尚未完成就被迫中断</span></p></li><li><p><span>这些未完成事务对数据库所做的修改有一部分已写入物理数据库，这时数据库就处于一种不正确的状态</span></p></li></ul><p>&nbsp;</p><h3 id='隔离性'><span>隔离性</span></h3><p><span>隔离性：一个事务的执行不能被其他事务干扰</span></p><ul><li><p><span>一个事务内部的操作及使用的数据对其他并发事务是隔离的</span></p></li><li><p><span>并发执行的各个事务之间不能互相干扰</span></p></li></ul><p>&nbsp;</p><h3 id='持续性'><span>持续性</span></h3><p><span>持续性：一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其执行结果有任何影响</span></p><p>&nbsp;</p><p><span>破坏事务ACID特性的因素：</span></p><ul><li><p><span>多个事务并行运行时，不同事务的操作交叉执行</span></p></li><li><p><span>事务在运行过程中被强行停止</span></p></li></ul><p>&nbsp;</p><h2 id='恢复的实现技术'><span>恢复的实现技术</span></h2><p><span>恢复机制涉及的关键问题：</span></p><ol start='' ><li><p><span>如何建立冗余数据</span></p><ol start='' ><li><p><span>数据转储（backup）</span></p></li><li><p><span>登记日志文件（logging）</span></p></li></ol></li><li><p><span>如何利用这些冗余数据实施数据库恢复</span></p></li></ol><p>&nbsp;</p><h3 id='数据转储'><span>数据转储</span></h3><p><span>转储是指数据库管理员定期地将整个数据库复制到磁带、磁盘或其他存储介质上保存起来的过程</span></p><p><span>备用的数据文本称为后备副本(backup)或后援副本</span></p><p>&nbsp;</p><ol start='' ><li><p><span>数据库遭到破坏后可以将后备副本重新装入</span></p></li><li><p><span>重装后备副本只能将数据库恢复到转储时的状态</span></p></li><li><p><span>要想恢复到故障发生时的状态，必须重新运行自转储以后的所有更新事务</span></p></li></ol><p>&nbsp;</p><p><span>转储方法：</span></p><ul><li><p><span>静态转储与动态转储</span></p></li><li><p><span>海量转储与增量转储</span></p></li></ul><p>&nbsp;</p><h4 id='静态转储'><span>静态转储</span></h4><p><span>在系统中无运行事务时进行的转储操作</span></p><p><span>转储开始时数据库处于一致性状态</span></p><p><span>转储期间不允许对数据库的任何存取、修改活动</span></p><p><span>得到的一定是一个数据一致性的副本</span></p><p><span>优点：实现简单</span></p><p><span>缺点：降低了数据库的可用性</span></p><ul><li><p><span>转储必须等待正运行的用户事务结束</span></p></li><li><p><span>新的事务必须等转储结束</span></p></li></ul><p>&nbsp;</p><h4 id='动态转储'><span>动态转储</span></h4><p><span>转储操作与用户事务并发进行</span></p><p><span>转储期间允许对数据库进行存取或修改</span></p><p>&nbsp;</p><p><span>利用动态转储得到的副本进行故障恢复：</span></p><ol start='' ><li><p><span>需要把动态转储期间各事务对数据库的修改活动登记下来，建立日志文件</span></p></li><li><p><span>后备副本加上日志文件就能把数据库恢复到某一时刻的正确状态</span></p></li></ol><p>&nbsp;</p><h3 id='转储方法分类'><span>转储方法分类</span></h3><p><img src="数据库系统概论/image-20240520105311601.png" referrerpolicy="no-referrer" alt="image-20240520105311601"></p><p>&nbsp;</p><h3 id='登记日志文件'><span>登记日志文件</span></h3><p><span>日志文件(log file)是用来记录事务对数据库的更新操作的文件</span></p><p>&nbsp;</p><p><span>日志文件的格式：</span></p><ul><li><p><span>以记录为单位的日志文件</span></p></li><li><p><span>以数据块为单位的日志文件</span></p></li></ul><p>&nbsp;</p><p><span>以记录为单位的日志文件内容：</span></p><ul><li><p><span>各个事务的开始标记(BEGIN TRANSACTION)</span></p></li><li><p><span>各个事务的结束标记(COMMIT或ROLLBACK)</span></p></li><li><p><span>各个事务的所有更新操作</span></p></li></ul><p><span>以上均作为日志文件中的一个日志记录 (log record)</span></p><p>&nbsp;</p><p><span>以记录为单位的日志文件，每条日志记录的内容：</span></p><ul><li><p><span>事务标识（标明是哪个事务）</span></p></li><li><p><span>操作类型（插入、删除或修改）</span></p></li><li><p><span>操作对象（记录ID、Block NO.）</span></p></li><li><p><span>更新前数据的旧值（对插入操作而言，此项为空值）</span></p></li><li><p><span>更新后数据的新值（对删除操作而言, 此项为空值）</span></p></li></ul><p>&nbsp;</p><p><span>以数据块为单位的日志文件，每条日志记录的内容：</span></p><ul><li><p><span>事务标识</span></p></li><li><p><span>被更新的数据块</span></p></li></ul><p>&nbsp;</p><p><span>作用：</span></p><ul><li><p><span>进行事务故障恢复</span></p></li><li><p><span>进行系统故障恢复</span></p></li><li><p><span>协助后备副本进行介质故障恢复</span></p></li></ul><p>&nbsp;</p><p><span>具体作用：</span></p><ul><li><p><span>事务故障恢复和系统故障恢复必须用日志文件</span></p></li><li><p><span>在动态转储方式中必须建立日志文件，后备副本和日志文件结合起来才能有效地恢复数据库</span></p></li></ul><p>&nbsp;</p><p><span>当数据库毁坏后可重新装入后援副本把数据库恢复到转储结束时刻的正确状态</span></p><p><span>利用日志文件，把已完成的事务进行重做处理</span></p><p><span>对故障发生时尚未完成的事务进行撤销处理</span></p><p><span>不必重新运行那些已完成的事务程序就可把数据库恢复到故障前某一时刻的正确状态</span></p><p>&nbsp;</p><p><span>登记的次序严格按并发事务执行的时间次序，写到磁盘中的日志记录顺序必须与写入日志缓冲区的次序完全一致</span></p><p><strong><span>必须先写日志文件，后写数据库</span></strong></p><p>&nbsp;</p><p><span>为什么要先写日志文件：</span></p><ol start='' ><li><p><span>写数据库和写日志文件是两个不同的操作 </span></p></li><li><p><span>在这两个操作之间可能发生故障</span></p></li><li><p><span>如果先写了数据库修改，而在日志文件中没有登记下这个修改，则以后就无法恢复这个修改了</span></p></li><li><p><span>如果先写日志，但没有修改数据库，按日志文件恢复时只不过是多执行一次不必要的UNDO操作，并不会影响数据库的正确性</span></p></li></ol><p>&nbsp;</p><h2 id='数据库镜像'><span>数据库镜像</span></h2><p><span>介质故障是对系统影响最为严重的一种故障，严重影响数据库的可用性</span></p><p><span>为预防介质故障，数据库管理员必须周期性地转储数据库</span></p><p><span>提高数据库可用性的解决方案：数据库镜像（Mirror）</span></p><p>&nbsp;</p><p><span>数据库镜像：</span></p><ul><li><p><span>数据库管理系统自动把整个数据库或其中的关键数据复制到另一个磁盘上</span></p></li><li><p><span>数据库管理系统自动保证镜像数据与主数据的一致性</span></p><ul><li><p><span>每当主数据库更新时，数据库管理系统自动把更新后的数据复制过去</span></p></li></ul></li></ul><p><img src="数据库系统概论/image-20240520114725109.png" referrerpolicy="no-referrer" alt="image-20240520114725109"></p><p>&nbsp;</p><p><span>出现介质故障时：</span></p><ul><li><p><span>可由镜像磁盘继续提供使用</span></p></li><li><p><span>同时数据库管理系统自动利用镜像磁盘数据进行数据库的恢复</span></p></li><li><p><span>不需要关闭系统和重装数据库副本</span></p></li></ul><p><img src="数据库系统概论/image-20240520114834955.png" referrerpolicy="no-referrer" alt="image-20240520114834955"></p><p>&nbsp;</p><p><span>没有出现故障时：</span></p><ul><li><p><span>可用于并发操作</span></p></li><li><p><span>一个用户对数据加排他锁修改数据，其他用户可以读镜像数据库上的数据，而不必等待该用户释放锁</span></p></li></ul><p><img src="数据库系统概论/image-20240520114911883.png" referrerpolicy="no-referrer" alt="image-20240520114911883"></p><p>&nbsp;</p><p><span>频繁地复制数据自然会降低系统运行效率</span></p><p><span>在实际应用中用户往往只选择对关键数据和日志文件的镜像，不是对整个数据库进行镜像</span></p><p>&nbsp;</p><h1 id='并发控制'><span>并发控制</span></h1><h2 id='并发控制概述'><span>并发控制概述</span></h2><p><span>多事务执行方式：</span></p><ul><li><p><span>事务串行执行</span></p></li><li><p><span>交叉并发方式——单处理机</span></p></li><li><p><span>同时并发方式——多处理机</span></p></li></ul><p>&nbsp;</p><p><span>事务并发执行带来的问题：</span></p><ul><li><p><span>会产生多个事务同时存取同一数据的情况</span></p></li><li><p><span>可能会存取和存储不正确的数据，破坏事务隔离性和数据库的一致性</span></p></li></ul><p>&nbsp;</p><p><strong><span>事务是并发控制的基本单位</span></strong></p><p>&nbsp;</p><p><span>并发控制机制的任务：</span></p><ul><li><p><span>对并发操作进行正确调度</span></p></li><li><p><span>保证事务的隔离性</span></p></li><li><p><span>保证数据库的一致性</span></p></li></ul><p>&nbsp;</p><p><span>并发操作带来的数据不一致性：</span></p><ul><li><p><span>丢失修改：两个事务T1和T2读入同一数据并修改，T2的提交结果破坏了T1提交的结果，导致T1的修改被丢失</span></p></li><li><p><span>不可重复读：不可重复读是指事务T1读取数据后，事务T2执行更新操作，使T1无法再现前一次读取结果。</span></p></li><li><p><span>读“脏”数据：</span></p><ul><li><p><span>事务T1修改某一数据，并将其写回磁盘</span></p></li><li><p><span>事务T2读取同一数据后，T1由于某种原因被撤销</span></p></li><li><p><span>这时T1已修改过的数据恢复原值，T2读到的数据就与数据库中的数据不一致</span></p></li><li><p><span>T2读到的数据就为“脏”数据，即不正确的数据</span></p></li></ul></li></ul><p>&nbsp;</p><p><strong><span>数据不一致性：由于并发操作破坏了事务的隔离性</span></strong></p><p>&nbsp;</p><h2 id='封锁'><span>封锁</span></h2><p><span>封锁就是事务T在对某个数据对象（例如表、记录等）操作之前，先系统发出请求，对其加锁</span></p><p><span>加锁后事务T就对该数据对象有了一定的控制，在事务T释放它的锁之前，其它的事务不能更新此数据对象</span></p><p>&nbsp;</p><p><strong><span>封锁是实现并发控制的一个非常重要的技术</span></strong></p><p>&nbsp;</p><p><span>一个事务对某个数据对象加锁后究竟拥有什么样的控制由封锁的类型决定</span></p><p>&nbsp;</p><h3 id='基本封锁类型'><span>基本封锁类型</span></h3><h4 id='排它锁'><span>排它锁</span></h4><p><span>排它锁（Exclusive Locks，简记为X锁）</span></p><p><span>排它锁又称为写锁</span></p><p>&nbsp;</p><p><span>若事务T对数据对象A加上X锁，则只允许T读取和修改A，其它任何事务都不能再对A加任何类型的锁，直到T释放A上的锁</span></p><p><span>保证其他事务在T释放A上的锁之前不能再</span><strong><span>读取</span></strong><span>和</span><strong><span>修改</span></strong><span>A</span></p><p>&nbsp;</p><h4 id='共享锁'><span>共享锁</span></h4><p><span>共享锁（Share Locks，简记为S锁）</span></p><p><span>共享锁又称为读锁</span></p><p><span>若事务T对数据对象A加上S锁，则事务T可以读A但不能修改A，其它事务只能再对A加S锁，而不能加X锁，直到T释放A上的S锁</span></p><p><strong><span>保证其他事务可以读A</span></strong><span>，但在T释放A上的S锁之前不能对A做任何修改</span></p><p>&nbsp;</p><h3 id='锁的相容矩阵'><span>锁的相容矩阵</span></h3><p><img src="数据库系统概论/image-20240520140300737.png" referrerpolicy="no-referrer" alt="image-20240520140300737"></p><p>&nbsp;</p><h2 id='封锁协议'><span>封锁协议</span></h2><p><span>在运用X锁和S锁对数据对象加锁时，需要约定一些规则，这些规则为封锁协议（Locking Protocol）</span></p><ul><li><p><span>何时申请X锁或S锁</span></p></li><li><p><span>持锁时间</span></p></li><li><p><span>何时释放</span></p></li></ul><p>&nbsp;</p><p><span>对封锁方式规定不同的规则，就形成了各种不同的封锁协议，它们分别在不同的程度上为并发操作的正确调度提供一定的保证。</span></p><p>&nbsp;</p><ul><li><p><span>一级封锁协议</span></p></li><li><p><span>二级封锁协议</span></p></li><li><p><span>三级封锁协议</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><h3 id='一级封锁协议'><span>一级封锁协议</span></h3><p><span>事务T在修改数据R之前必须先对其加X锁，直到事务结束才释放</span></p><ul><li><p><span>正常结束（COMMIT）</span></p></li><li><p><span>非正常结束（ROLLBACK）</span></p></li></ul><p><span>一级封锁协议可防止丢失修改，并保证事务T是可恢复的。</span></p><p>&nbsp;</p><p><span>在一级封锁协议中，如果仅仅是读数据不对其进行修改，是不需要加锁的，所以它</span><strong><span>不能保证可重复读和不读“脏”数据</span></strong></p><p>&nbsp;</p><h3 id='二级封锁协议'><span>二级封锁协议</span></h3><p><span>在一级封锁协议的基础上，加上事务T在读取数据R之前必须先对其加S锁，读完后即可释放S锁</span></p><p>&nbsp;</p><p><strong><span>注意是读完就释放S锁</span></strong></p><p>&nbsp;</p><p><span>二级封锁协议可以防止丢失修改和读“脏”数据</span></p><p><span>在二级封锁协议中，</span><strong><span>由于读完数据后即可释放S锁，所以它不能保证可重复读</span></strong></p><p>&nbsp;</p><p>&nbsp;</p><h3 id='三级封锁协议'><span>三级封锁协议</span></h3><p><span>在一级封锁协议基础上，加上事务T在读取数据R之前必须先对其加S锁，直到事务结束才释放</span></p><p>&nbsp;</p><p><strong><span>注意是整个事务结束才会释放S锁</span></strong></p><p>&nbsp;</p><p><span>三级封锁协议可防止丢失修改、读脏数据和不可重复读</span></p><p>&nbsp;</p><h3 id='三级协议的区别'><span>三级协议的区别</span></h3><p><span>什么操作需要申请封锁以及何时释放锁（即持锁时间）</span></p><p><span>不同的封锁协议使事务达到的一致性级别不同：封锁协议级别越高，一致性程度越高</span></p><p><img src="数据库系统概论/image-20240520140743246.png" referrerpolicy="no-referrer" alt="image-20240520140743246"></p><p>&nbsp;</p><h2 id='活锁和死锁'><span>活锁和死锁</span></h2><p><span>封锁技术可以有效地解决并行操作的一致性问题，但也带来一些新的问题</span></p><p>&nbsp;</p><h3 id='活锁'><span>活锁</span></h3><p><img src="数据库系统概论/image-20240520141539484.png" referrerpolicy="no-referrer" alt="image-20240520141539484"></p><p>&nbsp;</p><p><span>避免活锁：采用先来先服务的策略</span></p><ol start='' ><li><p><span>当多个事务请求封锁同一数据对象时</span></p></li><li><p><span>按请求封锁的先后次序对这些事务排队</span></p></li><li><p><span>该数据对象上的锁一旦释放，首先批准申请队列中第一个事务获得锁</span></p></li></ol><p>&nbsp;</p><h3 id='死锁'><span>死锁</span></h3><p><img src="数据库系统概论/image-20240520141526298.png" referrerpolicy="no-referrer" alt="image-20240520141526298"></p><p>&nbsp;</p><p><span>两类方法:</span></p><ul><li><p><span>死锁的预防</span></p></li><li><p><span>死锁的诊断和消除</span></p></li></ul><p>&nbsp;</p><h4 id='死锁的预防'><span>死锁的预防</span></h4><p><span>产生死锁的原因是两个或多个事务都已封锁了一些数据对象，然后又都请求对已为其他事务封锁的数据对象加锁，从而出现死等待。</span></p><p>&nbsp;</p><p><span>预防死锁的发生就是要破坏产生死锁的条件</span></p><p>&nbsp;</p><p><span>预防死锁的方法：</span></p><ul><li><p><span>一次封锁法：要求每个事务必须一次将所有要使用的数据全部加锁，否则就不能继续执行</span></p><ul><li><p><span>存在的问题：</span></p><ul><li><p><span>降低系统并发度</span></p></li><li><p><span>难于事先精确确定封锁对象</span></p></li></ul></li></ul></li><li><p><span>顺序封锁法：顺序封锁法是预先对数据对象规定一个封锁顺序，所有事务都按这个顺序实行封锁。</span></p><ul><li><p><span>顺序封锁法存在的问题：</span></p><ul><li><p><span>维护成本：数据库系统中封锁的数据对象极多，并且随数据的插入、删除等操作而不断地变化，要维护这样的资源的封锁顺序非常困难，成本很高</span></p></li><li><p><span>难以实现：事务的封锁请求可以随着事务的执行而动态地决定，很难事先确定每一个事务要封锁哪些对象，因此也就很难按规定的顺序去施加封锁</span></p></li></ul></li></ul></li></ul><p>&nbsp;</p><p><span>结论：</span></p><p><span>在操作系统中广为采用的预防死锁的策略并不太适合数据库的特点</span></p><p><span>数据库管理系统在解决死锁的问题上更普遍采用的是诊断并解除死锁的方法</span></p><p>&nbsp;</p><h4 id='死锁的诊断与解除'><span>死锁的诊断与解除</span></h4><p>&nbsp;</p><h5 id='诊断'><span>诊断</span></h5><ol start='' ><li><p><span>超时法</span></p></li><li><p><span>等待图法</span></p></li></ol><p>&nbsp;</p><h6 id='超时法'><span>超时法</span></h6><p><span>超时法：如果一个事务的等待时间超过了规定的时限，就认为发生了死锁</span></p><p><span>优点：实现简单</span></p><p><span>缺点：</span></p><p><span>有可能误判死锁</span></p><p><span>时限若设置得太长，死锁发生后不能及时发现</span></p><p>&nbsp;</p><h6 id='等待图法'><span>等待图法</span></h6><p><img src="数据库系统概论/image-20240520143015065.png" referrerpolicy="no-referrer" alt="image-20240520143015065"></p><p><span>并发控制子系统周期性地（比如每隔数秒）生成事务等待图，检测事务。如果发现图中存在回路，则表示系统中出现了死锁</span></p><p>&nbsp;</p><h5 id='解除'><span>解除</span></h5><p><span>选择一个处理死锁代价最小的事务，将其撤消</span></p><p><span>释放此事务持有的所有的锁，使其它事务能继续运行下去</span></p><p>&nbsp;</p><h2 id='并发调度的可串行性'><span>并发调度的可串行性</span></h2><p><span>数据库管理系统对并发事务不同的调度可能会产生不同的结果</span></p><p><span>串行调度是正确的</span></p><p><span>执行结果等价于串行调度的调度也是正确的，称为可串行化调度</span></p><p>&nbsp;</p><p><span>注意：多种事务可能有多种串行调度的方案，只要某个事物的结果等于其中一次串行调度的方案就说明这个调度是正确的</span></p><p>&nbsp;</p><h3 id='可串行化调度'><span>可串行化调度</span></h3><p><span>多个事务的并发执行是正确的，当且仅当其结果与按某一次序串行地执行这些事务时的结果相同</span></p><p>&nbsp;</p><p><span>可串行性(Serializability)</span></p><ul><li><p><span>是并发事务正确调度的准则</span></p></li><li><p><span>一个给定的并发调度，当且仅当它是可串行化的，才认为是正确调度</span></p></li></ul><p>&nbsp;</p><h3 id='冲突可串行化调度'><span>冲突可串行化调度</span></h3><p><span>冲突可串行化：</span></p><ul><li><p><span>一个比可串行化更严格的条件</span></p></li><li><p><span>商用系统中的调度器采用</span></p></li></ul><p>&nbsp;</p><p><span>冲突操作：是指</span><strong><span>不同的事务</span></strong><span>对</span><strong><span>同一数据</span></strong><span>的</span><strong><span>读写</span></strong><span>操作和</span><strong><span>写写</span></strong><span>操作</span></p><ul><li><p><span>R</span><sub><span>i</span></sub><span> (x) 与 W</span><sub><span>j</span></sub><span> (x)</span></p></li><li><p><span>W</span><sub><span>i</span></sub><span> (x) 与 W</span><sub><span>j</span></sub><span> (x)</span></p></li></ul><p><span>其他操作是不冲突操作</span></p><p>&nbsp;</p><p><span>不能交换（Swap）的动作：</span></p><ul><li><p><span>同一事务的两个操作</span></p></li><li><p><span>不同事务的冲突操作</span></p></li></ul><p>&nbsp;</p><p><span>一个调度Sc在保证冲突操作的次序不变的情况下，通过交换两个事务不冲突操作的次序得到另一个调度Sc’，如果Sc’是串行的，称调度Sc是冲突可串行化的调度</span></p><p>&nbsp;</p><p><span>若一个调度是冲突可串行化，则一定是可串行化的调度</span></p><p><span>可用这种方法判断一个调度是否是冲突可串行化的</span></p><p>&nbsp;</p><p><span>[例11.3] 今有调度</span></p><p><img src="数据库系统概论/image-20240520143739913.png" referrerpolicy="no-referrer" alt="image-20240520143739913"></p><p><span>Sc2等价于一个串行调度T1，T2。所以Sc1冲突可串行化的调度</span></p><p><strong><span>图中是对不同资源的读操作和写操作，所以可以交换顺序</span></strong></p><p>&nbsp;</p><p><span>冲突可串行化调度是可串行化调度的充分条件，不是必要条件。还有不满足冲突可串行化条件的可串行化调度。</span></p><p>&nbsp;</p><h2 id='两段锁协议'><span>两段锁协议</span></h2><p><span>数据库管理系统普遍采用两段锁协议的方法实现并发调度的可串行性，从而保证调度的正确性</span></p><p>&nbsp;</p><p><span>两段锁协议是指所有事务必须分两个阶段对数据项加锁和解锁</span></p><ul><li><p><span>在对任何数据进行读、写操作之前，事务首先要获得对该数据的封锁</span></p></li><li><p><span>在释放一个封锁之后，事务不再申请和获得任何其他封锁</span></p></li></ul><p>&nbsp;</p><p><span>“两段”锁的含义：事务分为两个阶段</span></p><ul><li><p><span>第一阶段是获得封锁，也称为扩展阶段：事务可以申请获得任何数据项上的任何类型的锁，但是不能释放任何锁</span></p></li><li><p><span>第二阶段是释放封锁，也称为收缩阶段：事务可以释放任何数据项上的任何类型的锁，但是不能再申请任何锁</span></p></li></ul><p>&nbsp;</p><p><img src="数据库系统概论/image-20240520150057097.png" referrerpolicy="no-referrer" alt="image-20240520150057097"></p><p>&nbsp;</p><p><span>事务遵守两段锁协议是可串行化调度的充分条件，而不是必要条件</span></p><p><span>若并发事务都遵守两段锁协议，则对这些事务的任何并发调度策略都是可串行化的</span></p><p><span>若并发事务的一个调度是可串行化的，不一定所有事务都符合两段锁协议</span></p><p>&nbsp;</p><p><span>两段锁协议与防止死锁的一次封锁法：</span></p><p><span>一次封锁法要求每个事务必须一次将所有要使用的数据全部加锁，否则就不能继续执行，因此一次封锁法遵守两段锁协议</span></p><p><span>但是两段锁协议并不要求事务必须一次将所有要使用的数据全部加锁，因此遵守两段锁协议的事务可能发生死锁</span></p><p>&nbsp;</p><p><span>[例]遵守两段锁协议的事务发生死锁的情况：</span></p><p><img src="数据库系统概论/image-20240520150403133.png" referrerpolicy="no-referrer" alt="image-20240520150403133"></p><p>&nbsp;</p><h1 id='作业'><span>作业</span></h1><h2 id='第一次作业'><span>第一次作业</span></h2><h3 id='第一题'><span>第一题</span></h3><p><span>试述数据、数据库、数据库系统、数据库管理系统的概念。</span></p><p>&nbsp;</p><ol start='' ><li><p><span>数据（Data）：</span>
<span>数据是描述事物的符号记录，可以是数字、文字、图片、声音等多种形式。在计算机科学中，数据是指存储在某种介质上，能够被计算机程序处理的信息。</span></p></li><li><p><span>数据库（Database）：</span>
<span>数据库是一个按照数据结构来组织、存储和管理数据的仓库。它能够存储大量的数据，并提供快速的数据检索、更新和管理功能。数据库中的数据通常可以被多个应用程序共享，并且可以通过数据库管理系统（DBMS）来进行操作。</span></p></li><li><p><span>数据库系统（Database System）：</span>
<span>数据库系统是指数据库和数据库管理系统的组合。它是一个复杂的软件系统，用于存储、检索、管理和分析数据。数据库系统通常包括数据库、DBMS、应用程序、数据库管理员（DBA）和用户。</span></p></li><li><p><span>数据库管理系统（Database Management System, DBMS）：</span>
<span>数据库管理系统是一个软件，用于管理数据库的创建、维护、访问和控制。它提供了一种方法，使得用户和应用程序能够以一种统一和结构化的方式与数据库进行交互。DBMS负责处理数据的存储、检索、更新和删除操作，并确保数据的安全性和一致性。</span></p></li></ol><p><span>总的来叔，数据是信息的原始材料，数据库是用来存储和组织这些数据的容器，数据库系统是数据库和DBMS的结合体，而数据库管理系统则是用于管理数据库的软件，它使得用户能够高效地与数据库进行交互。</span></p><p>&nbsp;</p><h3 id='第二题'><span>第二题</span></h3><p><span>试述文件系统与数据库系统的区别和联系。</span></p><p>&nbsp;</p><p><span>文件系统与数据库系统都是用于存储、管理和检索数据的系统，但它们在设计理念、功能、性能和应用场景上存在显著的区别和联系。</span></p><p><strong><span>区别：</span></strong></p><ol start='' ><li><p><span>数据组织：</span></p><ul><li><p><span>文件系统以文件和目录的形式组织数据，适合存储非结构化或半结构化数据，如文本文件、图片、视频等。</span></p></li><li><p><span>数据库系统以表格、记录和字段的形式组织数据，适合存储结构化数据，如客户信息、交易记录等。</span></p></li></ul></li><li><p><span>数据冗余：</span></p><ul><li><p><span>文件系统可能导致数据冗余，因为不同的应用程序可能会创建自己的数据文件，导致相同数据的重复存储。</span></p></li><li><p><span>数据库系统通过数据 normalization（规范化）减少数据冗余，提高数据的一致性和完整性。</span></p></li></ul></li><li><p><span>数据独立性：</span></p><ul><li><p><span>文件系统中的数据通常与特定的应用程序紧密耦合，数据独立性较低。</span></p></li><li><p><span>数据库系统提供数据独立性，包括逻辑独立性和物理独立性，使得应用程序与数据的物理存储和逻辑结构解耦。</span></p></li></ul></li><li><p><span>数据访问：</span></p><ul><li><p><span>文件系统通常使用低级的数据访问方法，如文件读写操作，需要程序员编写详细的代码来管理数据。</span></p></li><li><p><span>数据库系统提供高级查询语言（如SQL）和数据操纵接口，简化了数据访问和操作。</span></p></li></ul></li><li><p><span>数据安全性和一致性：</span></p><ul><li><p><span>文件系统的安全性较低，通常依赖于操作系统的安全机制。</span></p></li><li><p><span>数据库系统提供了复杂的安全特性，如用户权限管理、事务控制、数据备份和恢复等，以确保数据的安全性和一致性。</span></p></li></ul></li></ol><p><strong><span>联系：</span></strong></p><ol start='' ><li><p><span>存储介质：</span></p><ul><li><p><span>文件系统和数据库系统都需要物理存储介质（如硬盘、SSD）来存储数据。</span></p></li></ul></li><li><p><span>数据管理：</span></p><ul><li><p><span>两者都提供了数据的存储、检索、更新和删除功能。</span></p></li></ul></li><li><p><span>应用支持：</span></p><ul><li><p><span>文件系统和数据库系统都可以被应用程序用来支持数据的持久化。</span></p></li></ul></li></ol><p><span>在实际应用中，文件系统适合处理简单的数据存储需求，尤其是当数据量不大、数据结构不复杂时。而数据库系统则更适合处理大规模、复杂、需要高度一致性和安全性的数据管理任务。</span></p><p>&nbsp;</p><h3 id='第三题'><span>第三题</span></h3><p><span>数据库管理系统的主要功能有哪些?</span></p><p>&nbsp;</p><p><span>数据库管理系统（DBMS）的主要功能包括以下几个方面：</span></p><ol start='' ><li><p><span>数据定义：</span></p><ul><li><p><span>DBMS提供数据定义语言（DDL），允许用户定义数据库的结构，包括创建表格、定义字段（列）、数据类型、键（如主键、外键）以及索引等。</span></p></li></ul></li><li><p><span>数据操纵：</span></p><ul><li><p><span>DBMS提供数据操纵语言（DML），允许用户对数据库中的数据进行增删改查（CRUD）操作。这些操作通常通过SQL（结构化查询语言）语句来实现。</span></p></li></ul></li><li><p><span>数据查询：</span></p><ul><li><p><span>DBMS提供查询语言（通常是SQL），允许用户编写复杂的查询来检索数据库中的数据。查询可以是一个简单的数据检索操作，也可以是一个涉及多个表和条件的复杂操作。</span></p></li></ul></li><li><p><span>数据安全：</span></p><ul><li><p><span>DBMS提供安全机制来保护数据不受未授权访问。这包括用户身份验证、访问控制（如权限和角色管理）、加密和审计等功能。</span></p></li></ul></li><li><p><span>数据完整性：</span></p><ul><li><p><span>DBMS确保数据的完整性和一致性。它通过实施实体完整性、参照完整性等约束来实现。此外，DBMS还支持事务管理，确保一组操作要么全部成功，要么全部失败，以此来维护数据库的一致性。</span></p></li></ul></li><li><p><span>数据并发：</span></p><ul><li><p><span>DBMS允许多个用户或应用程序同时访问数据库。为了处理并发操作可能带来的问题（如数据冲突和不一致），DBMS实现了锁定机制、事务隔离级别和并发控制协议。</span></p></li></ul></li><li><p><span>数据恢复：</span></p><ul><li><p><span>DBMS提供数据恢复功能，以防数据丢失或损坏。这通常通过日志记录、备份和恢复点等机制来实现。</span></p></li></ul></li><li><p><span>性能优化：</span></p><ul><li><p><span>DBMS包括优化器，它分析查询并选择最有效的数据访问路径。此外，DBMS还可能提供缓存机制、索引和查询优化建议来提高性能。</span></p></li></ul></li><li><p><span>数据库监控和调优：</span></p><ul><li><p><span>DBMS提供工具和实用程序来监控数据库的性能，识别瓶颈，并进行调优以提高系统性能。</span></p></li></ul></li><li><p><span>复制和分布式处理：</span></p><ul><li><p><span>高级DBMS支持数据复制和数据分布，允许在不同的地理位置存储数据的副本，或者将数据分散在不同的服务器上，以提高可用性和性能。</span></p></li></ul></li></ol><p><span>上面这些功能是DBMS的核心特性，它们共同工作，使得数据库系统能够高效、可靠地管理大量数据，并支持复杂的业务应用。</span></p><p>&nbsp;</p><h3 id='第四题'><span>第四题</span></h3><p><span>试述关系模型的概念，定义并解释以下术语： ( 1 ）关系（ 2 ）属性（ 3 ）域（ 4 ）元组 ( 5 ）主码（ 6 ）分量（ 7 ）关系模式</span></p><p>&nbsp;</p><p><span>关系模型是数据库模型的一种，由E.F. Codd在1970年提出，是目前最广泛使用的数据库模型。关系模型使用表格的形式来表示数据和数据之间的关系。关系模型是一种用于表示实体之间关系的数据库模型。它基于数学概念，特别是集合论和谓词逻辑。在关系模型中，数据以表格的形式组织，每个表格称为一个关系，而表中的每一行代表一个元组（记录），每一列代表一个属性（字段）。关系模型是现代数据库系统的基础，被广泛应用于各种数据库管理系统中。它为数据管理提供了一种结构化和标准化的方法，支持事务处理、查询优化和并发控制等功能，以满足不同应用场景的需求。</span></p><p><span>定义并解释以下术语：</span></p><ol start='' ><li><p><span>关系（Relation）：</span>
<span>在关系模型中，关系是一个表格，用于表示实体集和实体集之间的联系。每个关系都有一个唯一的名称。关系中的数据是以行和列的形式组织的，其中每一行代表一个记录，每一列代表一个字段。</span></p></li><li><p><span>属性（Attribute）：</span>
<span>属性是关系表中的列，它代表实体的某个特征或属性。每个属性都有一个名称，用于描述它所存储的数据。例如，在学生信息表中，学号、姓名和年龄都可以是属性。</span></p></li><li><p><span>域（Domain）：</span>
<span>域是属性可以取值的范围，即属性的数据类型。例如，如果一个属性的域是整数，那么这个属性只能取整数值。域限制了属性的取值范围，保证了数据的类型安全。</span></p></li><li><p><span>元组（Tuple）：</span>
<span>元组是关系表中的一行，它包含了一个记录的所有数据。每个元组由多个属性值组成，这些属性值对应于关系表中的列。元组用于表示实体集中的一个实体。</span></p></li><li><p><span>主码（Primary Key）：</span>
<span>主码是关系表中的一个或多个属性，用于唯一地标识表中的每个元组。主码的值在表中必须是唯一的，不能有重复。通过主码，可以确保表中每个记录的唯一性，并且可以快速地访问和操作数据。</span></p></li><li><p><span>分量（Component）：</span>
<span>分量是指元组中每个属性的值。例如，如果一个元组有3个属性，那么这个元组就有3个分量，分别对应这3个属性的值。</span></p></li><li><p><span>关系模式（Relation Schema）：</span>
<span>关系模式是对关系的结构描述，它定义了关系的名称、属性以及属性对应的域。关系模式是关系的一个框架，它不包含具体的数据，只是定义了数据的组织形式。关系模式通常用以下格式表示：</span>
<span>关系名(属性1, 属性2, ..., 属性n)</span>
<span>例如，学生信息的关系模式可以表示为：</span>
<span>学生(学号, 姓名, 年龄, 性别)</span></p></li></ol><p><span>总结来说，关系模型使用表格的形式来表示数据，关系是表格，属性是列，域是属性值的范围，元组是行，主码是唯一标识元组的属性，分量是元组中属性的值，关系模式是表格的结构定义。</span></p><p>&nbsp;</p><h3 id='第五题'><span>第五题</span></h3><p><span>定义并解释以下术语：模式、外模式、内模式、 DDL 、 DML 。</span></p><p>&nbsp;</p><p><span>术语的定义和解释：</span></p><ol start='' ><li><p><span>模式（Schema）：</span>
<span>模式是数据库中所有数据的逻辑结构和特征的描述，它定义了数据库中数据的组织、数据类型、关系、约束等。模式是数据库设计的一部分，它是由数据库管理员（DBA）或设计者定义的，并且对用户通常是不可见的。模式位于数据库系统的中间层，它介于外模式和内模式之间，是数据库的全局逻辑视图。</span></p></li><li><p><span>外模式（External Schema）：</span>
<span>外模式也称为子模式（Subschema）或用户模式，它是数据库用户看到和使用的局部数据的逻辑表示。外模式是模式的一个子集，它定义了用户可以看到和操作的数据。不同的用户或应用程序可以有不同的外模式，这些外模式基于它们对数据的特定需求。外模式提供了数据抽象，使得用户不需要关心数据库的全局结构和其它用户的数据。</span></p></li><li><p><span>内模式（Internal Schema）：</span>
<span>内模式是数据库的物理表示或内部视图，它描述了数据在存储介质上的存储方式和物理结构。内模式包括数据的存储格式、索引机制、数据压缩等技术细节。内模式对用户和应用程序是不可见的，它由数据库管理系统（DBMS）管理，用于优化数据的存储和访问效率。</span></p></li><li><p><span>DDL（Data Definition Language）：</span>
<span>DDL是一种用于定义和描述数据库中数据的语言。它允许用户定义数据库的结构，包括创建表格、定义字段、设置数据类型、创建索引等。DDL语句通常包括CREATE、DROP和ALTER等关键字。DDL主要用于数据库设计和数据库维护。</span></p></li><li><p><span>DML（Data Manipulation Language）：</span>
<span>DML是一种用于查询、插入、更新和删除数据库中数据的语言。它包括了一组操作符，这些操作符允许用户对数据库中的数据进行增删改查（CRUD）操作。DML语句通常包括SELECT、INSERT、UPDATE和DELETE等关键字。DML主要用于数据管理和应用程序开发。</span></p></li></ol><p><span>总结来说，模式是数据库的逻辑结构，外模式是用户看到的数据视图，内模式是数据的物理存储结构。DDL用于定义数据库结构，而DML用于操作数据库中的数据。这些术语共同构成了数据库设计和使用的基础概念。</span></p><p>&nbsp;</p><h2 id='第二次作业'><span>第二次作业</span></h2><h3 id='第一题-2'><span>第一题</span></h3><p><span>定义并理解下列术语，说明它们之间的联系与区别：</span></p><p><span>（1）域，关系，元组，属性</span></p><p><span>（2）主码，候选码，外部码</span></p><p><span>（3）关系模式，关系，关系数据库</span></p><p>&nbsp;</p><p><span>第一组</span></p><p><strong><span>定义：</span></strong></p><ol start='' ><li><p><span>域（Domain）：</span>
<span>域是一组具有相同数据类型的值的集合。它定义了属性可以取值的范围。例如，整数域包含了所有可能的整数值，字符串域包含了所有可能的字符串值。</span></p></li><li><p><span>关系（Relation）：</span>
<span>在关系模型中，关系是一个表格，用于表示实体集和实体集之间的联系。每个关系都有一个唯一的名称。关系中的数据是以行和列的形式组织的，其中每一行代表一个记录，每一列代表一个字段。</span></p></li><li><p><span>元组（Tuple）：</span>
<span>元组是关系表中的一行，它包含了一个记录的所有数据。每个元组由多个属性值组成，这些属性值对应于关系表中的列。元组用于表示实体集中的一个实体。</span></p></li><li><p><span>属性（Attribute）：</span>
<span>属性是关系表中的列，它代表实体的某个特征或属性。每个属性都有一个名称，用于描述它所存储的数据。例如，在学生信息表中，学号、姓名和年龄都可以是属性。</span></p></li></ol><p><strong><span>联系与区别：</span></strong></p><ul><li><p><span>域定义了属性可以取值的范围，它是属性值的类型和取值范围的集合。属性是关系表中的列，它的值必须来自定义的域。</span></p></li><li><p><span>关系是由元组和属性组成的表格。元组是关系中的行，它包含了多个属性值。属性是关系中的列，它定义了元组中每个位置的值的含义。</span></p></li><li><p><span>元组是关系中的单个记录，它由多个属性值组成，每个属性值对应于关系中的一个属性。元组是属性值的组合，而属性是元组中的单个数据项。</span></p></li></ul><p><span>总结来说，域是属性值的类型和取值范围的集合，属性是关系表中的列，元组是关系表中的行，关系是由元组和属性组成的表格。域限制了属性的取值范围，属性定义了元组中每个位置的值的含义，而元组是属性值的组合，用于表示实体集中的一个实体。</span></p><p>&nbsp;</p><p><span>第二组</span></p><p><strong><span>定义：</span></strong></p><ol start='' ><li><p><span>主码（Primary Key）：</span>
<span>主码是关系表中的一个或多个属性，用于唯一地标识表中的每个元组。在一个关系表中，主码的值必须是唯一的，不能有重复。主码的选择通常基于业务需求和对实体的理解。每个关系表都必须有一个主码，它是表定义的一部分，并且用于确保表中每个记录的唯一性。</span></p></li><li><p><span>候选码（Candidate Key）：</span>
<span>候选码是关系表中的一个属性或属性组，它可以唯一地标识表中的每个元组。在一个关系表中，可能有多个候选码，因为可能有多个属性或属性组合都能唯一地标识元组。候选码是主码的候选者，数据库设计者会从候选码中选择一个作为主码。</span></p></li><li><p><span>外部码（Foreign Key）：</span>
<span>外部码是关系表中的一个属性或属性组，它在当前关系中不是主码或候选码，但它与另一个关系的主码相对应。外部码用于建立两个关系之间的联系，它在一个关系中引用了另一个关系的主码。外部码的值可以是参照的主码的有效值，或者是空值。</span></p></li></ol><p><strong><span>联系与区别：</span></strong></p><ul><li><p><span>主码和候选码都是用于唯一标识关系表中元组的属性或属性组合。每个关系表都必须有一个主码，而候选码是主码的候选者，可能有一个或多个。</span></p></li><li><p><span>主码是从候选码中选择出来的，用于实际的数据库操作和完整性约束。候选码是所有可能的候选者，它们都满足唯一标识元组的条件。</span></p></li><li><p><span>外部码是用于建立关系之间联系的属性，它引用了另一个关系的主码。外部码的值必须是参照的主码的有效值，或者是空值，这维持了参照完整性。</span></p></li></ul><p><span>总结来说，主码和候选码用于唯一标识关系表中的元组，而外部码用于建立不同关系之间的联系。主码是候选码的一个特例，用于实际的数据库操作，而外部码是用于参照完整性约束的属性，它引用了另一个关系的主码。</span></p><p>&nbsp;</p><p><span>第三组</span></p><p><strong><span>定义：</span></strong></p><ol start='' ><li><p><span>关系模式（Relation Schema）：</span>
<span>关系模式是对关系的结构的描述，它定义了关系的名称、属性以及属性对应的域。关系模式是关系的一个框架，它不包含具体的数据，只是定义了数据的组织形式。关系模式通常用以下格式表示：</span>
<span>关系名(属性1, 属性2, ..., 属性n)</span>
<span>例如，学生信息的关系模式可以表示为：</span>
<span>学生(学号, 姓名, 年龄, 性别)</span></p></li><li><p><span>关系（Relation）：</span>
<span>在关系模型中，关系是一个表格，用于表示实体集和实体集之间的联系。每个关系都有一个唯一的名称。关系中的数据是以行和列的形式组织的，其中每一行代表一个记录，每一列代表一个字段。关系是关系模式的一个实例，它包含了具体的数据。</span></p></li><li><p><span>关系数据库（Relational Database）：</span>
<span>关系数据库是建立在关系模型基础上的数据库，它由多个关系组成。每个关系都遵循特定的关系模式，并且数据库中的数据是以表格的形式存储的。关系数据库管理系统（RDBMS）提供了对关系数据库的创建、维护、查询和更新等操作的支持。</span></p></li></ol><p><strong><span>联系与区别：</span></strong></p><ul><li><p><span>关系模式定义了关系的结构，包括关系的名称、属性和域，它是一个框架或蓝图，不包含具体的数据。</span></p></li><li><p><span>关系是关系模式的一个实例，它包含了具体的数据。关系是根据关系模式定义的结构来组织数据的表格。</span></p></li><li><p><span>关系数据库是由多个关系组成的集合，它是一个包含多个表格的数据库系统。每个表格都遵循一个关系模式，并且数据库管理系统提供了对这些表格的维护和操作功能。</span></p></li></ul><p><span>总结来说，关系模式是对关系结构的定义，关系是关系模式的具体实例，而关系数据库是由多个关系组成的数据库系统。关系模式定义了数据的组织形式，关系包含了具体的数据，而关系数据库是一个包含多个关系的集合，它使用关系模型来存储和管理数据。</span></p><p>&nbsp;</p><h3 id='第二题-2'><span>第二题</span></h3><p><span>试述关系模型的完整性规则。在参照完整性中，为什么外部码属性的值也可以为空？什么情况下才可以为空？</span></p><p>&nbsp;</p><p><span>关系模型的完整性规则确保数据库中的数据满足特定的语义约束，从而保证数据的准确性和一致性。主要的完整性规则包括实体完整性、参照完整性和用户定义的完整性。</span></p><ol start='' ><li><p><span>实体完整性（Entity Integrity）：</span>
<span>实体完整性要求关系中的每个主键值必须是唯一的，且不能为空（NULL）。主键是用于唯一标识关系中每个元组的属性或属性集。实体完整性确保了关系中的每个元组都能通过主键被唯一地识别。</span></p></li><li><p><span>参照完整性（Referential Integrity）：</span>
<span>参照完整性维护关系之间引用的一致性。当关系中的某个属性（或属性集）是另一个关系的主键时，这个属性被称为外键。参照完整性规则要求外键的值必须是参照的主键的有效值，或者是空值。这意味着如果关系R1的一个属性集是关系R2的主键，那么在R1中出现的这个属性集的值必须在R2中存在。</span></p></li><li><p><span>用户定义的完整性（User-Defined Integrity）：</span>
<span>用户定义的完整性包括任何数据库设计者或用户指定的特定于应用的约束。这些约束可以是属性值范围的限制、属性之间的比较、复杂的业务规则等。例如，可以定义一个年龄属性必须大于0，或者一个订单日期不能早于产品发布日期等约束。</span></p></li></ol><p><span>这些完整性规则在数据库设计和操作中起着关键作用，它们有助于防止不合法的数据进入数据库，确保数据的逻辑一致性和正确性。数据库管理系统通常提供了机制来自动检查和执行这些完整性约束，从而减轻了应用程序开发者的负担。</span></p><p><span>在参照完整性中，外部码（外键）属性的值可以为空，是因为外键可能引用的实体可能还不存在或者不是必须存在的。这种情况通常出现在关系的弱实体中，或者在某些业务场景下，允许某些数据在一段时间内不必与另一个实体关联。</span>
<span>以下是一些外键可以为空的情况：</span></p><ol start='' ><li><p><span>非强制关系：</span></p><ul><li><p><span>当两个实体之间的关系是非强制的时候，即不是所有的相关实体都必须存在关联的另一方，外键可以为空。例如，一个顾客可能还没有下任何订单，那么在订单表中，该顾客的外键可以为空。</span></p></li></ul></li><li><p><span>分阶段数据输入：</span></p><ul><li><p><span>在某些业务流程中，数据可能分阶段输入。在第一阶段，可能只有部分信息被输入，而与其它表的外键关联信息尚未确定，这时外键可以为空。</span></p></li></ul></li><li><p><span>可选依赖：</span></p><ul><li><p><span>如果一个实体对另一个实体的依赖是可选的，那么外键可以为空。例如，一个人可能有多个电话号码，但不是必须都有，那么在电话号码表中，人的外键可以为空。</span></p></li></ul></li><li><p><span>弱实体：</span></p><ul><li><p><span>在数据库设计中，弱实体是指它的存在依赖于另一个实体（即强实体）。弱实体通常通过外键与强实体相关联，但如果弱实体在某个时刻没有对应的强实体，它的外键可以为空。</span></p></li></ul></li></ol><p><span>不过需要注意的是，外键可以为空并不意味着它可以随意为空。在设计数据库时，应该根据实际情况来决定外键是否可以为空，并在数据库模式中明确声明。数据库管理系统会根据这些规则来检查数据的完整性，确保外键的值在允许为空的情况下才是合法的。</span></p><p>&nbsp;</p><h3 id='第三题-2'><span>第三题</span></h3><p><strong><span>供应商表 S (SNO, SNAME, STATUS, CITY)</span></strong></p><ul><li><p><span>SNO：供应商代码</span></p></li><li><p><span>SNAME：供应商姓名</span></p></li><li><p><span>STATUS：供应商状态</span></p></li><li><p><span>CITY：供应商所在城市</span>
<strong><span>零件表 P (PNO, PNAME, COLOR, WEIGHT)</span></strong></p></li><li><p><span>PNO：零件代码</span></p></li><li><p><span>PNAME：零件名</span></p></li><li><p><span>COLOR：颜色</span></p></li><li><p><span>WEIGHT：重量</span>
<strong><span>工程项目表 J (JNO, JNAME, CITY)</span></strong></p></li><li><p><span>JNO：工程项目代码</span></p></li><li><p><span>JNAME：工程项目名</span></p></li><li><p><span>CITY：工程项目所在城市</span>
<strong><span>供应情况表 SPJ (SNO, PNO, JNO, QTY)</span></strong></p></li><li><p><span>SNO：供应商代码</span></p></li><li><p><span>PNO：零件代码</span></p></li><li><p><span>JNO：工程项目代码</span></p></li><li><p><span>QTY：供应数量（表示某供应商供应某种零件给某工程项目的数量为 QTY）</span></p></li></ul><p><img src="数据库系统概论/image-20240409222011575.png" referrerpolicy="no-referrer" alt="image-20240409222011575"></p><p><span>试用关系代数完成下列操作：</span></p><ol start='' ><li><p><span>求供应工程 J1 零件的供应商号SNO。</span></p></li><li><p><span>求供应工程 J1 零件P1 的供应商号SNO。</span></p></li><li><p><span>求供应工程 J1 红色零件的供应商号SNO。</span></p></li><li><p><span>求没有使用天津供应商生产的红色零件的工程号 JNO。</span></p></li><li><p><span>求至少用了 S1 供应商所供应的全部零件的工程号JNO。</span></p></li></ol><p>&nbsp;</p><p><img src="数据库系统概论/image-20240411152826040.png" referrerpolicy="no-referrer" alt="image-20240411152826040"></p><p>&nbsp;</p><ol start='' ><li><p><span>πSno(σSno=‘J1’（SPJ）)</span></p></li><li><p><span>πSno(σSno=‘J1’∧Pno=‘P1‘(SPJ))</span></p></li><li><p><span>πSno(σPno=‘P1‘ （σCOLOR=’红‘ （P）∞SPJ）)</span></p></li><li><p><span>πJno(SPJ)- πJNO（σcity=‘天津’∧Color=‘红‘ （S∞SPJ∞P）)</span></p></li><li><p><span>πJno，Pno(SPJ)÷ πPno（σSno=‘S1‘ （SPJ））</span></p></li></ol><p>&nbsp;</p><h3 id='第四题-2'><span>第四题</span></h3><p><span>试述等值连接与自然连接的区别和联系。</span></p><p>&nbsp;</p><p><span>等值连接（Equi-join）和自然连接（Natural join）是两种不同的关系表连接操作，它们在 SQL 中用于将两个或多个表的行基于某些条件组合起来。</span></p><p><span>下面是它们的定义、区别和联系：</span></p><p><span>等值连接（Equi-join）：</span></p><p><span>等值连接是指基于两个表中的列之间的等值条件来连接表的连接操作。在等值连接中，用户需要明确指定哪些列之间的值相等，这些列通常是有相同数据类型和语义的相关列。等值连接可以使用“=”运算符来指定连接条件。</span></p><p><span>例如，假设有两个表：订单（Orders）和客户（Customers），它们都有一个共同的列CustomerID。要连接这两个表，可以使用等值连接：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> Orders</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">JOIN</span> Customers <span class="cm-keyword">ON</span> Orders<span class="cm-variable-2">.CustomerID</span> <span class="cm-operator">=</span> Customers<span class="cm-variable-2">.CustomerID</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>自然连接（Natural join）：</span></p><p><span>自然连接是一种特殊的等值连接，它不需要用户指定连接条件，它会自动找到两个表中具有相同名称和数据类型的列，并基于这些列进行等值连接。自然连接还会去除结果中的重复列。自然连接通常用于连接具有相同列名的列。</span></p><p><span>例如，使用自然连接连接上面的订单和客户表：</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> Orders</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">NATURAL</span> <span class="cm-keyword">JOIN</span> Customers<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>区别和联系：</span></p><ol start='' ><li><p><span>连接条件：</span></p><ul><li><p><span>等值连接需要用户明确指定连接条件，而自然连接会自动找到具有相同名称和数据类型的列进行连接。</span></p></li></ul></li><li><p><span>重复列：</span></p><ul><li><p><span>自然连接会去除结果中的重复列，只保留一个列，而等值连接不会去除重复列，结果中会包含所有列的值。</span></p></li></ul></li><li><p><span>显式性：</span></p><ul><li><p><span>等值连接更加显式，用户可以控制哪些列用于连接，而自然连接则是一种隐式的连接方式，由数据库系统自动处理。</span></p></li></ul></li><li><p><span>用法：</span></p><ul><li><p><span>当两个表有多个列具有相同的名称和数据类型时，自然连接更加方便，因为它减少了指定连接条件的需要。当需要基于特定的列进行连接时，等值连接更加适用。</span></p></li></ul></li></ol><p><span>总结来说，等值连接和自然连接都是用于基于列之间的等值条件连接表的 SQL 操作。等值连接需要用户指定连接条件，而自然连接会自动找到相同名称和数据类型的列进行连接，并且会去除结果中的重复列。根据具体的需要和表的结构，可以选择使用等值连接或自然连接。</span></p><p>&nbsp;</p><h2 id='第三次作业'><span>第三次作业</span></h2><h3 id='第一题-3'><span>第一题</span></h3><p><span>有两个关系S（A,B,C,D)和T（C,D,E,F），写出与下列查询等价的SQL表达式：</span></p><p><span>σ</span><sub><span>A=10</span></sub><span>(S)</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> S</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> A<span class="cm-operator">=</span><span class="cm-number">10</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.963ex" height="2.353ex" role="img" focusable="false" viewBox="0 -750 3519.6 1039.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.656ex;"><defs><path id="MJX-8-TEX-N-3A0" d="M128 619Q121 626 117 628T101 631T58 634H25V680H724V634H691Q651 633 640 631T622 619V61Q628 51 639 49T691 46H724V0H713Q692 3 569 3Q434 3 425 0H414V46H447Q489 47 498 49T517 61V634H232V348L233 61Q239 51 250 49T302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V619Z"></path><path id="MJX-8-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-8-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-8-TEX-I-1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path id="MJX-8-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-8-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-8-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="3A0" xlink:href="#MJX-8-TEX-N-3A0"></use></g><g data-mml-node="TeXAtom" transform="translate(783,-152.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-8-TEX-I-1D434"></use></g><g data-mml-node="mo" transform="translate(750,0)"><use data-c="2C" xlink:href="#MJX-8-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1028,0)"><use data-c="1D435" xlink:href="#MJX-8-TEX-I-1D435"></use></g></g></g><g data-mml-node="mo" transform="translate(2096.6,0)"><use data-c="28" xlink:href="#MJX-8-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(2485.6,0)"><use data-c="1D446" xlink:href="#MJX-8-TEX-I-1D446"></use></g><g data-mml-node="mo" transform="translate(3130.6,0)"><use data-c="29" xlink:href="#MJX-8-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Π</mi><mrow data-mjx-texclass="ORD"><mi>A</mi><mo>,</mo><mi>B</mi></mrow></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">\Pi_{A,B}(S)</script></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-keyword">DISTINCT</span> A<span class="cm-punctuation">,</span>B</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> S<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>S ⟗ T</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> A<span class="cm-punctuation">,</span>B<span class="cm-punctuation">,</span>S<span class="cm-variable-2">.C</span><span class="cm-punctuation">,</span>S<span class="cm-variable-2">.D</span><span class="cm-punctuation">,</span>E<span class="cm-punctuation">,</span>F</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> S<span class="cm-punctuation">,</span>T</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> S<span class="cm-variable-2">.C</span><span class="cm-operator">=</span>T<span class="cm-variable-2">.C</span> <span class="cm-keyword">AND</span> S<span class="cm-variable-2">.D</span><span class="cm-operator">=</span>T<span class="cm-variable-2">.D</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="11.033ex" height="3.469ex" role="img" focusable="false" viewBox="0 -705 4876.5 1533.5" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.874ex;"><defs><path id="MJX-9-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-9-TEX-N-22C8" d="M833 50T833 250T832 450T659 351T487 250T658 150T832 50Q833 50 833 250ZM873 10Q866 -5 854 -5Q851 -5 845 -3L449 226L260 115Q51 -5 43 -5Q39 -5 35 -1T28 7L26 11V489Q33 505 43 505Q51 505 260 385L449 274L845 503Q851 505 853 505Q866 505 873 490V10ZM412 250L67 450Q66 450 66 250T67 50Q69 51 240 150T412 250Z"></path><path id="MJX-9-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-9-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-9-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-9-TEX-I-1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-9-TEX-I-1D446"></use></g><g data-mml-node="munder" transform="translate(922.8,0)"><g data-mml-node="mo" transform="translate(1036,0)"><use data-c="22C8" xlink:href="#MJX-9-TEX-N-22C8"></use></g><g data-mml-node="mrow" transform="translate(0,-670.5) scale(0.707)"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-9-TEX-I-1D446"></use></g><g data-mml-node="mo" transform="translate(645,0)"><use data-c="2E" xlink:href="#MJX-9-TEX-N-2E"></use></g><g data-mml-node="mi" transform="translate(923,0)"><use data-c="1D436" xlink:href="#MJX-9-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(1683,0)"><use data-c="3D" xlink:href="#MJX-9-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(2461,0)"><use data-c="1D447" xlink:href="#MJX-9-TEX-I-1D447"></use></g><g data-mml-node="mo" transform="translate(3165,0)"><use data-c="2E" xlink:href="#MJX-9-TEX-N-2E"></use></g><g data-mml-node="mi" transform="translate(3443,0)"><use data-c="1D436" xlink:href="#MJX-9-TEX-I-1D436"></use></g></g></g><g data-mml-node="mi" transform="translate(4172.5,0)"><use data-c="1D447" xlink:href="#MJX-9-TEX-I-1D447"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><munder><mo>⋈</mo><mrow><mi>S</mi><mo>.</mo><mi>C</mi><mo>=</mo><mi>T</mi><mo>.</mo><mi>C</mi></mrow></munder><mi>T</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">S \underset{S.C=T.C}\Join T</script></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> S<span class="cm-punctuation">,</span>T</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> S<span class="cm-variable-2">.C</span><span class="cm-operator">=</span>T<span class="cm-variable-2">.C</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.976ex" height="3.42ex" role="img" focusable="false" viewBox="0 -705 3525.2 1511.6" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.825ex;"><defs><path id="MJX-10-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-10-TEX-N-22C8" d="M833 50T833 250T832 450T659 351T487 250T658 150T832 50Q833 50 833 250ZM873 10Q866 -5 854 -5Q851 -5 845 -3L449 226L260 115Q51 -5 43 -5Q39 -5 35 -1T28 7L26 11V489Q33 505 43 505Q51 505 260 385L449 274L845 503Q851 505 853 505Q866 505 873 490V10ZM412 250L67 450Q66 450 66 250T67 50Q69 51 240 150T412 250Z"></path><path id="MJX-10-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-10-TEX-N-3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path><path id="MJX-10-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-10-TEX-I-1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-10-TEX-I-1D446"></use></g><g data-mml-node="munder" transform="translate(922.8,0)"><g data-mml-node="mo" transform="translate(360.3,0)"><use data-c="22C8" xlink:href="#MJX-10-TEX-N-22C8"></use></g><g data-mml-node="mrow" transform="translate(0,-678.3) scale(0.707)"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-10-TEX-I-1D434"></use></g><g data-mml-node="mo" transform="translate(750,0)"><use data-c="3C" xlink:href="#MJX-10-TEX-N-3C"></use></g><g data-mml-node="mi" transform="translate(1528,0)"><use data-c="1D438" xlink:href="#MJX-10-TEX-I-1D438"></use></g></g></g><g data-mml-node="mi" transform="translate(2821.2,0)"><use data-c="1D447" xlink:href="#MJX-10-TEX-I-1D447"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><munder><mo>⋈</mo><mrow><mi>A</mi><mo>&lt;</mo><mi>E</mi></mrow></munder><mi>T</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">S \underset{A<E}\Join T</script></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> S<span class="cm-punctuation">,</span>T</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> A<span class="cm-operator">&lt;</span>E<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="12.448ex" height="2.347ex" role="img" focusable="false" viewBox="0 -750 5501.9 1037.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.65ex;"><defs><path id="MJX-11-TEX-N-3A0" d="M128 619Q121 626 117 628T101 631T58 634H25V680H724V634H691Q651 633 640 631T622 619V61Q628 51 639 49T691 46H724V0H713Q692 3 569 3Q434 3 425 0H414V46H447Q489 47 498 49T517 61V634H232V348L233 61Q239 51 250 49T302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V619Z"></path><path id="MJX-11-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-11-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-11-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-11-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-11-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-11-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-11-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-11-TEX-I-1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="3A0" xlink:href="#MJX-11-TEX-N-3A0"></use></g><g data-mml-node="TeXAtom" transform="translate(783,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-11-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(760,0)"><use data-c="2C" xlink:href="#MJX-11-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(1038,0)"><use data-c="1D437" xlink:href="#MJX-11-TEX-I-1D437"></use></g></g></g><g data-mml-node="mo" transform="translate(2152.5,0)"><use data-c="28" xlink:href="#MJX-11-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(2541.5,0)"><use data-c="1D446" xlink:href="#MJX-11-TEX-I-1D446"></use></g><g data-mml-node="mo" transform="translate(3186.5,0)"><use data-c="29" xlink:href="#MJX-11-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3797.7,0)"><use data-c="D7" xlink:href="#MJX-11-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(4797.9,0)"><use data-c="1D447" xlink:href="#MJX-11-TEX-I-1D447"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">Π</mi><mrow data-mjx-texclass="ORD"><mi>C</mi><mo>,</mo><mi>D</mi></mrow></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>×</mo><mi>T</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">\Pi_{C,D}(S) \times T</script></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> S1<span class="cm-variable-2">.C</span><span class="cm-punctuation">,</span>S1<span class="cm-variable-2">.D</span><span class="cm-punctuation">,</span>T<span class="cm-variable-2">.C</span><span class="cm-punctuation">,</span>T<span class="cm-variable-2">.D</span><span class="cm-punctuation">,</span>E<span class="cm-punctuation">,</span>F</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> T<span class="cm-punctuation">,</span><span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-keyword">DISTINCT</span> C<span class="cm-punctuation">,</span>D</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">FROM</span> S<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">AS</span> S1<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='第二题-3'><span>第二题</span></h3><p><span>习题3.5：针对习题 4 中的 4 个表，试用 SQL 言完成以下各项操作：只需要做课本中的（2、4、5、7、8、9、10、11）</span></p><p><img src="数据库系统概论/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1bW1lcl9fa2traw==,size_16,color_FFFFFF,t_70.png" referrerpolicy="no-referrer" alt="img"></p><ol start='2' ><li><p><span>找出所有零件的名称、颜色、重量；</span></p></li><li><p><span>找出工程项目 J2 使用的各种零件的名称及其数量；</span></p></li><li><p><span>找出上海厂商供应的所有零件号码 ；</span></p></li><li><p><span>找出没有使用天津产的零件的工程号码；</span></p></li><li><p><span>把全部红色零件的颜色改成蓝色；</span></p></li><li><p><span>由 S5 供给 J4 零件 P6 改为由 S3 供应 ，请作必要的修改；</span></p></li><li><p><span>从供应商关系中删除 S2 的记录，并从供应情况关系中删除相应的记录；</span></p></li><li><p><span>请将 (S2, J6 ,P4 ,200）插入供应情况关系；</span></p></li></ol><p>&nbsp;</p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>2</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> PNAME<span class="cm-punctuation">,</span>COLOR<span class="cm-punctuation">,</span>WEIGHT</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> &nbsp; P<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="height: 46px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> PNAME<span class="cm-punctuation">,</span>QTY</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> &nbsp; P<span class="cm-punctuation">,</span>SPJ</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span>  JNO<span class="cm-operator">=</span><span class="cm-string">'J2'</span> <span class="cm-keyword">AND</span> P<span class="cm-variable-2">.PNO</span><span class="cm-operator">=</span>SPJ<span class="cm-variable-2">.PNO</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> PNAME<span class="cm-punctuation">,</span>QTY</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> &nbsp; P<span class="cm-punctuation">,</span>SPJ</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span>  JNO<span class="cm-operator">=</span><span class="cm-string">'J2'</span> <span class="cm-keyword">AND</span> P<span class="cm-variable-2">.PNO</span><span class="cm-operator">=</span>SPJ<span class="cm-variable-2">.PNO</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SELECT</span> JNO</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> &nbsp; J</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> <span class="cm-keyword">NOT</span> <span class="cm-keyword">EXISTS</span><span class="cm-bracket">(</span><span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-keyword">FROM</span>  SPJ<span class="cm-punctuation">,</span>S</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span> <span class="cm-keyword">WHERE</span> SPJ<span class="cm-variable-2">.JNO</span><span class="cm-operator">=</span>J<span class="cm-variable-2">.JNO</span> <span class="cm-keyword">AND</span> SPJ<span class="cm-variable-2">.SNO</span><span class="cm-operator">=</span>S<span class="cm-variable-2">.SNO</span> <span class="cm-keyword">AND</span> S<span class="cm-variable-2">.CITY</span><span class="cm-operator">=</span><span class="cm-string">'天津'</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 115px;"></div><div class="CodeMirror-gutters" style="height: 115px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">UPDATE</span> P</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SET</span> &nbsp;  COLOR<span class="cm-operator">=</span><span class="cm-string">'蓝'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span>  COLOR<span class="cm-operator">=</span><span class="cm-string">'红'</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">UPDATE</span> SPJ</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">SET</span> &nbsp;  SNO<span class="cm-operator">=</span><span class="cm-string">'S3'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span>  SNO<span class="cm-operator">=</span><span class="cm-string">'S5'</span> <span class="cm-keyword">AND</span> JNO<span class="cm-operator">=</span><span class="cm-string">'J4'</span> <span class="cm-keyword">AND</span> PNO<span class="cm-operator">=</span><span class="cm-string">'P6'</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DELETE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span>  SPJ</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> SNO<span class="cm-operator">=</span><span class="cm-string">'S2'</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DELETE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span>  S</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> SNO<span class="cm-operator">=</span><span class="cm-string">'S2'</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">INSERT</span> <span class="cm-keyword">INTO</span> SPJ <span class="cm-keyword">VALUES</span><span class="cm-bracket">(</span><span class="cm-string">'S2'</span><span class="cm-punctuation">,</span><span class="cm-string">'P4'</span><span class="cm-punctuation">,</span><span class="cm-string">'J6'</span><span class="cm-punctuation">,</span><span class="cm-number">200</span><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="height: 23px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='第三题-3'><span>第三题</span></h3><p><span>视图（View）在数据库中具有多种优点，主要包括：</span></p><ol start='' ><li><p><strong><span>简化复杂查询</span></strong><span>：视图可以将复杂的查询逻辑封装起来，为用户提供一个简单的数据访问接口。这样，用户不需要了解底层数据库的复杂结构，只需要通过视图来获取所需的数据。</span></p></li><li><p><strong><span>数据安全</span></strong><span>：视图可以限制用户对某些敏感数据的访问。通过创建视图，数据库管理员可以只暴露给用户他们需要看到的数据，隐藏其他数据。</span></p></li><li><p><strong><span>数据独立性</span></strong><span>：视图提供了应用程序和数据库表结构之间的独立性。即使表结构发生了变化，只要视图的逻辑保持不变，应用程序就不需要更改。</span></p></li><li><p><strong><span>提高性能</span></strong><span>：在某些情况下，视图可以存储查询的结果，这样在执行相同查询时可以更快地返回结果，尤其是对于复杂的聚合或连接查询。</span></p></li><li><p><strong><span>逻辑数据结构</span></strong><span>：视图允许用户在不改变实际数据库设计的情况下，创建逻辑上的数据结构。这样，用户可以根据不同的需求，以不同的方式来查看和组织数据。</span></p></li><li><p><strong><span>维护数据的完整性</span></strong><span>：视图可以强制实施业务规则和数据完整性约束，确保通过视图访问的数据符合特定的规则和约束。</span></p></li><li><p><strong><span>灵活性和可扩展性</span></strong><span>：视图可以根据需要动态地构建，这样可以为不同的用户或应用程序提供定制化的数据视图，提高了数据库的灵活性和可扩展性。</span></p></li><li><p><strong><span>简化分布式数据处理</span></strong><span>：在分布式数据库系统中，视图可以用来简化跨多个数据库的数据查询和操作。</span>
<span>需要注意的是，虽然视图提供了许多优点，但不当使用视图也可能导致性能下降，因为视图的查询需要在实时数据上执行额外的处理。因此，在设计数据库和创建视图时，应该权衡视图带来的便利和性能成本。</span></p></li></ol><p>&nbsp;</p><h2 id='第四次作业'><span>第四次作业</span></h2><h3 id='第一题-4'><span>第一题</span></h3><p><span>对下列两个关系模式：</span></p><ul><li><p><span>学生（学号，姓名，年龄，性别，家庭住址，班级号）</span></p></li><li><p><span>班级（班级号，班级名，班主任，班长）</span></p></li></ul><p><span>使用GRANT完成下列授权功能：</span></p><p><span>① 授予用户U1拥有对两个表的所有权限，并可给其他用户授权；</span>
<span>② 授予用户U2对学生表具有查看权限，对家庭住址具有更新权限；</span>
<span>③ 将对班级表查看权限授予所有用户。</span>
<span>④ 将对学生表的查询、更新权限授予角色Rio</span>
<span>⑤ 将角色R1授予用户U1,并且U1可继续授权给其他角色。</span></p><p><span>① 授予用户U1拥有对两个表的所有权限，并可给其他用户授权；</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALL</span> <span class="cm-keyword">PRIVILEGES</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student<span class="cm-punctuation">,</span>Class </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U1</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> <span class="cm-keyword">GRANT</span> <span class="cm-keyword">OPTION</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>② 授予用户U2对学生表具有查看权限，对家庭住址具有更新权限；</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span><span class="cm-punctuation">,</span><span class="cm-keyword">UPDATE</span><span class="cm-bracket">(</span><span class="cm-keyword">Add</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U2<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>③ 将对班级表查看权限授予所有用户。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> PUBLIC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>④ 将对学生表的查询、更新权限授予角色Rio</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span><span class="cm-punctuation">,</span><span class="cm-keyword">UPDATE</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Student </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> Rio<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p><span>⑤ 将角色R1授予用户U1,并且U1可继续授权给其他角色。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9881px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> R1</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> U1</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> ADMIN <span class="cm-keyword">OPTION</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3 id='第二题-4'><span>第二题</span></h3><p><span>今有两个关系模式：</span></p><ul><li><p><span>职工（职工号，姓名，年龄，职务， 工资，部门号）</span></p></li><li><p><span>部门（部门号，名称， 理名 ，地址，电话号）</span></p></li></ul><p><span>请用 SQL 的 GRANT 和 REVOK 语句（加上视图机制）完成以下授权定义或存取控制功能。</span></p><ol start='' ><li><p><span>用户王明对两个表有 SELECT 权限。</span></p></li><li><p><span>用户李勇对两个 表有 INSERT 和 DELETE 权限。</span></p></li><li><p><span>每个职工只对自己的记录有 SELECT 权限。</span></p></li><li><p><span>用户刘星对职工表有 SELECT 权限，对工资字段具有更新权限。</span></p></li><li><p><span>用户张新具有修改这两个表的结构的权限。</span></p></li><li><p><span>用户周平具有对两个表所有权限 （读，插，改， 删数据），并具有给其他用户授权的权限。</span></p></li><li><p><span>用户杨兰具有从每个部门职工中 SELECT 最高工资、最低工资、平均工资 的权限，他不能查看每个人的工资。</span></p></li></ol><p>&nbsp;</p><ol start='' ><li><p><span>用户王明对两个表有 SELECT 权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Employee</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 王明<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Department</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 王明<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>用户李勇对两个表有 INSERT 和 DELETE 权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">DELETE</span><span class="cm-punctuation">,</span> <span class="cm-keyword">INSERT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Employee</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 李勇<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">DELETE</span><span class="cm-punctuation">,</span> <span class="cm-keyword">INSERT</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Department</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 李勇<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>每个职工只对自己的记录有 SELECT 权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*先创建视图*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">DROP</span> <span class="cm-keyword">VIEW</span> USERS</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">VIEW</span> USERS</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">AS</span> <span class="cm-keyword">SELECT</span> <span class="cm-operator">*</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> Employee</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> NAME <span class="cm-operator">=</span> SYSTEM_USER<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*创建后，对视图查询权限授予所有用户*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> USERS</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> PUBLIC<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="height: 230px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>用户刘星对职工表有 SELECT 权限，对工资字段具有更新权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span><span class="cm-punctuation">,</span><span class="cm-keyword">UPDATE</span><span class="cm-bracket">(</span>Salary<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Employee</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 刘星<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="height: 69px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>用户张新具有修改这两个表的结构的权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALTER</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Employee</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 张新<span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALTER</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> Department</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 张新<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="height: 138px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>用户周平具有对两个表所有权限 （读，插，改， 删数据），并具有给其他用户授权的权限。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 35.9882px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 28px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -27.9948px; width: 28px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">ALL</span> <span class="cm-keyword">PRIVILEGES</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">TABLE</span> Staff<span class="cm-punctuation">,</span>Dept </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 19px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 周平</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -27.9948px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 19px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WITH</span> <span class="cm-keyword">GRANT</span> <span class="cm-keyword">OPTION</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 92px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 27px;"></div></div></div></div></pre><p>&nbsp;</p></li><li><p><span>用户杨兰具有从每个部门职工中 SELECT 最高工资、最低工资、平均工资 的权限，他不能查看每个人的工资。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*先建立视图*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">VIEW</span> Spay<span class="cm-bracket">(</span>Sname<span class="cm-punctuation">,</span>Smax<span class="cm-punctuation">,</span>Smin<span class="cm-punctuation">,</span>Savg<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">AS</span> <span class="cm-keyword">SELECT</span> Staff<span class="cm-variable-2">.Dno</span><span class="cm-punctuation">,</span><span class="cm-keyword">MAX</span><span class="cm-bracket">(</span>Pay<span class="cm-bracket">)</span><span class="cm-punctuation">,</span><span class="cm-keyword">MIN</span><span class="cm-bracket">(</span>Pay<span class="cm-bracket">)</span><span class="cm-punctuation">,</span><span class="cm-keyword">AVG</span><span class="cm-bracket">(</span>Pay<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">FROM</span> Staff<span class="cm-punctuation">,</span>Dept</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">WHERE</span> Staff<span class="cm-variable-2">.Dno</span><span class="cm-operator">=</span>Dept<span class="cm-variable-2">.Dno</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GROUP</span> <span class="cm-keyword">BY</span> Staff<span class="cm-variable-2">.Dno</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">/*将视图的SELECT权限授予用户*/</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">GRANT</span> <span class="cm-keyword">SELECT</span> </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">ON</span> <span class="cm-keyword">VIEW</span> Spay</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">TO</span> 杨兰<span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="height: 230px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p></li></ol><h2 id='第五次作业'><span>第五次作业</span></h2><h3 id='第一题-5'><span>第一题</span></h3><p><span>假设有下面两个关系模式：</span></p><p><span>职工（职理，姓名，年龄，职务，工资，部门号），其中职工号为主码；</span></p><p><span>部门（部门号，名称，经理名，电话），其中部门号为主码；</span></p><p><span>用SQL语言定义这两个关系模式，要求在模式中完成以下完整性约束条件的定义：</span></p><p><span>（1）定义每个模式的主码；（2）定义参照完整性；（3）定义职工年龄不得超过60岁。</span></p><pre class="md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded" spellcheck="false" lang="sql" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="sql"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.51982px; left: 43.9905px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 36px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: -35.9972px; width: 36px;"></div><div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Employee <span class="cm-bracket">(</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  EmployeeID <span class="cm-type">INT</span> <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Name <span class="cm-type">VARCHAR</span><span class="cm-bracket">(</span><span class="cm-number">50</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Age <span class="cm-type">INT</span> <span class="cm-keyword">CHECK</span> <span class="cm-bracket">(</span>Age <span class="cm-operator">&lt;=</span> <span class="cm-number">60</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Position <span class="cm-type">VARCHAR</span><span class="cm-bracket">(</span><span class="cm-number">50</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Salary <span class="cm-type">DECIMAL</span><span class="cm-bracket">(</span><span class="cm-number">10</span><span class="cm-punctuation">,</span> <span class="cm-number">2</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  DepartmentID <span class="cm-type">INT</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">FOREIGN</span> <span class="cm-keyword">KEY</span> <span class="cm-bracket">(</span>DepartmentID<span class="cm-bracket">)</span> <span class="cm-keyword">REFERENCES</span> Department<span class="cm-bracket">(</span>DepartmentID<span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> Department <span class="cm-bracket">(</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  DepartmentID <span class="cm-type">INT</span> <span class="cm-keyword">PRIMARY</span> <span class="cm-keyword">KEY</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  DepartmentName <span class="cm-type">VARCHAR</span><span class="cm-bracket">(</span><span class="cm-number">50</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ManagerName <span class="cm-type">VARCHAR</span><span class="cm-bracket">(</span><span class="cm-number">50</span><span class="cm-bracket">)</span><span class="cm-punctuation">,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 27px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  Phone <span class="cm-type">VARCHAR</span><span class="cm-bracket">(</span><span class="cm-number">20</span><span class="cm-bracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -35.9972px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt CodeMirror-linenumber-show" style="left: 0px; width: 27px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-bracket">)</span><span class="cm-punctuation">;</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 369px;"></div><div class="CodeMirror-gutters" style="height: 369px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 35px;"></div></div></div></div></pre><p>&nbsp;</p><h3 id='第二题-5'><span>第二题</span></h3><p><span>建立一个关于系、学生、班级、学会等诸信息的关系数据库。</span></p><p><span>描述学生的属性有：学号、姓名、出生年月、系名、班号、宿舍区。</span></p><p><span>描述班级的属性有：班号、专业名、系名、人数、入校年份。</span></p><p><span>描述系的属性有：系名、系号、系办公室、地点、人数。</span></p><p><span>描述学会的属性有：学会名、成立年份、地点、人数。</span></p><p><span>有关语义如下：一个系有若干专业，每个专业每年只招一个班，每个班有若干学生。一个系的学生住在同一宿舍区。每个学生可参加若干学会，每个学会有若干学生。学生参加某学会有一个入会年份。</span></p><p><span>请给出关系模式，写出每个关系模式的极小函数依赖集，指出是否存在传递函数依赖，对于函数依赖左部是多属性的情况，讨论函数依赖是完全函数依赖,还是部分函数依赖。</span></p><p>&nbsp;</p><p><span>定义关系模式：</span></p><p><span>学生: S(Sno, Sname, Sbirth, Dept, Class, Rno)</span>
<span>班级: C(Class, Pname, Dept, Cnum, Cyear)</span>
<span>系: D(Dept, Dno, Office, Dnum)</span>
<span>学会: M(Mname, Myear, Maddr, Mnum)</span></p><p>&nbsp;</p><p><span>最小函数依赖集：</span></p><p><span>(1) 学生</span></p><p><span>a. 最小函数依赖集</span></p><p><span>Sno-&gt;Sname;</span></p><p><span>Sno-&gt;Sbith;</span></p><p><span>Sno-&gt;Class;</span></p><p><span>Class-&gt;Dept;</span></p><p><span>Dept-&gt;Rno;</span></p><p><span>b. 传递函数依赖:</span></p><p><span>Sno与Rno之间存在着传递函数依赖。</span></p><p><span>因为Sno-&gt;Dept;而Dept-&gt;Sno，Dept-&gt;Rno (宿舍区)</span></p><p><span>Class与Rno之间存在着传递函数依赖。</span></p><p><span>因为Class-&gt;Dept，Dept子Class, Dept ≥Rno</span></p><p><span>Sno与Dept之间存在着传递函数依赖。</span></p><p><span>因为Sno-&gt;Class，Class-&gt;Sno，Class-&gt;Dept</span></p><p><span>(2) 班级</span></p><p><span>a. 最小函数依赖集</span></p><p><span>Class-&gt;Pname;</span></p><p><span>Class-&gt;Cnum;</span></p><p><span>Class-&gt;Cyear;</span></p><p><span>Pname-&gt;Dept.</span></p><p><span>b. 传递函数依赖</span></p><p><span>Class与Dept之间存在着传递函数依赖。</span></p><p><span>因为Class -&gt;Pname, Pname-&gt;Class, Pname-&gt;Dept</span></p><p><span>(3) 系</span></p><p><span>a. 最小函数依赖集:</span></p><p><span>Dept -&gt;Dno;</span></p><p><span>Dno-&gt;Dept；</span></p><p><span>Dno -&gt;Office；</span></p><p><span>Dno-&gt;Dnum</span></p><p><span>b. 传递函数依赖</span></p><p><span>Dept 与Office; Dept 与Dnum之间不存在传递依赖。</span></p><p><span>(4) 学会</span></p><p><span>a. 最小函数依赖集:</span></p><p><span>Mname -&gt;Myear；</span></p><p><span>Mname-&gt; Maddr；</span></p><p><span>Mname-&gt;Mnum；</span></p><p><span>b. 传递函数依赖</span></p><p><span>该模式不存在传递依赖。</span></p></div></div>
</body>
<!-- <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script> -->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="http://yandex.st/highlightjs/6.2/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!--侧栏目录生成代码-->
<script>
    //标题序号计数器
    var hCount = [0, 0, 0, 0, 0, 0];

    //设置计数器
    function setHCount(number) {
        //当前计数器加一
        hCount[number - 1]++;
        for (var i = number, length = hCount.length; i < length; i++) {
            //子目录计数器全部置零
            hCount[i] = 0;
        }
    }

    //重命名目录名称
    function setHTagValue(item, number) {
        //获取标题名
        var text = $(item).get(0).innerHTML;
        //初始化空字符串
        var before = "";
        //生成序号
        for (var i = 0, length = hCount.length; i < number; i++) {
            if (i < number - 1)
                before += hCount[i] + ".";
            else
                before += hCount[i] + " ";
        }
        //在标题前面加上序号
        $(item).get(0).innerHTML = before + text;
    }

    function renameHTag(item) {
        var tag = $(item).get(0).localName;
        if (tag === "h1") {
            setHCount(1);
            //console\.log("捕获到标签:%s", tag);
            setHTagValue(item, 1);
        }
        if (tag === "h2") {
            setHCount(2);
            //console.log("捕获到标签:%s", tag);
            setHTagValue(item, 2);
        }
        if (tag === "h3") {
            setHCount(3);
            //console.log("捕获到标签:%s", tag);
            setHTagValue(item, 3);
        }
        if (tag === "h4") {
            setHCount(4);
            //console.log("捕获到标签:%s", tag);
            setHTagValue(item, 4);
        }
        if (tag === "h5") {
            setHCount(5);
            //console.log("捕获到标签:%s", tag);
            setHTagValue(item, 5);
        }
        if (tag === "h6") {
            setHCount(6);
            //console.log("捕获到标签:%s", tag);
            setHTagValue(item, 6)
        }
    }

    $(document).ready(function () {
        $("h1,h2,h3,h4,h5,h6").each(function (i, item) {
            //给<H>类标签编号
            renameHTag(item);
            //获取标签的名字,h1,还是h2
            var tag = $(item).get(0).localName;
            //为该标签设置id属性
            $(item).attr("id", "wow" + i);
            //添加一个页内超链接,并设置class选择器
            //      $("#category").append('<a class="new'+tag+'" href="#wow'+i+'">'+$(this).text()+'</a></br>');
            $("#category").append('<a class="new' + tag + '" href="#wow' + i + '">' + $(item).text() + '</a></br>');
            //为每一个标题超链接的class属性设置左边距
            $(".newh1").css("margin-left", 0);
            $(".newh2").css("margin-left", 20);
            $(".newh3").css("margin-left", 40);
            $(".newh4").css("margin-left", 60);
            $(".newh5").css("margin-left", 80);
            $(".newh6").css("margin-left", 100);
        });
        //设置class选择器为.book-body的html内容
        $(".book-body").html($(".book-body").nextAll())
    });
</script>
<style type="text/css">
    @media (max-width: 1600px) {
        .book-body {
            /* padding-left: 200px; */
            padding-right: 0px;
        }
    }

    @media (max-width: 1400px) {
        .book-body {
            /* padding-left: 200px; */
            padding-right: 0px;
        }
    }

    @media (max-width: 1200px) {
        .book-body {
            /* padding-left: 300px; */
            padding-left: 0px;
        }
    }

    @media (max-width: 700px) {
        .book-body {
            padding-left: 0px;
        }
    }

    @media (min-width: 600px) {
        #category {
            /* 绝对定位 */
            position: fixed;
            /* left: 20px; */
            /* 目录显示的位置 */
            left: 0px;
            top: 0;
            /* 目录栏的高度,这里设置为60%主要是为了不挡住返回顶部和折叠按钮 */
            height: 79%;
            /* 开启垂直滚动条 */
            overflow-y: scroll;
            /* 开启水平滚动条 */
            overflow-x: scroll;
        }
    }

    @media (-webkit-max-device-pixel-ratio: 1) {
        ::-webkit-scrollbar-track-piece {
            background-color: #FFF
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px
        }

        ::-webkit-scrollbar-thumb {
            background-color: #c2c2c2;
            background-clip: padding-box;
            min-height: 28px
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: #A0A0A0
        }
    }
</style>
<script>
    // id="category" οnclick="showOrCloseCategory()"
    function showOrCloseCategory() {
        var id = document.getElementById("category");
        var book_body = document.getElementById("book_body");
        //如果展开了
        if (id.style.display == 'block') {
            //console.log("开始展开");
            id.style.display = 'none';
            id.style.width = "0%";
            book_body.style.width = "100%";
            book_body.style.paddingleft = 0;
        }
        //如果被折叠了
        else if (id.style.display == 'none') {
            //console.log("开始折叠");
            id.style.display = 'block';
            book_body.style.width = "90%";
            id.style.width = "20%"
        }
    }
</script>
<!--返回顶部-->
<a href="javascript:scroll(0,0)" style="position:fixed;float:right;left:40px;top:80%">返回顶部</a>
<button onclick="showOrCloseCategory()" style="position:fixed;float:right;left:40px;top:85%">折叠/展开</button>
<!--文章主体部分-->
<div class="book-body" id="book_body" style="width:90%;display:block"></div>
<!--目录栏，设置占用宽度为20%可以根据实际情况设置-->
<div class="book-summary" id="category" style="width:20%;display:block"></div>


</html>